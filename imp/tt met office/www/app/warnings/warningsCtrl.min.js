angular.module("ionic.metApp").controller("warningsCtrl",["metApi","$scope","$ionicModal","$ionicSlideBoxDelegate","$ionicScrollDelegate","$interval","$stateParams","$timeout",function(e,t,i,n,a,o,s,r){function c(e){var t=["January","February","March","April","May","June","July","Aug","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date(e);return i[n.getDay()+1]+" "+(n.getDate()+1)+"th of "+t[n.getMonth()]+" "+n.getFullYear()}var l=this,u=6e5;o(function(){$ionicHistory.clearCache().then(function(){$route.reload(),l.refresh_all_w(),$route.reload()}),$ionicHistory.clearHistory()},u),t.disableSwipe=function(){n.enableSlide(!1)},t.get_initial=function(){r(function(){t.slide(s.id)},1e3)},t.slideHasChanged=function(e){l.update_slide(e)},l.update_slide=function(e){titles=["Watches","Warnings","Sigmet","Airmet"],t.sub_title=titles[e]},t.slide=function(e){a.scrollTop(),n.slide(e)},l.refresh_all_w=function(){l.get_o_air(),l.get_sigmet(),l.get_warn(),l.get_watch()},l.refreshData=function(e){switch(e){case"Watches":l.get_watch();break;case"Warnings":l.get_warn();break;case"Sigmet":l.get_sigmet();break;case"Airmet":l.get_o_air()}},l.get_o_air=function(){e.get_o_air().then(function(e){l.o_items=e.items[0],l.o_items.insertionDateFormatted=c(e.items[0].insertionDate),"0"==l.o_items.flag&&(l.o_items=null)},function(e){})},l.get_sigmet=function(){e.get_sigmet().then(function(e){l.s_items=e.items[0],l.s_items.insertionDateFormatted=c(e.items[0].insertionDate),"0"==l.s_items.flag&&(l.s_items=null)},function(e){})},l.get_warn=function(){e.get_warn().then(function(e){l.w_items=e.items[0],l.w_items.insertionDateFormatted=c(e.items[0].insertionDate),"0"==l.w_items.flag&&(l.w_items=null)},function(e){})},l.get_watch=function(){e.get_watch().then(function(e){l.wt_items=e.items[0],l.wt_items.insertionDateFormatted=c(e.items[0].insertionDate),"0"==l.wt_items.flag&&(l.wt_items=null)},function(e){})},i.fromTemplateUrl("app/warnings/info_item.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.w_details_modal=e}),t.w_info_close=function(){var e=document.querySelector(".modal");e.setAttribute("style",""),t.w_details_modal.hide()},t.w_info_open=function(i,n){switch(t.w_details_modal.show(),n){case"o":e.get_o_air(function(e){l.warning=e.items[0],l.warning.warnType=l.warning.forecaster},i);break;case"s":e.get_sigmet(function(e){l.warning=e.items[0]},i);break;case"w":e.get_warn(function(e){l.warning=e.items[0]},i);break;case"wt":e.get_watch(function(e){l.warning=e.items[0]},i)}},t.drag_close_modal=function(e){var i=window.innerHeight,n=e.gesture.center.pageY,a=document.querySelector(".modal"),o="; transition: all cubic-bezier(0.1, 0.7, 0.1, 1) 400ms;";a.setAttribute("style","margin-top:"+n+"px"+o),n>i/2&&t.w_info_close(),0>n&&a.setAttribute("style","margin-top:0px"+o),n>i&&t.w_info_close()},t.drag_release=function(){var e=document.querySelector(".modal"),t="; transition: all cubic-bezier(0.1, 0.7, 0.1, 1) 400ms;";e.setAttribute("style","margin-top:0px"+t)}}]);