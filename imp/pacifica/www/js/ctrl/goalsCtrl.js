function createValue(e,a){return{display:"",ordinate:e,valueInt:a,valueString:null}}var ctrl=angular.module("goalsCtrl",[]),GOAL_BRONZE_STAR_POINTS=20,GOAL_SILVER_STAR_POINTS=50,GOAL_GOLD_STAR_POINTS=100,CATEGORY_ORDER=["GOAL_LIST_CATEGORY_WORK_SCHOOL","GOAL_LIST_CATEGORY_FRIENDS_FAMILY","GOAL_LIST_CATEGORY_ROMANCE","GOAL_LIST_CATEGORY_STRANGERS","GOAL_LIST_CATEGORY_EATING","GOAL_LIST_CATEGORY_DESTINATIONS","GOAL_LIST_CATEGORY_PERFORMING","GOAL_LIST_CATEGORY_TRANSPORTATION","GOAL_LIST_CATEGORY_RELAX","GOAL_LIST_CATEGORY_WILDCARDS"],MASTER_SUB_GOAL_KEYS=[["GOAL_LIST_WORK_SCHOOL_1","GOAL_LIST_WORK_SCHOOL_2","GOAL_LIST_WORK_SCHOOL_3","GOAL_LIST_WORK_SCHOOL_4","GOAL_LIST_WORK_SCHOOL_5","GOAL_LIST_WORK_SCHOOL_6","GOAL_LIST_WORK_SCHOOL_7","GOAL_LIST_WORK_SCHOOL_8","GOAL_LIST_WORK_SCHOOL_9","GOAL_LIST_WORK_SCHOOL_10","GOAL_LIST_WORK_SCHOOL_11","GOAL_LIST_WORK_SCHOOL_12","GOAL_LIST_WORK_SCHOOL_13"],["GOAL_LIST_FRIENDS_FAMILY_1","GOAL_LIST_FRIENDS_FAMILY_2","GOAL_LIST_FRIENDS_FAMILY_3","GOAL_LIST_FRIENDS_FAMILY_4","GOAL_LIST_FRIENDS_FAMILY_5","GOAL_LIST_FRIENDS_FAMILY_6","GOAL_LIST_FRIENDS_FAMILY_7"],["GOAL_LIST_ROMANCE_1","GOAL_LIST_ROMANCE_2","GOAL_LIST_ROMANCE_3","GOAL_LIST_ROMANCE_4","GOAL_LIST_ROMANCE_5","GOAL_LIST_ROMANCE_6","GOAL_LIST_ROMANCE_7"],["GOAL_LIST_STRANGERS_1","GOAL_LIST_STRANGERS_2","GOAL_LIST_STRANGERS_3","GOAL_LIST_STRANGERS_4","GOAL_LIST_STRANGERS_5","GOAL_LIST_STRANGERS_6","GOAL_LIST_STRANGERS_7"],["GOAL_LIST_EATING_1","GOAL_LIST_EATING_2","GOAL_LIST_EATING_3","GOAL_LIST_EATING_4","GOAL_LIST_EATING_5"],["GOAL_LIST_DESTINATIONS_1","GOAL_LIST_DESTINATIONS_2","GOAL_LIST_DESTINATIONS_3","GOAL_LIST_DESTINATIONS_4","GOAL_LIST_DESTINATIONS_5","GOAL_LIST_DESTINATIONS_6","GOAL_LIST_DESTINATIONS_7","GOAL_LIST_DESTINATIONS_8","GOAL_LIST_DESTINATIONS_9","GOAL_LIST_DESTINATIONS_10","GOAL_LIST_DESTINATIONS_11","GOAL_LIST_DESTINATIONS_12","GOAL_LIST_DESTINATIONS_13","GOAL_LIST_DESTINATIONS_14","GOAL_LIST_DESTINATIONS_15","GOAL_LIST_DESTINATIONS_16","GOAL_LIST_DESTINATIONS_17","GOAL_LIST_DESTINATIONS_18","GOAL_LIST_DESTINATIONS_19","GOAL_LIST_DESTINATIONS_20","GOAL_LIST_DESTINATIONS_21","GOAL_LIST_DESTINATIONS_22","GOAL_LIST_DESTINATIONS_23","GOAL_LIST_DESTINATIONS_24","GOAL_LIST_DESTINATIONS_25","GOAL_LIST_DESTINATIONS_26"],["GOAL_LIST_PERFOMING_1","GOAL_LIST_PERFOMING_2","GOAL_LIST_PERFOMING_3","GOAL_LIST_PERFOMING_4","GOAL_LIST_PERFOMING_5","GOAL_LIST_PERFOMING_6","GOAL_LIST_PERFOMING_7","GOAL_LIST_PERFOMING_8","GOAL_LIST_PERFOMING_9","GOAL_LIST_PERFOMING_10","GOAL_LIST_PERFOMING_11"],["GOAL_LIST_TRANSPORTATION_1","GOAL_LIST_TRANSPORTATION_2","GOAL_LIST_TRANSPORTATION_3","GOAL_LIST_TRANSPORTATION_4","GOAL_LIST_TRANSPORTATION_5","GOAL_LIST_TRANSPORTATION_6","GOAL_LIST_TRANSPORTATION_7","GOAL_LIST_TRANSPORTATION_8","GOAL_LIST_TRANSPORTATION_9","GOAL_LIST_TRANSPORTATION_10"],["GOAL_LIST_RELAX_1","GOAL_LIST_RELAX_2","GOAL_LIST_RELAX_3","GOAL_LIST_RELAX_4","GOAL_LIST_RELAX_5","GOAL_LIST_RELAX_6","GOAL_LIST_RELAX_7","GOAL_LIST_RELAX_8","GOAL_LIST_RELAX_9","GOAL_LIST_RELAX_10","GOAL_LIST_RELAX_11","GOAL_LIST_RELAX_12","GOAL_LIST_RELAX_13","GOAL_LIST_RELAX_14","GOAL_LIST_RELAX_15","GOAL_LIST_RELAX_16","GOAL_LIST_RELAX_17"],["GOAL_LIST_WILDCARDS_1","GOAL_LIST_WILDCARDS_2","GOAL_LIST_WILDCARDS_3","GOAL_LIST_WILDCARDS_4","GOAL_LIST_WILDCARDS_5","GOAL_LIST_WILDCARDS_6","GOAL_LIST_WILDCARDS_7","GOAL_LIST_WILDCARDS_8","GOAL_LIST_WILDCARDS_9","GOAL_LIST_WILDCARDS_10","GOAL_LIST_WILDCARDS_11","GOAL_LIST_WILDCARDS_12","GOAL_LIST_WILDCARDS_13","GOAL_LIST_WILDCARDS_14","GOAL_LIST_WILDCARDS_15","GOAL_LIST_WILDCARDS_16","GOAL_LIST_WILDCARDS_17"]],MASTER_SUB_GOAL_LIST,masterSugGoalListLanguage;ctrl.controller("GoalsCtrl",["$scope","$rootScope","$sce","$controller","$state","$stateParams","$timeout","$location","$analytics","$translate","$ionicLoading","$ionicModal","$ionicPlatform","$ionicPopup","$ionicGesture","$ionicScrollDelegate","$ionicActionSheet","Environment","AccountService","GoalsService","GeneralService","SkillsService","HabitsService",function(e,a,t,o,l,i,n,_,S,c,G,u,r,L,T,A,s,O,I,d,f,v){function E(){$(".dragContainer").addClass("hideRemove")}function R(a){e.colorPercentages=[0,1],e.allDifficultyColors=["#60d293","#5fe9c4","#5bdddf","#58caf6","#66edff","#ffe566","#ffbe66","#ff9b73","#ef7d7d","#ff6669"],e.difficultyColors=[e.allDifficultyColors[0],e.allDifficultyColors[0],"#c8c8c8"],e.difficultyValues=[10];for(var t=0;10>t;++t)e.difficultyValues[t]=createValue(t,t+1);var o;e.valueData?(o=e.valueData,++o.redraw,e.difficultyColors[1]=e.allDifficultyColors[e.valueData.valueIndex]):(o=e.valueData={},o.redraw=0),o.userInteracted=!1,o.value=a?a.difficulty:"?",o.valueIndex=a?a.difficulty-1:0,o.percentage=0}function g(a){if(G.hide(),e.viewData.submitting=!1,e.closeModifyGoalModal(),e.showingSelectGoal=!1,e.editingGoal)h(e.editingGoal);else if(a){e.goals=d.getAccountGoals();for(var t=0;t<e.goals.length;++t)if(e.goals[t].id==a){h(e.goals[t]);break}}}function D(){e.filteredSubGoalKeys=CATEGORY_ORDER,e.filteredSubGoals=MASTER_SUB_GOAL_LIST}function N(){G.hide(),e.viewData&&(e.viewData.submitting=!1),e.closeModifySubGoalModal(),h(e.currentGoal),e.setActiveTab("active")}function b(){G.hide(),e.viewData.submitting=!1;L.alert({template:c.instant("EXPERIMENTS_ADD_SUB_GOAL_ERROR"),okText:c.instant("OK_GOT_IT"),okType:"button-default"})}function p(){var a=e.achievingSubGoal.difficulty,t=e.getAchievedGoalDifficulty();if(GOAL_BRONZE_STAR_POINTS>t){if(t+a>=GOAL_BRONZE_STAR_POINTS)return"bronze"}else if(GOAL_SILVER_STAR_POINTS>t){if(t+a>=GOAL_SILVER_STAR_POINTS)return"silver"}else if(GOAL_GOLD_STAR_POINTS>t&&t+a>=GOAL_GOLD_STAR_POINTS)return"gold";return"none"}function h(a){if(e.goals=d.getAccountGoals(),e.goals.sort(function(e,a){return new Date(e.createdAt).getTime()-new Date(a.createdAt).getTime()}),a&&(e.currentGoal=d.getGoal(a.id)),!e.currentGoal){var t=localStorage.getItem("lastActiveGoalId");t&&(e.currentGoal=d.getGoal(+t)),e.currentGoal||(e.currentGoal=e.goals.length>0?e.goals[0]:void 0)}if(e.currentGoal&&localStorage.setItem("lastActiveGoalId",e.currentGoal.id),e.subGoals={},e.currentGoal){var o,l=d.getAccountSubGoals();if(l)for(var i in l)for(var n=l[i],_=0;_<n.length;++_){var S=n[_];o=e.subGoals[S.goalId],o||(e.subGoals[S.goalId]=[]),e.subGoals[S.goalId].push(S)}if(o=e.subGoals[e.currentGoal.id],e.activeSubGoals=[],e.completedSubGoals=[],o){for(var c=f.getDayString(new Date),G=0;G<o.length;++G){var u=o[G],r=f.getDayString(new Date(u.createdAt));(r==c||!d.achievedSubGoal(u)||d.achievedSubGoalToday(u))&&e.activeSubGoals.push(u),d.achievedSubGoal(u)&&e.completedSubGoals.push(u)}e.activeSubGoals.sort(function(a,t){var o=e.achievedSubGoal(a),l=e.achievedSubGoal(t);return o&&l?new Date(t.achievedRecordedAt).getTime()-new Date(a.achievedRecordedAt).getTime():o||l?o?1:-1:new Date(a.createdAt).getTime()-new Date(t.createdAt).getTime()}),e.completedSubGoals.sort(function(e,a){return new Date(a.achievedRecordedAt).getTime()-new Date(e.achievedRecordedAt).getTime()})}}}e.activeTab="active";var M;if(e.$on("$ionicView.afterEnter",function(){M=i.suggestedActivity,M&&(e.modifySubGoal(),n(function(){e.viewData.subGoal=M}))}),!MASTER_SUB_GOAL_LIST||masterSugGoalListLanguage!=moment.locale()){MASTER_SUB_GOAL_LIST=[];for(var y=0;y<MASTER_SUB_GOAL_KEYS.length;++y)!function(){var e=MASTER_SUB_GOAL_KEYS[y],a=[];MASTER_SUB_GOAL_LIST.push(a);for(var t=0;t<e.length;++t)c(e[t]).then(function(e){a.push(e)})}();masterSugGoalListLanguage=moment.locale()}e.getGoalsLevel=function(){return v.getSkillLevel("goals")},e.goToSkills=function(){window.openURL("/progress/mood?tab=skills")},e.getPageTitle=function(){if(e.currentGoal)for(var a=0;a<e.goals.length;++a)if(e.currentGoal==e.goals[a])return c.instant("GOAL")+" "+(a+1);return c.instant("NO_GOAL")},e.showHelp=function(){var t;t=I.isUMNUser()?[{text:'<i class="icon ion-ios-help-outline"></i> '+c.instant("WHAT_IS_GOALS")},{text:'<i class="icon ion-ios-play-outline"></i> '+c.instant("WATCH_MILO_IS_SCARED")},{text:'<i class="icon ion-ios-list-outline"></i> '+c.instant("VIEW_COMMON_QUESTIONS")}]:[{text:'<i class="icon ion-ios-help-outline"></i> '+c.instant("WHAT_IS_GOALS")},{text:'<i class="icon ion-ios-play-outline"></i> '+c.instant("WATCH_MILO_IS_SCARED")},{text:'<i class="icon ion-ios-list-outline"></i> '+c.instant("VIEW_COMMON_QUESTIONS")},{text:'<i class="icon ion-ios-people-outline"></i> '+c.instant("EXPLORE_THE_COMMUNITY")}],s.show({buttons:t,cancelText:c.instant("CANCEL"),cancel:function(){},buttonClicked:function(t){return 0===t?a.$broadcast("event:viewVideo",{video:I.GOALS_VIDEO}):1===t?I.viewVideo(I.GOALS_VIDEO):2==t?window.open("http://help.thinkpacifica.com/hc/en-us/sections/200750797-Goals","_blank","location=no"):3==t&&e.goToCommunity("goals"),!0}})},e.getAchievedSubGoals=function(){var a=0;if(e.completedSubGoals)for(var t=0;t<e.completedSubGoals.length;++t){var o=e.completedSubGoals[t];e.achievedSubGoal(o)&&++a}return a},e.getAchievedGoalDifficulty=function(){var a=0;if(e.completedSubGoals)for(var t=0;t<e.completedSubGoals.length;++t){var o=e.completedSubGoals[t];e.achievedSubGoal(o)&&(a+=o.difficulty)}return a},e.getAchievedGoalClass=function(){var a=e.getAchievedGoalDifficulty();return a>=GOAL_GOLD_STAR_POINTS?"gold":a>=GOAL_SILVER_STAR_POINTS?"silver":a>=GOAL_BRONZE_STAR_POINTS?"bronze":"none"},e.showingSelectGoal=!1,e.selectGoal=function(){E(),e.showingSelectGoal=!e.showingSelectGoal},e.closeSelectGoal=function(){e.showingSelectGoal=!1},e.setCurrentGoal=function(a){e.currentGoal=a,h(e.currentGoal),localStorage.setItem("lastActiveGoalId",e.currentGoal.id),e.showingSelectGoal=!1},e.getCurrentGoalTitle=function(){return e.currentGoal?e.currentGoal.title:c.instant("NO_LONG_TERM_GOAL")},n(E),e.elementDragged=function(e){E(),"dragleft"==e.type&&angular.element(e.target).removeClass("hideRemove")},e.$watch("valueData.valueIndex",function(){if(e.valueData){var a=e.valueData.valueIndex;e.lastValueIndex!=a&&(e.difficultyColors[1]=e.allDifficultyColors[a],++e.valueData.redraw)}}),e.setActiveTab=function(a){E(),e.closeSelectGoal(),a!=e.activeTab&&(e.activeTab=a,A.resize())},e.getPrintableDate=function(e){var a=new Date(e.achievedRecordedAtString);return f.getDateDisplay(a)+" "+c.instant("AT_DESCRIBING_TIME")+" "+f.getMinuteDisplay(a)},e.achievedSubGoal=function(e){return d.achievedSubGoal(e)},e.closeModifySubGoalModal=function(){e.modifySubGoalModal&&(closeModal(e.modifySubGoalModal),e.modifySubGoalModal.remove(),e.modifySubGoalModal=void 0)},e.modifySubGoal=function(a){event.preventDefault(),event.stopPropagation(),e.closeSelectGoal(),a?(e.editingSubGoal=a,e.selectSubGoalDifficulty=!0):(e.editingSubGoal=void 0,e.selectSubGoalDifficulty=!1),e.viewData={subGoal:a?a.title:"",error:!1,submitting:!1},e.difficulty=a?a.difficulty:1,R(a),D(),u.fromTemplateUrl("views/goals/goals.addSubGoal.modal.html",{scope:e,animation:"slide-in-up"}).then(function(a){e.modifySubGoalModal=a,openModal(e.modifySubGoalModal)})},e.reAddSubGoal=function(a){event.preventDefault(),event.stopPropagation(),E(),e.closeSelectGoal();var t=L.confirm({template:'<div class="thisisatest">'+c.instant("READD_SUB_GOAL")+"</div>",cancelText:c.instant("CANCEL"),cancelType:"button-default",okText:c.instant("CREATE"),okType:"button-default"});t.then(function(e){e&&(G.show({template:c.instant("EXPERIMENTS_SETTING_EXPERIMENT")+"..."}),d.addSubGoal(a.goalId,a.title,f.getDayString(new Date),a.difficulty).success(function(){N()}).error(b),S.eventTrack("reAddSubGoal",{category:"goals"}))})},e.closeModifyGoalModal=function(){e.modifyGoalModal&&(closeModal(e.modifyGoalModal),e.modifyGoalModal.remove(),e.modifyGoalModal=void 0)},e.getModifyGoalHeader=function(){return c.instant(e.editingGoal?"EXPERIMENTS_EDIT_GOAL_HEADER":"EXPERIMENTS_ADD_GOAL_HEADER")},e.clearGoal=function(){e.viewData.goal=""},e.setGoalText=function(a){e.viewData.goal=c.instant(a)},e.archiveGoal=function(){if(event.preventDefault(),event.stopPropagation(),!O.isOnline())return void L.alert({template:c.instant("EXPERIMENTS_ARCHIVE_OFFLINE_PROMPT"),okText:c.instant("OK_GOT_IT"),okType:"button-default"});if(1==e.goals.length)return void L.alert({template:c.instant("EXPERIMENTS_ARCHIVE_LAST_GOAL_ERROR"),okText:c.instant("OK_GOT_IT"),okType:"button-default"});S.eventTrack("archiveGoalPopup",{category:"goals"});var a=L.confirm({template:'<div class="thisisatest">'+c.instant("EXPERIMENTS_REMOVE_GOAL_PROMPT")+"</div>",cancelText:c.instant("CANCEL"),cancelType:"button-default",okText:c.instant("REMOVE"),okType:"button-default"});a.then(function(t){t?(d.archiveGoal(e.currentGoal.id).success(function(){a.close(),e.currentGoal=void 0,h()}),S.eventTrack("archiveGoalConfirm",{category:"goals"})):S.eventTrack("archiveGoalCancel",{category:"goals"})})},e.saveGoal=function(){e.editingGoal?(d.updateGoal(e.currentGoal.id,e.viewData.goal,e.currentGoal.color).success(g),S.eventTrack("updateGoal",{category:"goals"})):(d.addGoal(e.viewData.goal,"green").success(g),S.eventTrack("addGoal",{category:"goals"}))},e.modifyGoal=function(a){event.preventDefault(),event.stopPropagation(),e.viewData={goal:a?a.title:"",error:!1,submitting:!1},e.editingGoal=a?a:void 0,u.fromTemplateUrl("views/goals/goals.addGoal.modal.html",{scope:e,animation:"slide-in-up"}).then(function(a){e.modifyGoalModal=a,openModal(e.modifyGoalModal)}),e.showingSelectGoal=!1},D(),e.getFilteredSubGoalList=function(a){return e.filteredSubGoals[a]};var C={};e.showFilteredSubGoalList=function(a){return""!==e.viewData.subGoal||!!C[a]},e.showingFilteredSubGoalList=function(e){return!!C[e]},e.toggleFilteredSubGoalList=function(a){e.showFilteredSubGoalList(a)?delete C[a]:C[a]=!0,A.resize()},e.updateSubGoalList=function(){e.selectSubGoalDifficulty=!1,e.filteredSubGoalKeys=[],e.filteredSubGoals=[];for(var a=new RegExp(".*"+e.viewData.subGoal.replace(/\s/g,".*")+".*","i"),t=0;t<CATEGORY_ORDER.length;++t){var o=CATEGORY_ORDER[t],l=!1;a.test(o)&&(l=!0);for(var i,n=MASTER_SUB_GOAL_LIST[t],_=!1,S=0;S<n.length;++S){var c=n[S];(l||a.test(c))&&(_||(i=[],e.filteredSubGoals.push(i),e.filteredSubGoalKeys.push(o),_=!0),i.push(c))}}A.resize()},e.selectSubGoal=function(a){e.viewData.subGoal=a,e.selectSubGoalDifficulty=!0,A.resize(),window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&n(function(){$("textarea").blur(),window.Keyboard.close()},405),S.eventTrack("selectSubGoal",{category:"goals",label:a})},e.clearSubGoal=function(){e.viewData.subGoal="",e.selectSubGoalDifficulty=!1,R(e.editingSubGoal),e.updateSubGoalList(),S.eventTrack("clearSubGoal",{category:"goals"})},e.setSubGoal=function(){return""===e.viewData.subGoal?void(e.viewData.error=!0):(e.viewData.error=!1,e.selectSubGoalDifficulty=!0,A.resize(),window.ionic&&window.ionic.keyboard&&window.ionic.keyboard.hide(),window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&n(function(){$("textarea").blur(),window.Keyboard.close()},405),void S.eventTrack("setSubGoal",{category:"goals",label:e.viewData.subGoal}))},e.getAchieveSubGoalMessage=function(){{var e;p()}return e="ACHIEVED_GOAL_MESSAGE",c.instant(e)},e.getAchieveSubGoalTitle=function(){var e,a=(p(),Math.floor(1*Math.random())+1);return e="ACHIEVED_GOAL_TITLE_"+a,t.trustAsHtml(c.instant(e))},e.getAchievedSubGoalClass=function(){return p()},e.closeAchieveSubGoalModal=function(){closeModal(e.achieveSubGoalModal),e.achieveSubGoalModal.remove(),e.achieveSubGoalModal=void 0},e.getSpinnerDifficulty=function(){return e.valueData?e.difficultyValues[e.valueData.valueIndex].valueInt:void 0},e.getOriginalDifficulty=function(){return e.achievingSubGoal.difficulty},e.achieveSubGoal=function(){d.achieveSubGoal(e.achievingSubGoal.id,e.difficultyValues[e.valueData.valueIndex].valueInt).success(function(){h(e.currentGoal),e.closeAchieveSubGoalModal()}).error(function(){L.alert({template:'<div class="thisisatest">'+c.instant("EXPERIMENTS_ACHIEVE_ERROR")+"</div>",okText:c.instant("OK_GOT_IT"),okType:"button-default"})})},e.showAchieveSubGoal=function(a){return e.closeSelectGoal(),e.achievedSubGoal(a)?void e.reAddSubGoal(a):(e.achievingSubGoal=a,R(),S.eventTrack("achieveSubGoalPopup",{category:"goals"}),u.fromTemplateUrl("views/goals/goals.achieveSubGoalModal.html",{scope:e,animation:"slide-in-up"}).then(function(a){e.achieveSubGoalModal=a,openModal(e.achieveSubGoalModal)}),void E())},e.archiveSubGoal=function(a){if(event.preventDefault(),event.stopPropagation(),e.closeSelectGoal(),O.isOnline()){S.eventTrack("archiveSubGoalPopup",{category:"goals"});var t=L.confirm({template:'<div class="thisisatest">'+c.instant("EXPERIMENTS_REMOVE_SUB_GOAL_PROMPT")+"</div>",cancelText:c.instant("CANCEL"),cancelType:"button-default",okText:c.instant("REMOVE"),okType:"button-default"});t.then(function(o){o?(d.archiveSubGoal(a.day,a.id).success(function(){t.close(),h(e.currentGoal)}),S.eventTrack("archiveSubGoalConfirm",{category:"goals"})):S.eventTrack("archiveSubGoalCancel",{category:"goals"})})}else{L.alert({template:c.instant("EXPERIMENTS_ARCHIVE_OFFLINE_PROMPT"),okText:c.instant("OK_GOT_IT"),okType:"button-default"})}},e.saveSubGoal=function(){if("?"==e.valueData.value)return void(e.noDataError=!0);if(e.noDataError=!1,G.show({template:c.instant("EXPERIMENTS_SETTING_EXPERIMENT")+"..."}),e.editingSubGoal){var a=new Date(e.editingSubGoal.createdAt);d.updateSubGoal(e.editingSubGoal.id,e.editingSubGoal.goalId,e.viewData.subGoal,f.getDayString(a),e.difficultyValues[e.valueData.valueIndex].valueInt).success(N).error(b),S.eventTrack("updateSubGoal",{category:"goals"})}else d.addSubGoal(e.currentGoal.id,e.viewData.subGoal,f.getDayString(new Date),e.difficultyValues[e.valueData.valueIndex].valueInt).success(N).error(b),S.eventTrack("addSubGoal",{category:"goals"})},h()}]),ctrl.controller("GoalsHelpCtrl",["$scope","$rootScope","$state","$http","$stateParams","$controller","$ionicHistory","AccountService",function(e,a,t,o,l,i,n,_){i("HelpCtrl",{$scope:e}),e.confirm=function(){_.setUserPreference("completed_goals_intro","true"),n.currentView(n.backView()),t.go("app.goals",{},{location:"replace"})}}]);