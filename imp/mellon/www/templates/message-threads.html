<ion-view view-title="{{ 'MESSAGES' | translate }}" hide-back-button="true" class="threads"> <ion-content class="has-tabs has-tabs-top"> <div ng-if="apiTotalCount != undefined && apiTotalCount == 0" class="wall-no-product-found"> {{ 'You haven\'t started any conversation yet.' | translate }} </div> <ion-item ng-if="socketConnected && messageThreads.length > 0" class="item-avatar-right item-icon-right message-thread" type="item-text-wrap" ng-repeat="messageThread in messageThreads | limitTo:listLimit track by messageThread.chatter_ids " ng-click="goToThread(messageThread.user1.id != userLoggedId ? messageThread.user1.id : messageThread.user2.id)"> <img ng-if="messageThread.user1.id != userLoggedId && messageThread.user1.imageUrl==null" src="img/avatar-placeholder.svg"> <cl-image ng-if="messageThread.user1.id != userLoggedId && messageThread.user1.imageUrl!=null" public-id="{{messageThread.user1.facebook_id ? messageThread.user1.facebook_id : messageThread.user1.imageUrl}}" ng-class="messageThread.user1.visibility==0 && messageThread.user1.out_following==0 ? 'avatar-opacity' : ''" format="jpg" secure="secure" type="{{messageThread.user1.facebook_id ? 'facebook' : 'upload'}}"> <cl-transformation height="110" width="110" crop="fill"> </cl-image> <span ng-if="messageThread.user1.id != userLoggedId && messageThread.user1.imageUrl!=null && messageThread.user1.visibility == 0" class="mellon-icon-hide over-img"></span> <img ng-if="messageThread.user2.id != userLoggedId && messageThread.user2.imageUrl==null" src="img/avatar-placeholder.svg"> <cl-image ng-if="messageThread.user2.id != userLoggedId && messageThread.user2.imageUrl!=null" public-id="{{messageThread.user2.facebook_id ? messageThread.user2.facebook_id : messageThread.user2.imageUrl}}" ng-class="messageThread.user2.visibility==0 && messageThread.user2.out_following==0 ? 'avatar-opacity' : ''" format="jpg" secure="secure" type="{{messageThread.user2.facebook_id ? 'facebook' : 'upload'}}"> <cl-transformation height="110" width="110" crop="fill"> </cl-image> <span ng-if="messageThread.user2.id != userLoggedId && messageThread.user2.imageUrl!=null && messageThread.user2.visibility == 0" class="mellon-icon-hide over-img"></span> <div class="user-name" ng-if="messageThread.user1.id != userLoggedId">{{messageThread.user1.name}} {{messageThread.user1.surname}}</div> <div class="user-name" ng-if="messageThread.user2.id != userLoggedId">{{messageThread.user2.name}} {{messageThread.user2.surname}}</div> <div class="badge badge-assertive" ng-if="messageThread.numNuoviMsg>0">{{messageThread.numNuoviMsg}}</div> <div class="last-message" ng-bind-html="messageThread.lastMessage + '' | emojioneToImage | nl2br"></div> </ion-item> <ion-infinite-scroll ng-if="moreDataCanBeLoaded" on-infinite="loadMore()"> </ion-infinite-scroll> <div ng-if="messageThreads !== null && messageThreads.length>pageSize && !moreDataCanBeLoaded" class="wall-no-product-found">{{ 'No more chats to show.' | translate }}</div> </ion-content> </ion-view>