var servicesModule=angular.module("storageService",[]);servicesModule.factory("StorageService",["$translate","Environment",function(e,o){function t(e,o){var t=localStorage.getItem(e);o(t)}function n(e,o){localStorage.setItem(e,o)}function r(e){localStorage.removeItem(e)}function c(e){var o=localStorage.getItem("token");if(o&&o.length>0)for(var t=0,n=localStorage.length;n>t;++t){var r=localStorage.key(t);if("counter"!=r&&0!=r.indexOf("_")){var c=localStorage.getItem(r),a=function(o){localStorage.removeItem(o),--u,0==u&&e&&e()};++u,l.setItem(r,c,a,function(){--u})}}else e&&e()}function a(e){l.secureStorage.init(function(){i=!0,l.canEncrpyt=!0,c(e)},function(o){i=!0,l.canEncrpyt=!1,e&&e()},"pacifica")}var i=!1,l={canEncrpyt:!1,secureStorage:void 0,keys:{}};l.clear=function(){if(o.isStorageAllowed()&&i)if(l.canEncrpyt)for(var e in l.keys)l.removeItem(e),delete l[e];else localStorage.clear()},l.getItem=function(e,n){o.isStorageAllowed()&&i&&(l.canEncrpyt?l.secureStorage.get(function(e){n(e)},function(e){n(void 0)},e):t(e,n))},l.setItem=function(e,t,r){o.isStorageAllowed()&&i&&(l.canEncrpyt?l.secureStorage.set(function(e){l.keys[e]=e,r&&r(e)},function(e){},e,t):n(e,t))},l.removeItem=function(e){o.isStorageAllowed()&&i&&(l.canEncrpyt?l.secureStorage.remove(function(){},function(e){},e):r(e))};var u=0;return l.initialize=function(e){i||(window.cordova&&window.cordova.plugins&&window.cordova.plugins.SecureStorage?(l.secureStorage=new cordova.plugins.SecureStorage("pacifica"),o.isAndroid()?l.secureStorage.isKeyguardSecure(function(o){o?a(e):(l.canEncrpyt=!1,i=!0,e&&e())}):a(e)):(i=!0,e&&e()))},l}]);