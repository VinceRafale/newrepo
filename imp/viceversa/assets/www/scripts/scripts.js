!function(){angular.module("ngCordova",["ngCordova.plugins"]),angular.module("ngCordova.plugins.actionSheet",[]).factory("$cordovaActionSheet",["$q","$window",function(a,b){return{show:function(c){var d=a.defer();return b.plugins.actionsheet.show(c,function(a){d.resolve(a)}),d.promise},hide:function(){return b.plugins.actionsheet.hide()}}}]),angular.module("ngCordova.plugins.adMob",[]).factory("$cordovaAdMob",["$q","$window",function(a,b){return{createBannerView:function(c){var d=a.defer();return b.plugins.AdMob.createBannerView(c,function(){d.resolve()},function(){d.reject()}),d.promise},createInterstitialView:function(c){var d=a.defer();return b.plugins.AdMob.createInterstitialView(c,function(){d.resolve()},function(){d.reject()}),d.promise},requestAd:function(c){var d=a.defer();return b.plugins.AdMob.requestAd(c,function(){d.resolve()},function(){d.reject()}),d.promise},showAd:function(c){var d=a.defer();return b.plugins.AdMob.showAd(c,function(){d.resolve()},function(){d.reject()}),d.promise},requestInterstitialAd:function(c){var d=a.defer();return b.plugins.AdMob.requestInterstitialAd(c,function(){d.resolve()},function(){d.reject()}),d.promise}}}]),angular.module("ngCordova.plugins.appAvailability",[]).factory("$cordovaAppAvailability",["$q",function(a){return{check:function(b){var c=a.defer();return appAvailability.check(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("ngCordova.plugins.appRate",[]).provider("$cordovaAppRate",[function(){this.setAppUrl=function(a,b){var c=["ios","android","blackberry","windows8"];-1!==c.indexOf(a)?AppRate.preferences.storeAppURL[a]=b:alert("wrong device type")},this.useLanguage=function(a){AppRate.preferences.useLanguage=a},this.displayAppName=function(a){AppRate.preferences.displayAppName=a},this.promptAgainForEachNewVersion=function(a){AppRate.preferences.promptAgainForEachNewVersion=a},this.usesUntilPrompt=function(a){AppRate.preferences.usesUntilPrompt=a},this.openStoreInApp=function(a){AppRate.preferences.openStoreInApp=a},this.useCustomRateDialog=function(a){AppRate.preferences.useCustomRateDialog=a},this.customLocale=function(a){var b={title:"Rate %@",message:"If you enjoy using %@, would you mind taking a moment to rate it? It won’t take more than a minute. Thanks for your support!",cancelButtonLabel:"No, Thanks",laterButtonLabel:"Remind Me Later",rateButtonLabel:"Rate It Now"};b=angular.extend(b,a),AppRate.preferences.customLocale=b},this.$get=["$q",function(a){return{promptForRating:function(b){var c=a.defer(),d=AppRate.promptForRating(b);return c.resolve(d),c.promise},onButtonClicked:function(a){AppRate.onButtonClicked=function(b){a.call(this,b)}},onRateDialogShow:function(a){AppRate.onRateDialogShow=a()}}}]}]),angular.module("ngCordova.plugins.appVersion",[]).factory("$cordovaAppVersion",["$q",function(a){return{getAppVersion:function(){var b=a.defer();return cordova.getAppVersion(function(a){b.resolve(a)}),b.promise}}}]),angular.module("ngCordova.plugins.backgroundGeolocation",[]).factory("$cordovaBackgroundGeolocation",["$q","$window",function(a,b){return{init:function(){b.navigator.geolocation.getCurrentPosition(function(a){return a})},configure:function(c){this.init();var d=a.defer();return b.plugins.backgroundGeoLocation.configure(function(a){d.notify(a),b.plugins.backgroundGeoLocation.finish()},function(a){d.reject(a)},c),this.start(),d.promise},start:function(){var c=a.defer();return b.plugins.backgroundGeoLocation.start(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},stop:function(){var c=a.defer();return b.plugins.backgroundGeoLocation.stop(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("ngCordova.plugins.badge",[]).factory("$cordovaBadge",["$q",function(a){return{hasPermission:function(){var b=a.defer();return cordova.plugins.notification.badge.hasPermission(function(a){a?b.resolve(!0):b.reject("You do not have permission")}),b.promise},promptForPermission:function(){return cordova.plugins.notification.badge.promptForPermission()},set:function(b){var c=a.defer();return cordova.plugins.notification.badge.hasPermission(function(a){a?c.resolve(cordova.plugins.notification.badge.set(b)):c.reject("You do not have permission to set Badge")}),c.promise},get:function(){var b=a.defer();return cordova.plugins.notification.badge.hasPermission(function(a){a?cordova.plugins.notification.badge.get(function(a){b.resolve(a)}):b.reject("You do not have permission to get Badge")}),b.promise},clear:function(){var b=a.defer();return cordova.plugins.notification.badge.hasPermission(function(a){a?b.resolve(cordova.plugins.notification.badge.clear()):b.reject("You do not have permission to clear Badge")}),b.promise},configure:function(a){return cordova.plugins.notification.badge.configure(a)}}}]),angular.module("ngCordova.plugins.barcodeScanner",[]).factory("$cordovaBarcodeScanner",["$q",function(a){return{scan:function(){var b=a.defer();return cordova.plugins.barcodeScanner.scan(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},encode:function(b,c){var d=a.defer();return b=b||"TEXT_TYPE",cordova.plugins.barcodeScanner.encode(b,c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}}}]),angular.module("ngCordova.plugins.batteryStatus",[]).factory("$cordovaBatteryStatus",["$rootScope","$window","$timeout",function(a,b,c){var d=function(b){c(function(){a.$broadcast("$cordovaBatteryStatus:status",b)})},e=function(b){c(function(){a.$broadcast("$cordovaBatteryStatus:critical",b)})},f=function(b){c(function(){a.$broadcast("$cordovaBatteryStatus:low",b)})};return document.addEventListener("deviceready",function(){navigator.battery&&(b.addEventListener("batterystatus",d,!1),b.addEventListener("batterycritical",e,!1),b.addEventListener("batterylow",f,!1))},!1),!0}]).run(["$cordovaBatteryStatus",function(){}]),angular.module("ngCordova.plugins.ble",[]).factory("$cordovaBLE",["$q",function(a){return{scan:function(b,c){var d=a.defer();return ble.scan(b,c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},connect:function(b){var c=a.defer();return ble.connect(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},disconnect:function(b){var c=a.defer();return ble.disconnect(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},read:function(b,c,d){var e=a.defer();return ble.read(b,c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},write:function(b,c,d,e){var f=a.defer();return ble.write(b,c,d,e,function(a){f.resolve(a)},function(a){f.reject(a)}),f.promise},writeCommand:function(b,c,d,e){var f=a.defer();return ble.writeCommand(b,c,d,e,function(a){f.resolve(a)},function(a){f.reject(a)}),f.promise},notify:function(b,c,d){var e=a.defer();return ble.notify(b,c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},indicate:function(b,c,d){var e=a.defer();return ble.indicate(b,c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},isConnected:function(b){var c=a.defer();return ble.isConnected(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},isEnabled:function(){var b=a.defer();return ble.isEnabled(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise}}}]),angular.module("ngCordova.plugins.bluetoothSerial",[]).factory("$cordovaBluetoothSerial",["$q","$window",function(a,b){return{connect:function(c){var d=a.defer();return b.bluetoothSerial.connect(c,function(){d.resolve()},function(a){d.reject(a)}),d.promise},connectInsecure:function(c){var d=a.defer();return b.bluetoothSerial.connectInsecure(c,function(){d.resolve()},function(a){d.reject(a)}),d.promise},disconnect:function(){var c=a.defer();return b.bluetoothSerial.disconnect(function(){c.resolve()},function(a){c.reject(a)}),c.promise},list:function(){var c=a.defer();return b.bluetoothSerial.list(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},isEnabled:function(){var c=a.defer();return b.bluetoothSerial.isEnabled(function(){c.resolve()},function(){c.reject()}),c.promise},isConnected:function(){var c=a.defer();return b.bluetoothSerial.isConnected(function(){c.resolve()},function(){c.reject()}),c.promise},available:function(){var c=a.defer();return b.bluetoothSerial.available(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},read:function(){var c=a.defer();return b.bluetoothSerial.read(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},readUntil:function(c){var d=a.defer();return b.bluetoothSerial.readUntil(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},write:function(c){var d=a.defer();return b.bluetoothSerial.write(c,function(){d.resolve()},function(a){d.reject(a)}),d.promise},subscribe:function(c){var d=a.defer();return b.bluetoothSerial.subscribe(c,function(a){d.notify(a)},function(a){d.reject(a)}),d.promise},subscribeRawData:function(){var c=a.defer();return b.bluetoothSerial.subscribeRawData(function(a){c.notify(a)},function(a){c.reject(a)}),c.promise},unsubscribe:function(){var c=a.defer();return b.bluetoothSerial.unsubscribe(function(){c.resolve()},function(a){c.reject(a)}),c.promise},unsubscribeRawData:function(){var c=a.defer();return b.bluetoothSerial.unsubscribeRawData(function(){c.resolve()},function(a){c.reject(a)}),c.promise},clear:function(){var c=a.defer();return b.bluetoothSerial.clear(function(){c.resolve()},function(a){c.reject(a)}),c.promise},readRSSI:function(){var c=a.defer();return b.bluetoothSerial.readRSSI(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("ngCordova.plugins.brightness",[]).factory("$cordovaBrightness",["$q","$window",function(a,b){return{get:function(){var c=a.defer();return b.cordova.plugins.brightness.getBrightness(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},set:function(c){var d=a.defer();return b.cordova.plugins.brightness.setBrightness(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},setKeepScreenOn:function(c){var d=a.defer();return b.cordova.plugins.brightness.setKeepScreenOn(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}}}]),angular.module("ngCordova.plugins.calendar",[]).factory("$cordovaCalendar",["$q","$window",function(a,b){return{createCalendar:function(c){var d=a.defer(),e=b.plugins.calendar.getCreateCalendarOptions();return"string"==typeof c?e.calendarName=c:e=angular.extend(e,c),b.plugins.calendar.createCalendar(e,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},deleteCalendar:function(c){var d=a.defer();return b.plugins.calendar.deleteCalendar(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},createEvent:function(c){var d=a.defer(),e={title:null,location:null,notes:null,startDate:null,endDate:null};return e=angular.extend(e,c),b.plugins.calendar.createEvent(e.title,e.location,e.notes,new Date(e.startDate),new Date(e.endDate),function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},createEventWithOptions:function(c){var d=a.defer(),e=[],f=window.plugins.calendar.getCalendarOptions(),g={title:null,location:null,notes:null,startDate:null,endDate:null};e=Object.keys(g);for(var h in c)-1===e.indexOf(h)?f[h]=c[h]:g[h]=c[h];return b.plugins.calendar.createEventWithOptions(g.title,g.location,g.notes,new Date(g.startDate),new Date(g.endDate),f,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},createEventInteractively:function(c){var d=a.defer(),e={title:null,location:null,notes:null,startDate:null,endDate:null};return e=angular.extend(e,c),b.plugins.calendar.createEventInteractively(e.title,e.location,e.notes,new Date(e.startDate),new Date(e.endDate),function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},createEventInNamedCalendar:function(c){var d=a.defer(),e={title:null,location:null,notes:null,startDate:null,endDate:null,calendarName:null};return e=angular.extend(e,c),b.plugins.calendar.createEventInNamedCalendar(e.title,e.location,e.notes,new Date(e.startDate),new Date(e.endDate),e.calendarName,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},findEvent:function(c){var d=a.defer(),e={title:null,location:null,notes:null,startDate:null,endDate:null};return e=angular.extend(e,c),b.plugins.calendar.findEvent(e.title,e.location,e.notes,new Date(e.startDate),new Date(e.endDate),function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},listEventsInRange:function(c,d){var e=a.defer();return b.plugins.calendar.listEventsInRange(c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},listCalendars:function(){var c=a.defer();return b.plugins.calendar.listCalendars(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},findAllEventsInNamedCalendar:function(c){var d=a.defer();return b.plugins.calendar.findAllEventsInNamedCalendar(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},modifyEvent:function(c){var d=a.defer(),e={title:null,location:null,notes:null,startDate:null,endDate:null,newTitle:null,newLocation:null,newNotes:null,newStartDate:null,newEndDate:null};return e=angular.extend(e,c),b.plugins.calendar.modifyEvent(e.title,e.location,e.notes,new Date(e.startDate),new Date(e.endDate),e.newTitle,e.newLocation,e.newNotes,new Date(e.newStartDate),new Date(e.newEndDate),function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},deleteEvent:function(c){var d=a.defer(),e={newTitle:null,location:null,notes:null,startDate:null,endDate:null};return e=angular.extend(e,c),b.plugins.calendar.deleteEvent(e.newTitle,e.location,e.notes,new Date(e.startDate),new Date(e.endDate),function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}}}]),angular.module("ngCordova.plugins.camera",[]).factory("$cordovaCamera",["$q",function(a){return{getPicture:function(b){var c=a.defer();return navigator.camera?(navigator.camera.getPicture(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise):(c.resolve(null),c.promise)},cleanup:function(){var b=a.defer();return navigator.camera.cleanup(function(){b.resolve()},function(a){b.reject(a)}),b.promise}}}]),angular.module("ngCordova.plugins.capture",[]).factory("$cordovaCapture",["$q",function(a){return{captureAudio:function(b){var c=a.defer();return navigator.device.capture?(navigator.device.capture.captureAudio(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise):(c.resolve(null),c.promise)},captureImage:function(b){var c=a.defer();return navigator.device.capture?(navigator.device.capture.captureImage(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise):(c.resolve(null),c.promise)},captureVideo:function(b){var c=a.defer();return navigator.device.capture?(navigator.device.capture.captureVideo(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise):(c.resolve(null),c.promise)}}}]),angular.module("ngCordova.plugins.clipboard",[]).factory("$cordovaClipboard",["$q","$window",function(a,b){return{copy:function(c){var d=a.defer();return b.cordova.plugins.clipboard.copy(c,function(){d.resolve()},function(){d.reject()}),d.promise},paste:function(){var c=a.defer();return b.cordova.plugins.clipboard.paste(function(a){c.resolve(a)},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.contacts",[]).factory("$cordovaContacts",["$q",function(a){return{save:function(b){var c=a.defer(),d=navigator.contacts.create(b);return d.save(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},remove:function(b){var c=a.defer(),d=navigator.contacts.create(b);return d.remove(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},clone:function(a){var b=navigator.contacts.create(a);return b.clone(a)},find:function(b){var c=a.defer(),d=b.fields||["id","displayName"];return delete b.fields,navigator.contacts.find(d,function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise},pickContact:function(){var b=a.defer();return navigator.contacts.pickContact(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise}}}]),angular.module("ngCordova.plugins.datePicker",[]).factory("$cordovaDatePicker",["$window","$q",function(a,b){return{show:function(c){var d=b.defer();return c=c||{date:new Date,mode:"date"},a.datePicker.show(c,function(a){d.resolve(a)}),d.promise}}}]),angular.module("ngCordova.plugins.device",[]).factory("$cordovaDevice",[function(){return{getDevice:function(){return device},getCordova:function(){return device.cordova},getModel:function(){return device.model},getName:function(){return device.name},getPlatform:function(){return device.platform},getUUID:function(){return device.uuid},getVersion:function(){return device.version}}}]),angular.module("ngCordova.plugins.deviceMotion",[]).factory("$cordovaDeviceMotion",["$q",function(a){return{getCurrentAcceleration:function(){var b=a.defer();return navigator.accelerometer.getCurrentAcceleration(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},watchAcceleration:function(b){var c=a.defer(),d=navigator.accelerometer.watchAcceleration(function(a){c.notify(a)},function(a){c.reject(a)},b);return c.promise.cancel=function(){navigator.accelerometer.clearWatch(d)},c.promise.clearWatch=function(a){navigator.accelerometer.clearWatch(a||d)},c.promise.watchID=d,c.promise},clearWatch:function(a){return navigator.accelerometer.clearWatch(a)}}}]),angular.module("ngCordova.plugins.deviceOrientation",[]).factory("$cordovaDeviceOrientation",["$q",function(a){return{getCurrentHeading:function(){var b=a.defer();return navigator.compass.getCurrentHeading(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},watchHeading:function(b){var c=a.defer(),d=navigator.compass.watchHeading(function(a){c.notify(a)},function(a){c.reject(a)},b);return c.promise.cancel=function(){navigator.compass.clearWatch(d)},c.promise.clearWatch=function(a){navigator.compass.clearWatch(a||d)},c.promise.watchID=d,c.promise},clearWatch:function(a){return navigator.compass.clearWatch(a)}}}]),angular.module("ngCordova.plugins.dialogs",[]).factory("$cordovaDialogs",["$q","$window",function(a,b){return{alert:function(c,d,e){var f=a.defer();return b.navigator.notification?navigator.notification.alert(c,function(){f.resolve()},d,e):(b.alert(c),f.resolve()),f.promise},confirm:function(c,d,e){var f=a.defer();return b.navigator.notification?navigator.notification.confirm(c,function(a){f.resolve(a)},d,e):f.resolve(b.confirm(c)?1:2),f.promise},prompt:function(c,d,e,f){var g=a.defer();if(b.navigator.notification)navigator.notification.prompt(c,function(a){g.resolve(a)},d,e,f);else{var h=b.prompt(c,f);g.resolve(null!==h?{input1:h,buttonIndex:1}:{input1:h,buttonIndex:2})}return g.promise},beep:function(a){return navigator.notification.beep(a)}}}]),angular.module("ngCordova.plugins.emailComposer",[]).factory("$cordovaEmailComposer",["$q",function(a){return{isAvailable:function(){var b=a.defer();return cordova.plugins.email.isAvailable(function(a){a?b.resolve():b.reject()}),b.promise},open:function(b){var c=a.defer();return cordova.plugins.email.open(b,function(){c.reject()}),c.promise},addAlias:function(a,b){cordova.plugins.email.addAlias(a,b)}}}]),angular.module("ngCordova.plugins.facebook",[]).provider("$cordovaFacebook",[function(){this.browserInit=function(a,b){this.appID=a,this.appVersion=b||"v2.0",facebookConnectPlugin.browserInit(this.appID,this.appVersion)},this.$get=["$q",function(a){return{login:function(b){var c=a.defer();return facebookConnectPlugin.login(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},showDialog:function(b){var c=a.defer();return facebookConnectPlugin.showDialog(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},api:function(b,c){var d=a.defer();return facebookConnectPlugin.api(b,c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},getAccessToken:function(){var b=a.defer();return facebookConnectPlugin.getAccessToken(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},getLoginStatus:function(){var b=a.defer();return facebookConnectPlugin.getLoginStatus(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},logout:function(){var b=a.defer();return facebookConnectPlugin.logout(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise}}}]}]),angular.module("ngCordova.plugins.facebookAds",[]).factory("$cordovaFacebookAds",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.FacebookAds.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.FacebookAds.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.FacebookAds.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();return b.FacebookAds.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.FacebookAds.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.FacebookAds.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.FacebookAds.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.FacebookAds.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.file",[]).factory("$cordovaFile",["$q","$window","$log","$timeout",function(a,b,c,d){function e(a){var b=new FileReader;return b.onloadend=function(){this.error?a.reject(this.error):a.resolve(this.result)},b}function f(b,c){var d=a.defer();return h(b,c).then(function(a){a.file(d.resolve,d.reject)},d.reject),d.promise}function g(b,c){var d=a.defer();return h(b,c).then(function(a){a.createWriter(d.resolve,d.reject)},d.reject),d.promise}function h(b,c){var d=a.defer();return k().then(function(a){a.root.getFile(b,c,d.resolve,d.reject)},d.reject),d.promise}function i(c){var d=a.defer();return b.resolveLocalFileSystemURL(c,function(a){a.file(d.resolve,d.reject)},d.reject),d.promise}function j(b,c){var d=a.defer();return k().then(function(a){a.root.getDirectory(b,c,d.resolve,d.reject)},d.reject),d.promise}function k(){var c=a.defer();try{b.requestFileSystem(b.PERSISTENT,1048576,c.resolve,c.reject)}catch(d){c.reject(d)}return c.promise}return{checkDir:function(a){return j(a,{create:!1})},createDir:function(a,b){return j(a,{create:!0,exclusive:b})},listDir:function(b){var c=a.defer();return j(b,{create:!1}).then(function(a){var d=a.createReader();d.readEntries(function(a){c.resolve(a)},function(){c.reject("DIR_READ_ERROR : "+b)})},function(){c.reject("DIR_NOT_FOUND : "+b)}),c.promise},checkFile:function(a){return 2==arguments.length&&(a="/"+a+"/"+arguments[1]),h(a,{create:!1})},createFile:function(a,b){return 3==arguments.length&&(a="/"+a+"/"+arguments[1],b=arguments[2]),h(a,{create:!0,exclusive:b})},removeFile:function(b){var c=a.defer();return 2==arguments.length&&(b="/"+b+"/"+arguments[1]),h(b,{create:!1}).then(function(a){a.remove(c.resolve,c.reject)},c.reject),c.promise},writeFile:function(b,c,d){var e=a.defer();return g(b,{create:!0}).then(function(a){d&&d.append===!0&&a.seek(a.length),a.onwriteend=function(a){this.error?e.reject(this.error):e.resolve(a)},a.write(c)},e.reject),e.promise},readFile:function(a){return c.log("readFile is now deprecated as of v0.1.4-alpha, use readAsText instead"),this.readAsText(a)},readAsText:function(b){var c=a.defer();return 2==arguments.length&&(b="/"+b+"/"+arguments[1]),f(b,{create:!1}).then(function(a){e(c).readAsText(a)},c.reject),c.promise},readAsDataURL:function(b){var c=a.defer();return 2==arguments.length&&(b="/"+b+"/"+arguments[1]),f(b,{create:!1}).then(function(a){e(c).readAsDataURL(a)},c.reject),c.promise},readAsBinaryString:function(b){var c=a.defer();return 2==arguments.length&&(b="/"+b+"/"+arguments[1]),f(b,{create:!1}).then(function(a){e(c).readAsBinaryString(a)},c.reject),c.promise},readAsArrayBuffer:function(b){var c=a.defer();return 2==arguments.length&&(b="/"+b+"/"+arguments[1]),f(b,{create:!1}).then(function(a){e(c).readAsArrayBuffer(a)},c.reject),c.promise},readFileMetadata:function(a){return f(a,{create:!1})},readFileAbsolute:function(b){var c=a.defer();return i(b).then(function(a){e(c).readAsText(a)},c.reject),c.promise},readFileMetadataAbsolute:function(a){return i(a)},download:function(b,c,e,f){var g=a.defer(),h=new FileTransfer,i=encodeURI(b);return e&&void 0!==e.timeout&&null!==e.timeout&&(d(function(){h.abort()},e.timeout),e.timeout=null),h.onprogress=function(a){g.notify(a)},h.download(i,c,g.resolve,g.reject,f,e),g.promise},upload:function(b,c,e,f){var g=a.defer(),h=new FileTransfer,i=encodeURI(b);return e&&void 0!==e.timeout&&null!==e.timeout&&(d(function(){h.abort()},e.timeout),e.timeout=null),h.onprogress=function(a){g.notify(a)},g.promise.abort=function(){h.abort()},h.upload(c,i,g.resolve,g.reject,e,f),g.promise}}}]),angular.module("ngCordova.plugins.fileOpener2",[]).factory("$cordovaFileOpener2",["$q",function(a){return{open:function(b,c){var d=a.defer();return cordova.plugins.fileOpener2.open(b,c,{error:function(a){d.reject(a)},success:function(){d.resolve()}}),d.promise},uninstall:function(b){var c=a.defer();return cordova.plugins.fileOpener2.uninstall(b,{error:function(a){c.reject(a)},success:function(){c.resolve()}}),c.promise},appIsInstalled:function(b){var c=a.defer();return cordova.plugins.fileOpener2.appIsInstalled(b,{success:function(a){c.resolve(a)}}),c.promise}}}]),angular.module("ngCordova.plugins.fileTransfer",[]).factory("$cordovaFileTransfer",["$q","$timeout",function(a,b){return{download:function(c,d,e,f){var g=a.defer(),h=new FileTransfer,i=e.encodeURI===!1?c:encodeURI(c);return e&&void 0!==e.timeout&&null!==e.timeout&&(b(function(){h.abort()},e.timeout),e.timeout=null),h.onprogress=function(a){g.notify(a)},h.download(i,d,g.resolve,g.reject,f,e),g.promise},upload:function(c,d,e,f){var g=a.defer(),h=new FileTransfer,i=e.encodeURI===!1?c:encodeURI(c);return e&&void 0!==e.timeout&&null!==e.timeout&&(b(function(){h.abort()},e.timeout),e.timeout=null),h.onprogress=function(a){g.notify(a)},g.promise.abort=function(){h.abort()},h.upload(d,i,g.resolve,g.reject,e,f),g.promise}}}]),angular.module("ngCordova.plugins.flashlight",[]).factory("$cordovaFlashlight",["$q","$window",function(a,b){return{available:function(){var c=a.defer();return b.plugins.flashlight.available(function(a){c.resolve(a)}),c.promise},switchOn:function(){var c=a.defer();return b.plugins.flashlight.switchOn(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},switchOff:function(){var c=a.defer();return b.plugins.flashlight.switchOff(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},toggle:function(){var c=a.defer();return b.plugins.flashlight.toggle(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("ngCordova.plugins.flurryAds",[]).factory("$cordovaFlurryAds",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.FlurryAds.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.FlurryAds.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.FlurryAds.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();return b.FlurryAds.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.FlurryAds.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.FlurryAds.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.FlurryAds.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.FlurryAds.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.ga",[]).factory("$cordovaGA",["$q","$window",function(a,b){return{init:function(c,d){var e=a.defer();return d=d>=0?d:10,b.plugins.gaPlugin.init(function(a){e.resolve(a)},function(a){e.reject(a)},c,d),e.promise},trackEvent:function(c,d,e,f,g,h){var i=a.defer();return b.plugins.gaPlugin.trackEvent(function(a){i.resolve(a)},function(a){i.reject(a)},e,f,g,h),i.promise},trackPage:function(c,d,e){var f=a.defer();return b.plugins.gaPlugin.trackPage(function(a){f.resolve(a)},function(a){f.reject(a)},e),f.promise},setVariable:function(c,d,e,f){var g=a.defer();return b.plugins.gaPlugin.setVariable(function(a){g.resolve(a)},function(a){g.reject(a)},e,f),g.promise},exit:function(){var c=a.defer();return b.plugins.gaPlugin.exit(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("ngCordova.plugins.geolocation",[]).factory("$cordovaGeolocation",["$q",function(a){return{getCurrentPosition:function(b){var c=a.defer();return navigator.geolocation.getCurrentPosition(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise},watchPosition:function(b){var c=a.defer(),d=navigator.geolocation.watchPosition(function(a){c.notify(a)},function(a){c.reject(a)},b);return c.promise.cancel=function(){navigator.geolocation.clearWatch(d)},c.promise.clearWatch=function(a){navigator.geolocation.clearWatch(a||d)},c.promise.watchID=d,c.promise},clearWatch:function(a){return navigator.geolocation.clearWatch(a)}}}]),angular.module("ngCordova.plugins.globalization",[]).factory("$cordovaGlobalization",["$q",function(a){return{getPreferredLanguage:function(){var b=a.defer();return navigator.globalization.getPreferredLanguage(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},getLocaleName:function(){var b=a.defer();return navigator.globalization.getLocaleName(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},getFirstDayOfWeek:function(){var b=a.defer();return navigator.globalization.getFirstDayOfWeek(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},dateToString:function(b,c){var d=a.defer();return navigator.globalization.dateToString(b,function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise},stringToDate:function(b,c){var d=a.defer();return navigator.globalization.stringToDate(b,function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise},getDatePattern:function(b){var c=a.defer();return navigator.globalization.getDatePattern(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise},getDateNames:function(b){var c=a.defer();return navigator.globalization.getDateNames(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise},isDayLightSavingsTime:function(b){var c=a.defer();return navigator.globalization.isDayLightSavingsTime(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},numberToString:function(b,c){var d=a.defer();return navigator.globalization.numberToString(b,function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise},stringToNumber:function(b,c){var d=a.defer();return navigator.globalization.stringToNumber(b,function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise},getNumberPattern:function(b){var c=a.defer();return navigator.globalization.getNumberPattern(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise},getCurrencyPattern:function(b){var c=a.defer();return navigator.globalization.getCurrencyPattern(b,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("ngCordova.plugins.googleAds",[]).factory("$cordovaGoogleAds",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.AdMob.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.AdMob.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.AdMob.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();
return b.AdMob.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.AdMob.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.AdMob.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.AdMob.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.AdMob.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.googleAnalytics",[]).factory("$cordovaGoogleAnalytics",["$q","$window",function(a,b){return{startTrackerWithId:function(c){var d=a.defer();return b.analytics.startTrackerWithId(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},setUserId:function(c){var d=a.defer();return b.analytics.setUserId(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},debugMode:function(){var c=a.defer();return b.analytics.debugMode(function(a){c.resolve(a)},function(){c.reject()}),c.promise},trackView:function(c){var d=a.defer();return b.analytics.trackView(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},addCustomDimension:function(c,d){var e=a.defer();return b.analytics.addCustomDimension(c,d,function(){e.resolve()},function(a){e.reject(a)}),e.promise},trackEvent:function(c,d,e,f){var g=a.defer();return b.analytics.trackEvent(c,d,e,f,function(a){g.resolve(a)},function(a){g.reject(a)}),g.promise},addTransaction:function(c,d,e,f,g,h){var i=a.defer();return b.analytics.addTransaction(c,d,e,f,g,h,function(a){i.resolve(a)},function(a){i.reject(a)}),i.promise},addTransactionItem:function(c,d,e,f,g,h,i){var j=a.defer();return b.analytics.addTransactionItem(c,d,e,f,g,h,i,function(a){j.resolve(a)},function(a){j.reject(a)}),j.promise}}}]),angular.module("ngCordova.plugins.googleMap",[]).factory("$cordovaGoogleMap",["$q","$window",function(a,b){var c=null;return{getMap:function(d){var e=a.defer();if(b.plugin.google.maps){var f=document.getElementById("map_canvas");c=b.plugin.google.maps.Map.getMap(d),c.setDiv(f),e.resolve(c)}else e.reject(null);return e.promise},isMapLoaded:function(){return!!c},addMarker:function(b){var d=a.defer();return c.addMarker(b,function(a){d.resolve(a)}),d.promise},getMapTypeIds:function(){return b.plugin.google.maps.mapTypeId},setVisible:function(b){var d=a.defer();return c.setVisible(b),d.promise},cleanup:function(){c=null}}}]),angular.module("ngCordova.plugins.httpd",[]).factory("$cordovaHttpd",["$q",function(a){return{startServer:function(b){var c=a.defer();return cordova.plugins.CorHttpd.startServer(b,function(){c.resolve()},function(){c.reject()}),c.promise},stopServer:function(){var b=a.defer();return cordova.plugins.CorHttpd.stopServer(function(){b.resolve()},function(){b.reject()}),b.promise},getURL:function(){var b=a.defer();return cordova.plugins.CorHttpd.getURL(function(a){b.resolve(a)},function(){b.reject()}),b.promise},getLocalPath:function(){var b=a.defer();return cordova.plugins.CorHttpd.getLocalPath(function(a){b.resolve(a)},function(){b.reject()}),b.promise}}}]),angular.module("ngCordova.plugins.iAd",[]).factory("$cordovaiAd",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.iAd.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.iAd.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.iAd.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();return b.iAd.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.iAd.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.iAd.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.iAd.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.iAd.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.imagePicker",[]).factory("$cordovaImagePicker",["$q","$window",function(a,b){return{getPictures:function(c){var d=a.defer();return b.imagePicker.getPictures(function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise}}}]),angular.module("ngCordova.plugins.inAppBrowser",[]).provider("$cordovaInAppBrowser",[function(){var a,b=this.defaultOptions={};this.setDefaultOptions=function(a){b=angular.extend(b,a)},this.$get=["$rootScope","$q","$window","$timeout",function(c,d,e,f){return{open:function(g,h,i){var j=d.defer(),k="";if(i&&angular.isObject(i)){var l=angular.extend(b,i),m=[];angular.forEach(l,function(a,b){m.push(b+"="+a)}),k=m.join()}else if(i&&!angular.isObject(i))return j.reject("options must be an object"),j.promise;return a=e.open(g,h,k),a.addEventListener("loadstart",function(a){f(function(){c.$broadcast("$cordovaInAppBrowser:loadstart",a)})},!1),a.addEventListener("loadstop",function(a){j.resolve(a),f(function(){c.$broadcast("$cordovaInAppBrowser:loadstop",a)})},!1),a.addEventListener("loaderror",function(a){j.reject(a),f(function(){c.$broadcast("$cordovaInAppBrowser:loaderror",a)})},!1),a.addEventListener("exit",function(a){f(function(){c.$broadcast("$cordovaInAppBrowser:exit",a)})},!1),j.promise},close:function(){a.close()},show:function(){a.show()},executeScript:function(b){var c=d.defer();return a.executeScript(b,function(a){c.resolve(a)}),c.promise},insertCSS:function(b){var c=d.defer();return a.insertCSS(b,function(a){c.resolve(a)}),c.promise}}}]}]),angular.module("ngCordova.plugins.keyboard",[]).factory("$cordovaKeyboard",[function(){return{hideAccessoryBar:function(a){return cordova.plugins.Keyboard.hideKeyboardAccessoryBar(a)},close:function(){return cordova.plugins.Keyboard.close()},disableScroll:function(a){return cordova.plugins.Keyboard.disableScroll(a)},isVisible:function(){return cordova.plugins.Keyboard.isVisible}}}]),angular.module("ngCordova.plugins.keychain",[]).factory("$cordovaKeychain",["$q","$window",function(a,b){if("Keychain"in b)var c=new Keychain;return{getForKey:function(b,d){var e=a.defer();return c.getForKey(e.resolve,e.reject,b,d),e.promise},setForKey:function(b,d,e){var f=a.defer();return c.setForKey(f.resolve,f.reject,b,d,e),f.promise},removeForKey:function(b,d){var e=a.defer();return c.removeForKey(e.resolve,e.reject,b,d),e.promise}}}]),angular.module("ngCordova.plugins.localNotification",[]).factory("$cordovaLocalNotification",["$q","$window","$rootScope","$timeout",function(a,b,c,d){return b.plugin&&b.plugin.notification&&(b.plugin.notification.local.oncancel=function(a,b,e){var f={id:a,state:b,json:e};d(function(){c.$broadcast("$cordovaLocalNotification:canceled",f)})},b.plugin.notification.local.onclick=function(a,b,e){var f={id:a,state:b,json:e};d(function(){c.$broadcast("$cordovaLocalNotification:clicked",f)})},b.plugin.notification.local.ontrigger=function(a,b,e){var f={id:a,state:b,json:e};d(function(){c.$broadcast("$cordovaLocalNotification:triggered",f)})},b.plugin.notification.local.onadd=function(a,b,e){var f={id:a,state:b,json:e};d(function(){c.$broadcast("$cordovaLocalNotification:added",f)})}),{add:function(c,d){var e=a.defer();return d=d||null,b.plugin.notification.local.add(c,function(a){e.resolve(a)},d),e.promise},cancel:function(c,d){var e=a.defer();return d=d||null,b.plugin.notification.local.cancel(c,function(a){e.resolve(a)},d),e.promise},cancelAll:function(c){var d=a.defer();return c=c||null,b.plugin.notification.local.cancelAll(function(a){d.resolve(a)},c),d.promise},isScheduled:function(c,d){var e=a.defer();return d=d||null,b.plugin.notification.local.isScheduled(c,function(a){e.resolve(a)},d),e.promise},hasPermission:function(c){var d=a.defer();return b.plugin.notification.local.hasPermission(function(a){a?d.resolve():d.reject()},c),d.promise},promptForPermission:function(){b.plugin.notification.local.promptForPermission()},registerPermission:function(){var c=a.defer();return b.plugin.notification.local.registerPermission(function(a){a?c.resolve():c.reject()}),c.promise},getScheduledIds:function(c){var d=a.defer();return b.plugin.notification.local.getScheduledIds(function(a){d.resolve(a)},c),d.promise},isTriggered:function(c,d){var e=a.defer();return b.plugin.notification.local.isTriggered(c,function(a){e.resolve(a)},d),e.promise},getTriggeredIds:function(c){var d=a.defer();return b.plugin.notification.local.getTriggeredIds(function(a){d.resolve(a)},c),d.promise},getDefaults:function(){return b.plugin.notification.local.getDefaults()},setDefaults:function(a){b.plugin.notification.local.setDefaults(a)}}}]),angular.module("ngCordova.plugins.mMediaAds",[]).factory("$cordovaMMediaAds",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.mMedia.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.mMedia.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.mMedia.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();return b.mMedia.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.mMedia.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.mMedia.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.mMedia.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.mMedia.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.media",[]).factory("$cordovaMedia",["$q",function(a){return{newMedia:function(b){var c,d=a.defer(),e=null;return c=new Media(b,function(a){d.resolve(a)},function(a){d.reject(a)},function(a){e=a}),d.promise.getCurrentPosition=function(){c.getCurrentPosition(function(){},function(){})},d.promise.getDuration=function(){c.getDuration()},d.promise.play=function(a){"object"!=typeof a&&(a={}),c.play(a)},d.promise.pause=function(){c.pause()},d.promise.stop=function(){c.stop()},d.promise.release=function(){c.release()},d.promise.seekTo=function(a){c.seekTo(a)},d.promise.setVolume=function(a){c.setVolume(a)},d.promise.startRecord=function(){c.startRecord()},d.promise.stopRecord=function(){c.stopRecord()},d.promise}}}]),angular.module("ngCordova.plugins.mobfoxAds",[]).factory("$cordovaMobFoxAds",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.MobFox.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.MobFox.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.MobFox.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();return b.MobFox.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.MobFox.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.MobFox.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.MobFox.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.MobFox.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins",["ngCordova.plugins.actionSheet","ngCordova.plugins.adMob","ngCordova.plugins.appAvailability","ngCordova.plugins.appRate","ngCordova.plugins.appVersion","ngCordova.plugins.backgroundGeolocation","ngCordova.plugins.badge","ngCordova.plugins.barcodeScanner","ngCordova.plugins.batteryStatus","ngCordova.plugins.ble","ngCordova.plugins.bluetoothSerial","ngCordova.plugins.brightness","ngCordova.plugins.calendar","ngCordova.plugins.camera","ngCordova.plugins.capture","ngCordova.plugins.clipboard","ngCordova.plugins.contacts","ngCordova.plugins.datePicker","ngCordova.plugins.device","ngCordova.plugins.deviceMotion","ngCordova.plugins.deviceOrientation","ngCordova.plugins.dialogs","ngCordova.plugins.emailComposer","ngCordova.plugins.facebook","ngCordova.plugins.facebookAds","ngCordova.plugins.file","ngCordova.plugins.fileTransfer","ngCordova.plugins.fileOpener2","ngCordova.plugins.flashlight","ngCordova.plugins.flurryAds","ngCordova.plugins.ga","ngCordova.plugins.geolocation","ngCordova.plugins.globalization","ngCordova.plugins.googleAds","ngCordova.plugins.googleAnalytics","ngCordova.plugins.googleMap","ngCordova.plugins.httpd","ngCordova.plugins.iAd","ngCordova.plugins.imagePicker","ngCordova.plugins.inAppBrowser","ngCordova.plugins.keyboard","ngCordova.plugins.keychain","ngCordova.plugins.localNotification","ngCordova.plugins.media","ngCordova.plugins.mMediaAds","ngCordova.plugins.mobfoxAds","ngCordova.plugins.mopubAds","ngCordova.plugins.nativeAudio","ngCordova.plugins.network","ngCordova.plugins.oauth","ngCordova.plugins.oauthUtility","ngCordova.plugins.pinDialog","ngCordova.plugins.prefs","ngCordova.plugins.printer","ngCordova.plugins.progressIndicator","ngCordova.plugins.push","ngCordova.plugins.sms","ngCordova.plugins.socialSharing","ngCordova.plugins.spinnerDialog","ngCordova.plugins.splashscreen","ngCordova.plugins.sqlite","ngCordova.plugins.statusbar","ngCordova.plugins.toast","ngCordova.plugins.touchid","ngCordova.plugins.vibration","ngCordova.plugins.videoCapturePlus","ngCordova.plugins.zip"]),angular.module("ngCordova.plugins.mopubAds",[]).factory("$cordovaMoPubAds",["$q","$window",function(a,b){return{setOptions:function(c){var d=a.defer();return b.MoPub.setOptions(c,function(){d.resolve()},function(){d.reject()}),d.promise},createBanner:function(c){var d=a.defer();return b.MoPub.createBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},removeBanner:function(){var c=a.defer();return b.MoPub.removeBanner(function(){c.resolve()},function(){c.reject()}),c.promise},showBanner:function(c){var d=a.defer();return b.MoPub.showBanner(c,function(){d.resolve()},function(){d.reject()}),d.promise},showBannerAtXY:function(c,d){var e=a.defer();return b.MoPub.showBannerAtXY(c,d,function(){e.resolve()},function(){e.reject()}),e.promise},hideBanner:function(){var c=a.defer();return b.MoPub.hideBanner(function(){c.resolve()},function(){c.reject()}),c.promise},prepareInterstitial:function(c){var d=a.defer();return b.MoPub.prepareInterstitial(c,function(){d.resolve()},function(){d.reject()}),d.promise},showInterstitial:function(){var c=a.defer();return b.MoPub.showInterstitial(function(){c.resolve()},function(){c.reject()}),c.promise}}}]),angular.module("ngCordova.plugins.nativeAudio",[]).factory("$cordovaNativeAudio",["$q","$window",function(a,b){return{preloadSimple:function(c,d){var e=a.defer();return b.plugins.NativeAudio.preloadSimple(c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},preloadComplex:function(c,d,e,f){var g=a.defer();return b.plugins.NativeAudio.preloadComplex(c,d,e,f,function(a){g.resolve(a)},function(a){g.reject(a)}),g.promise},play:function(c,d){var e=a.defer();return b.plugins.NativeAudio.play(c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},stop:function(c){var d=a.defer();return b.plugins.NativeAudio.stop(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},loop:function(c){var d=a.defer();return b.plugins.NativeAudio.loop(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},unload:function(c){var d=a.defer();return b.plugins.NativeAudio.unload(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},setVolumeForComplexAsset:function(c,d){var e=a.defer();return b.plugins.NativeAudio.setVolumeForComplexAsset(c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise}}}]),angular.module("ngCordova.plugins.network",[]).factory("$cordovaNetwork",["$rootScope","$timeout",function(a,b){var c=function(){var c=navigator.connection.type;b(function(){a.$broadcast("$cordovaNetwork:offline",c)})},d=function(){var c=navigator.connection.type;b(function(){a.$broadcast("$cordovaNetwork:online",c)})};return document.addEventListener("deviceready",function(){navigator.connection&&(document.addEventListener("offline",c,!1),document.addEventListener("online",d,!1))}),{getNetwork:function(){return navigator.connection.type},isOnline:function(){var a=navigator.connection.type;return a!==Connection.UNKNOWN&&a!==Connection.NONE},isOffline:function(){var a=navigator.connection.type;return a===Connection.UNKNOWN||a===Connection.NONE},clearOfflineWatch:function(){document.removeEventListener("offline",c),a.$$listeners["$cordovaNetwork:offline"]=[]},clearOnlineWatch:function(){document.removeEventListener("online",c),a.$$listeners["$cordovaNetwork:online"]=[]}}}]).run(["$cordovaNetwork",function(){}]),angular.module("ngCordova.plugins.oauth",["ngCordova.plugins.oauthUtility"]).factory("$cordovaOauth",["$q","$http","$cordovaOauthUtility",function(a,b,c){return{adfs:function(c,d,e){var f=a.defer();if(window.cordova){var g=cordova.require("cordova/plugin_list").metadata;if(g.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var h=window.open(d+"/adfs/oauth2/authorize?response_type=code&client_id="+c+"&redirect_uri=http://localhost/callback&resource="+e,"_blank","location=no");h.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){var e=a.url.split("code=")[1];b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:d+"/adfs/oauth2/token",data:"client_id="+c+"&code="+e+"&redirect_uri=http://localhost/callback&grant_type=authorization_code"}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){h.close()},10)})}}),h.addEventListener("exit",function(){f.reject("The sign in flow was canceled")})}else f.reject("Could not find InAppBrowser plugin")}else f.reject("Cannot authenticate via a web browser");return f.promise},dropbox:function(b){var c=a.defer();if(window.cordova){var d=cordova.require("cordova/plugin_list").metadata;if(d.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var e=window.open("https://www.dropbox.com/1/oauth2/authorize?client_id="+b+"&redirect_uri=http://localhost/callback&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");e.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],d=b.split("&"),f=[],g=0;g<d.length;g++)f[d[g].split("=")[0]]=d[g].split("=")[1];void 0!==f.access_token&&null!==f.access_token?c.resolve({access_token:f.access_token,token_type:f.token_type,uid:f.uid}):c.reject("Problem authenticating"),setTimeout(function(){e.close()},10)}}),e.addEventListener("exit",function(){c.reject("The sign in flow was canceled")})}else c.reject("Could not find InAppBrowser plugin")}else c.reject("Cannot authenticate via a web browser");return c.promise},digitalOcean:function(c,d){var e=a.defer();if(window.cordova){var f=cordova.require("cordova/plugin_list").metadata;if(f.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var g=window.open("https://cloud.digitalocean.com/v1/oauth/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&response_type=code&scope=read%20write","_blank","location=no,clearsessioncache=yes,clearcache=yes");g.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){var f=a.url.split("code=")[1];b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://cloud.digitalocean.com/v1/oauth/token",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+f}).success(function(a){e.resolve(a)}).error(function(){e.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){g.close()},10)})}}),g.addEventListener("exit",function(){e.reject("The sign in flow was canceled")})}else e.reject("Could not find InAppBrowser plugin")}else e.reject("Cannot authenticate via a web browser");return e.promise},google:function(b,c){var d=a.defer();if(window.cordova){var e=cordova.require("cordova/plugin_list").metadata;if(e.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var f=window.open("https://accounts.google.com/o/oauth2/auth?client_id="+b+"&redirect_uri=http://localhost/callback&scope="+c.join(" ")+"&approval_prompt=force&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");f.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],c=b.split("&"),e=[],g=0;g<c.length;g++)e[c[g].split("=")[0]]=c[g].split("=")[1];void 0!==e.access_token&&null!==e.access_token?d.resolve({access_token:e.access_token,token_type:e.token_type,expires_in:e.expires_in}):d.reject("Problem authenticating"),setTimeout(function(){f.close()},10)}}),f.addEventListener("exit",function(){d.reject("The sign in flow was canceled")})}else d.reject("Could not find InAppBrowser plugin")}else d.reject("Cannot authenticate via a web browser");return d.promise},github:function(c,d,e){var f=a.defer();if(window.cordova){var g=cordova.require("cordova/plugin_list").metadata;if(g.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var h=window.open("https://github.com/login/oauth/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&scope="+e.join(","),"_blank","location=no,clearsessioncache=yes,clearcache=yes");h.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b.defaults.headers.post.accept="application/json",b({method:"post",url:"https://github.com/login/oauth/access_token",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){h.close()},10)}))}),h.addEventListener("exit",function(){f.reject("The sign in flow was canceled")})}else f.reject("Could not find InAppBrowser plugin")}else f.reject("Cannot authenticate via a web browser");return f.promise},facebook:function(b,c){var d=a.defer();if(window.cordova){var e=cordova.require("cordova/plugin_list").metadata;if(e.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var f=window.open("https://www.facebook.com/dialog/oauth?client_id="+b+"&redirect_uri=http://localhost/callback&response_type=token&scope="+c.join(","),"_blank","location=no,clearsessioncache=yes,clearcache=yes");f.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],c=b.split("&"),e=[],g=0;g<c.length;g++)e[c[g].split("=")[0]]=c[g].split("=")[1];void 0!==e.access_token&&null!==e.access_token?d.resolve({access_token:e.access_token,expires_in:e.expires_in}):d.reject("Problem authenticating"),setTimeout(function(){f.close()},10)}}),f.addEventListener("exit",function(){d.reject("The sign in flow was canceled")})}else d.reject("Could not find InAppBrowser plugin")}else d.reject("Cannot authenticate via a web browser");return d.promise},linkedin:function(c,d,e,f){var g=a.defer();if(window.cordova){var h=cordova.require("cordova/plugin_list").metadata;if(h.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var i=window.open("https://www.linkedin.com/uas/oauth2/authorization?client_id="+c+"&redirect_uri=http://localhost/callback&scope="+e.join(" ")+"&response_type=code&state="+f,"_blank","location=no,clearsessioncache=yes,clearcache=yes");i.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://www.linkedin.com/uas/oauth2/accessToken",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+requestToken}).success(function(a){g.resolve(a)}).error(function(){g.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){i.close()},10)}))}),i.addEventListener("exit",function(){g.reject("The sign in flow was canceled")})}else g.reject("Could not find InAppBrowser plugin")}else g.reject("Cannot authenticate via a web browser");return g.promise},instagram:function(b,c){var d=a.defer();if(window.cordova){var e=cordova.require("cordova/plugin_list").metadata;if(e.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var f=window.open("https://api.instagram.com/oauth/authorize/?client_id="+b+"&redirect_uri=http://localhost/callback&scope="+c.join(" ")+"&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");f.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],c=b.split("&"),e=[],g=0;g<c.length;g++)e[c[g].split("=")[0]]=c[g].split("=")[1];void 0!==e.access_token&&null!==e.access_token?d.resolve({access_token:e.access_token}):d.reject("Problem authenticating"),setTimeout(function(){f.close()},10)}}),f.addEventListener("exit",function(){d.reject("The sign in flow was canceled")})}else d.reject("Could not find InAppBrowser plugin")}else d.reject("Cannot authenticate via a web browser");return d.promise},box:function(c,d,e){var f=a.defer();if(window.cordova){var g=cordova.require("cordova/plugin_list").metadata;if(g.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var h=window.open("https://app.box.com/api/oauth2/authorize/?client_id="+c+"&redirect_uri=http://localhost/callback&state="+e+"&response_type=code","_blank","location=no,clearsessioncache=yes,clearcache=yes");h.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://app.box.com/api/oauth2/token",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){h.close()},10)}))}),h.addEventListener("exit",function(){f.reject("The sign in flow was canceled")})}else f.reject("Could not find InAppBrowser plugin")}else f.reject("Cannot authenticate via a web browser");return f.promise},reddit:function(c,d,e){var f=a.defer();if(window.cordova){var g=cordova.require("cordova/plugin_list").metadata;if(g.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var h=window.open("https://ssl.reddit.com/api/v1/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&duration=permanent&state=ngcordovaoauth&scope="+e.join(",")+"&response_type=code","_blank","location=no,clearsessioncache=yes,clearcache=yes");h.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b.defaults.headers.post.Authorization="Basic "+btoa(c+":"+d),b({method:"post",url:"https://ssl.reddit.com/api/v1/access_token",data:"redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){h.close()},10)}))}),h.addEventListener("exit",function(){f.reject("The sign in flow was canceled")})}else f.reject("Could not find InAppBrowser plugin")}else f.reject("Cannot authenticate via a web browser");return f.promise},twitter:function(d,e){var f=a.defer();if(window.cordova){var g=cordova.require("cordova/plugin_list").metadata;if(g.hasOwnProperty("org.apache.cordova.inappbrowser")===!0)if("undefined"!=typeof jsSHA){var h={oauth_consumer_key:d,oauth_nonce:c.createNonce(10),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:Math.round((new Date).getTime()/1e3),oauth_version:"1.0"},i=c.createSignature("POST","https://api.twitter.com/oauth/request_token",h,{oauth_callback:"http://localhost/callback"},e);b.defaults.headers.post.Authorization=i.authorization_header,b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://api.twitter.com/oauth/request_token",data:"oauth_callback=http://localhost/callback"}).success(function(a){for(var d=a.split("&"),g={},i=0;i<d.length;i++)g[d[i].split("=")[0]]=d[i].split("=")[1];g.hasOwnProperty("oauth_token")===!1&&f.reject("Oauth request token was not received");var j=window.open("https://api.twitter.com/oauth/authenticate?oauth_token="+g.oauth_token,"_blank","location=no,clearsessioncache=yes,clearcache=yes");j.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var d=a.url.split("?")[1],g=d.split("&"),i={},k=0;k<g.length;k++)i[g[k].split("=")[0]]=g[k].split("=")[1];i.hasOwnProperty("oauth_verifier")===!1&&f.reject("Browser authentication failed to complete.  No oauth_verifier was returned"),delete h.oauth_signature,h.oauth_token=i.oauth_token;var l=c.createSignature("POST","https://api.twitter.com/oauth/access_token",h,{oauth_verifier:i.oauth_verifier},e);b.defaults.headers.post.Authorization=l.authorization_header,b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://api.twitter.com/oauth/access_token",data:"oauth_verifier="+i.oauth_verifier}).success(function(a){for(var b=a.split("&"),c={},d=0;d<b.length;d++)c[b[d].split("=")[0]]=b[d].split("=")[1];c.hasOwnProperty("oauth_token_secret")===!1&&f.reject("Oauth access token was not received"),c.oauth_nonce=h.oauth_nonce,f.resolve(c)}).error(function(a){f.reject(a)})["finally"](function(){setTimeout(function(){j.close()},10)})}}),j.addEventListener("exit",function(){f.reject("The sign in flow was canceled")})}).error(function(a){f.reject(a)})}else f.reject("Missing jsSHA JavaScript library");else f.reject("Could not find InAppBrowser plugin")}else f.reject("Cannot authenticate via a web browser");return f.promise},meetup:function(b){var c=a.defer();if(window.cordova){var d=cordova.require("cordova/plugin_list").metadata;if(d.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var e=window.open("https://secure.meetup.com/oauth2/authorize/?client_id="+b+"&redirect_uri=http://localhost/callback&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");e.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],d=b.split("&"),f={},g=0;g<d.length;g++)f[d[g].split("=")[0]]=d[g].split("=")[1];void 0!==f.access_token&&null!==f.access_token?c.resolve(f):c.reject("Problem authenticating"),setTimeout(function(){e.close()},10)}}),e.addEventListener("exit",function(){c.reject("The sign in flow was canceled")})}else c.reject("Could not find InAppBrowser plugin")}else c.reject("Cannot authenticate via a web browser");return c.promise},salesforce:function(b,c){var d="http://localhost/callback",e=function(a,b,c){return a+"services/oauth2/authorize?display=touch&response_type=token&client_id="+escape(b)+"&redirect_uri="+escape(c)
},f=function(a,b){return a.substr(0,b.length)===b},g=a.defer();if(window.cordova){var h=cordova.require("cordova/plugin_list").metadata;if(h.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var i=window.open(e(b,c,d),"_blank","location=no,clearsessioncache=yes,clearcache=yes");i.addEventListener("loadstart",function(a){if(f(a.url,d)){var b={},c=a.url.split("#")[1];if(c){var e=c.split("&");for(var h in e){var j=e[h].split("=");b[j[0]]=unescape(j[1])}}"undefined"==typeof b||"undefined"==typeof b.access_token?g.reject("Problem authenticating"):g.resolve(b),setTimeout(function(){i.close()},10)}}),i.addEventListener("exit",function(){g.reject("The sign in flow was canceled")})}else g.reject("Could not find InAppBrowser plugin")}else g.reject("Cannot authenticate via a web browser");return g.promise},strava:function(c,d,e){var f=a.defer();if(window.cordova){var g=cordova.require("cordova/plugin_list").metadata;if(g.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var h=window.open("https://www.strava.com/oauth/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&scope="+e.join(",")+"&response_type=code&approval_prompt=force","_blank","location=no,clearsessioncache=yes,clearcache=yes");h.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://www.strava.com/oauth/token",data:"client_id="+c+"&client_secret="+d+"&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")})["finally"](function(){setTimeout(function(){h.close()},10)}))}),h.addEventListener("exit",function(){f.reject("The sign in flow was canceled")})}else f.reject("Could not find InAppBrowser plugin")}else f.reject("Cannot authenticate via a web browser");return f.promise},foursquare:function(b){var c=a.defer();if(window.cordova){var d=cordova.require("cordova/plugin_list").metadata;if(d.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var e=window.open("https://foursquare.com/oauth2/authenticate?client_id="+b+"&redirect_uri=http://localhost/callback&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");e.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],d=b.split("&"),f=[],g=0;g<d.length;g++)f[d[g].split("=")[0]]=d[g].split("=")[1];if(void 0!==f.access_token&&null!==f.access_token){var h={access_token:f.access_token,expires_in:f.expires_in};c.resolve(h)}else c.reject("Problem authenticating");setTimeout(function(){e.close()},10)}}),e.addEventListener("exit",function(){c.reject("The sign in flow was canceled")})}else c.reject("Could not find InAppBrowser plugin")}else c.reject("Cannot authenticate via a web browser");return c.promise},magento:function(d,e,f){var g=a.defer();if(window.cordova){var h=cordova.require("cordova/plugin_list").metadata;if(h.hasOwnProperty("org.apache.cordova.inappbrowser")===!0)if("undefined"!=typeof jsSHA){var i={oauth_callback:"http://localhost/callback",oauth_consumer_key:e,oauth_nonce:c.createNonce(5),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:Math.round((new Date).getTime()/1e3),oauth_version:"1.0"},j=c.createSignature("POST",d+"/oauth/initiate",i,{oauth_callback:"http://localhost/callback"},f);b.defaults.headers.post.Authorization=j.authorization_header,b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:d+"/oauth/initiate",data:"oauth_callback=http://localhost/callback"}).success(function(a){for(var e=a.split("&"),h={},j=0;j<e.length;j++)h[e[j].split("=")[0]]=e[j].split("=")[1];h.hasOwnProperty("oauth_token")===!1&&g.reject("Oauth request token was not received");var k=h.oauth_token_secret,l=window.open(d+"/oauth/authorize?oauth_token="+h.oauth_token,"_blank","location=no,clearsessioncache=yes,clearcache=yes");l.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var e=a.url.split("?")[1],h=e.split("&"),j={},m=0;m<h.length;m++)j[h[m].split("=")[0]]=h[m].split("=")[1];j.hasOwnProperty("oauth_verifier")===!1&&g.reject("Browser authentication failed to complete.  No oauth_verifier was returned"),delete i.oauth_signature,delete i.oauth_callback,i.oauth_token=j.oauth_token,i.oauth_nonce=c.createNonce(5),i.oauth_verifier=j.oauth_verifier;var n=c.createSignature("POST",d+"/oauth/token",i,{},f,k);b.defaults.headers.post.Authorization=n.authorization_header,b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:d+"/oauth/token"}).success(function(a){for(var b=a.split("&"),c={},d=0;d<b.length;d++)c[b[d].split("=")[0]]=b[d].split("=")[1];c.hasOwnProperty("oauth_token_secret")===!1&&g.reject("Oauth access token was not received"),g.resolve(c)}).error(function(a){g.reject(a)})["finally"](function(){setTimeout(function(){l.close()},10)})}}),l.addEventListener("exit",function(){g.reject("The sign in flow was canceled")})}).error(function(a){g.reject(a)})}else g.reject("Missing jsSHA JavaScript library");else g.reject("Could not find InAppBrowser plugin")}else g.reject("Cannot authenticate via a web browser");return g.promise},vkontakte:function(b,c){var d=a.defer();if(window.cordova){var e=cordova.require("cordova/plugin_list").metadata;if(e.hasOwnProperty("org.apache.cordova.inappbrowser")===!0){var f=window.open("https://oauth.vk.com/authorize?client_id="+b+"&redirect_uri=http://oauth.vk.com/blank.html&response_type=token&scope="+c.join(",")+"&display=touch&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");f.addEventListener("loadstart",function(a){var b=a.url.split("#");if("https://oauth.vk.com/blank.html"==b[0]||"http://oauth.vk.com/blank.html"==b[0]){for(var c=a.url.split("#")[1],e=c.split("&"),g=[],h=0;h<e.length;h++)g[e[h].split("=")[0]]=e[h].split("=")[1];void 0!==g.access_token&&null!==g.access_token?d.resolve({access_token:g.access_token,expires_in:g.expires_in}):d.reject("Problem authenticating"),setTimeout(function(){f.close()},10)}}),f.addEventListener("exit",function(){d.reject("The sign in flow was canceled")})}else d.reject("Could not find InAppBrowser plugin")}else d.reject("Cannot authenticate via a web browser");return d.promise}}}]),angular.module("ngCordova.plugins.oauthUtility",[]).factory("$cordovaOauthUtility",["$q",function(){return{createSignature:function(a,b,c,d,e,f){if("undefined"!=typeof jsSHA){for(var g=angular.copy(c),h=Object.keys(d),i=0;i<h.length;i++)g[h[i]]=encodeURIComponent(d[h[i]]);var j=a+"&"+encodeURIComponent(b)+"&",k=Object.keys(g).sort();for(i=0;i<k.length;i++)j+=encodeURIComponent(i==k.length-1?k[i]+"="+g[k[i]]:k[i]+"="+g[k[i]]+"&");console.log("signatureBaseString="+j);var l=new jsSHA(j,"TEXT"),m="";f&&(m=encodeURIComponent(f)),c.oauth_signature=encodeURIComponent(l.getHMAC(encodeURIComponent(e)+"&"+m,"TEXT","SHA-1","B64"));var n=Object.keys(c),o="OAuth ";for(i=0;i<n.length;i++)o+=i==n.length-1?n[i]+'="'+c[n[i]]+'"':n[i]+'="'+c[n[i]]+'",';return{signature_base_string:j,authorization_header:o,signature:c.oauth_signature}}return"Missing jsSHA JavaScript library"},createNonce:function(a){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;a>d;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b}}}]),angular.module("ngCordova.plugins.pinDialog",[]).factory("$cordovaPinDialog",["$q","$window",function(a,b){return{prompt:function(c,d,e){var f=a.defer();return b.plugins.pinDialog.prompt(c,function(a){f.resolve(a)},d,e),f.promise}}}]),angular.module("ngCordova.plugins.prefs",[]).factory("$cordovaPreferences",["$window","$q",function(a,b){return{set:function(c,d){var e=b.defer();return a.appgiraffe.plugins.applicationPreferences.set(c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},get:function(c){var d=b.defer();return a.appgiraffe.plugins.applicationPreferences.get(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}}}]),angular.module("ngCordova.plugins.printer",[]).factory("$cordovaPrinter",["$q","$window",function(a,b){return{isAvailable:function(){var c=a.defer();return b.plugin.printer.isAvailable(function(a){c.resolve(a)}),c.promise},print:function(c,d){var e=a.defer();return b.plugin.printer.print(c,d,function(){e.resolve()}),e.promise}}}]),angular.module("ngCordova.plugins.progressIndicator",[]).factory("$cordovaProgress",["$q",function(){return{show:function(a){var b=a||"Please wait...";return ProgressIndicator.show(b)},showSimple:function(a){var b=a||!1;return ProgressIndicator.showSimple(b)},showSimpleWithLabel:function(a,b){var c=a||!1,d=b||"Loading...";return ProgressIndicator.showSimpleWithLabel(c,d)},showSimpleWithLabelDetail:function(a,b,c){var d=a||!1,e=b||"Loading...",f=c||"Please wait";return ProgressIndicator.showSimpleWithLabelDetail(d,e,f)},showDeterminate:function(a,b){var c=a||!1,d=b||5e4;return ProgressIndicator.showDeterminate(c,d)},showDeterminateWithLabel:function(a,b,c){var d=a||!1,e=b||5e4,f=c||"Loading...";return ProgressIndicator.showDeterminateWithLabel(d,e,f)},showAnnular:function(a,b){var c=a||!1,d=b||5e4;return ProgressIndicator.showAnnular(c,d)},showAnnularWithLabel:function(a,b,c){var d=a||!1,e=b||5e4,f=c||"Loading...";return ProgressIndicator.showAnnularWithLabel(d,e,f)},showBar:function(a,b){var c=a||!1,d=b||5e4;return ProgressIndicator.showBar(c,d)},showBarWithLabel:function(a,b,c){var d=a||!1,e=b||5e4,f=c||"Loading...";return ProgressIndicator.showBarWithLabel(d,e,f)},showSuccess:function(a,b){var c=a||!1,d=b||"Success";return ProgressIndicator.showSuccess(c,d)},showText:function(a,b,c){var d=a||!1,e=b||"Warning",f=c||"center";return ProgressIndicator.showText(d,e,f)},hide:function(){return ProgressIndicator.hide()}}}]),angular.module("ngCordova.plugins.push",[]).factory("$cordovaPush",["$q","$window","$rootScope","$timeout",function(a,b,c,d){return{onNotification:function(a){d(function(){c.$broadcast("$cordovaPush:notificationReceived",a)})},register:function(c){var d,e=a.defer();return void 0!==c&&void 0===c.ecb&&(d=void 0===angular.element(document.querySelector("[ng-app]"))?"document.body":"document.querySelector('[ng-app]')",c.ecb="angular.element("+d+").injector().get('$cordovaPush').onNotification"),b.plugins.pushNotification.register(function(a){e.resolve(a)},function(a){e.reject(a)},c),e.promise},unregister:function(c){var d=a.defer();return b.plugins.pushNotification.unregister(function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise},setBadgeNumber:function(c){var d=a.defer();return b.plugins.pushNotification.setApplicationIconBadgeNumber(function(a){d.resolve(a)},function(a){d.reject(a)},c),d.promise}}}]),angular.module("ngCordova.plugins.sms",[]).factory("$cordovaSms",["$q",function(a){return{send:function(b,c,d){var e=a.defer();return sms.send(b,c,d,function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise}}}]),angular.module("ngCordova.plugins.socialSharing",[]).factory("$cordovaSocialSharing",["$q","$window",function(a,b){return{share:function(c,d,e,f){var g=a.defer();return b.plugins.socialsharing.share(c,d,e,f,function(){g.resolve(!0)},function(){g.reject(!1)}),g.promise},shareViaTwitter:function(c,d,e){var f=a.defer();return b.plugins.socialsharing.shareViaTwitter(c,d,e,function(){f.resolve(!0)},function(){f.reject(!1)}),f.promise},shareViaWhatsApp:function(c,d,e){var f=a.defer();return b.plugins.socialsharing.shareViaWhatsApp(c,d,e,function(){f.resolve(!0)},function(){f.reject(!1)}),f.promise},shareViaFacebook:function(c,d,e){var f=a.defer();return b.plugins.socialsharing.shareViaFacebook(c,d,e,function(){f.resolve(!0)},function(){f.reject(!1)}),f.promise},shareViaFacebookWithPasteMessageHint:function(c,d,e,f){var g=a.defer();return b.plugins.socialsharing.shareViaFacebookWithPasteMessageHint(c,d,e,f,function(){g.resolve(!0)},function(){g.reject(!1)}),g.promise},shareViaSMS:function(c,d){var e=a.defer();return b.plugins.socialsharing.shareViaSMS(c,d,function(){e.resolve(!0)},function(){e.reject(!1)}),e.promise},shareViaEmail:function(c,d,e,f,g,h){var i=a.defer();return b.plugins.socialsharing.shareViaEmail(c,d,e,f,g,h,function(){i.resolve(!0)},function(){i.reject(!1)}),i.promise},shareVia:function(c,d,e,f,g){var h=a.defer();return b.plugins.socialsharing.shareVia(c,d,e,f,g,function(){h.resolve(!0)},function(){h.reject(!1)}),h.promise},canShareViaEmail:function(){var c=a.defer();return b.plugins.socialsharing.canShareViaEmail(function(){c.resolve(!0)},function(){c.reject(!1)}),c.promise},canShareVia:function(c,d,e,f,g){var h=a.defer();return b.plugins.socialsharing.canShareVia(c,d,e,f,g,function(a){h.resolve(a)},function(a){h.reject(a)}),h.promise}}}]),angular.module("ngCordova.plugins.spinnerDialog",[]).factory("$cordovaSpinnerDialog",["$window",function(a){return{show:function(b,c,d){return d=d||!1,a.plugins.spinnerDialog.show(b,c,d)},hide:function(){return a.plugins.spinnerDialog.hide()}}}]),angular.module("ngCordova.plugins.splashscreen",[]).factory("$cordovaSplashscreen",[function(){return{hide:function(){return navigator.splashscreen.hide()},show:function(){return navigator.splashscreen.show()}}}]),angular.module("ngCordova.plugins.sqlite",[]).factory("$cordovaSQLite",["$q","$window",function(a,b){return{openDB:function(a,c){return"undefined"==typeof c&&(c=0),b.sqlitePlugin.openDatabase({name:a,bgType:c})},execute:function(b,c,d){var e=a.defer();return b.transaction(function(a){a.executeSql(c,d,function(a,b){e.resolve(b)},function(a,b){e.reject(b)})}),e.promise},insertCollection:function(b,c,d){var e=a.defer(),f=d.slice(0);return b.transaction(function(a){!function b(){var d=f.splice(0,1)[0];try{a.executeSql(c,d,function(a,c){0===f.length?e.resolve(c):b()},function(a,b){e.reject(b)})}catch(g){e.reject(g)}}()}),e.promise},nestedExecute:function(b,c,d,e,f){var g=a.defer();return b.transaction(function(a){a.executeSql(c,e,function(a,b){g.resolve(b),a.executeSql(d,f,function(a,b){g.resolve(b)})})},function(a,b){g.reject(b)}),g.promise},deleteDB:function(c){var d=a.defer();return b.sqlitePlugin.deleteDatabase(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise}}}]),angular.module("ngCordova.plugins.statusbar",[]).factory("$cordovaStatusbar",[function(){return{overlaysWebView:function(a){return StatusBar.overlaysWebView(!!a)},style:function(a){switch(a){case 0:return StatusBar.styleDefault();case 1:return StatusBar.styleLightContent();case 2:return StatusBar.styleBlackTranslucent();case 3:return StatusBar.styleBlackOpaque();default:return StatusBar.styleDefault()}},styleColor:function(a){return StatusBar.backgroundColorByName(a)},styleHex:function(a){return StatusBar.backgroundColorByHexString(a)},hide:function(){return StatusBar.hide()},show:function(){return StatusBar.show()},isVisible:function(){return StatusBar.isVisible}}}]),angular.module("ngCordova.plugins.toast",[]).factory("$cordovaToast",["$q","$window",function(a,b){return{showShortTop:function(c){var d=a.defer();return b.plugins.toast.showShortTop(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},showShortCenter:function(c){var d=a.defer();return b.plugins.toast.showShortCenter(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},showShortBottom:function(c){var d=a.defer();return b.plugins.toast.showShortBottom(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},showLongTop:function(c){var d=a.defer();return b.plugins.toast.showLongTop(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},showLongCenter:function(c){var d=a.defer();return b.plugins.toast.showLongCenter(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},showLongBottom:function(c){var d=a.defer();return b.plugins.toast.showLongBottom(c,function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},show:function(c,d,e){var f=a.defer();return b.plugins.toast.show(c,d,e,function(a){f.resolve(a)},function(a){f.reject(a)}),f.promise}}}]),angular.module("ngCordova.plugins.touchid",[]).factory("$cordovaTouchID",["$q",function(a){return{checkSupport:function(){var b=a.defer();return window.cordova?touchid.checkSupport(function(a){b.resolve(a)},function(a){b.reject(a)}):b.reject("Not supported without cordova.js"),b.promise},authenticate:function(b){var c=a.defer();return window.cordova?touchid.authenticate(function(a){c.resolve(a)},function(a){c.reject(a)},b):c.reject("Not supported without cordova.js"),c.promise}}}]),angular.module("ngCordova.plugins.vibration",[]).factory("$cordovaVibration",[function(){return{vibrate:function(a){return navigator.notification.vibrate(a)},vibrateWithPattern:function(a,b){return navigator.notification.vibrateWithPattern(a,b)},cancelVibration:function(){return navigator.notification.cancelVibration()}}}]),angular.module("ngCordova.plugins.videoCapturePlus",[]).provider("$cordovaVideoCapturePlus",[function(){var a={};this.setLimit=function(b){a.limit=b},this.setMaxDuration=function(b){a.duration=b},this.setHighQuality=function(b){a.highquality=b},this.useFrontCamera=function(b){a.frontcamera=b},this.setPortraitOverlay=function(b){a.portraitOverlay=b},this.setLandscapeOverlay=function(b){a.landscapeOverlay=b},this.setOverlayText=function(b){a.overlayText=b},this.$get=["$q","$window",function(b,c){return{captureVideo:function(d){var e=b.defer();return c.plugins.videocaptureplus?(c.plugins.videocaptureplus.captureVideo(e.resolve,e.reject,angular.extend({},a,d)),e.promise):(e.resolve(null),e.promise)}}}]}]),angular.module("ngCordova.plugins.zip",[]).factory("$cordovaZip",["$q","$window",function(a,b){return{unzip:function(c,d){var e=a.defer();return b.zip.unzip(c,d,function(a){0===a?e.resolve():e.reject()},function(a){e.notify(a)}),e.promise}}}])}(),angular.module("viceversa",["doowb.angular-pusher","ionic","ngResource","timer","angularMoment","viceversa.controllers","viceversa.directives","viceversa.services","viceversa.constants","viceversa.env","ngCordova","ngStorage","monospaced.elastic","ionic.contrib.ui.cards","lub-tmdb-api","angular-svg-round-progress"]).run(["URLSchemeService","TwitterPluginService","$ionicPlatform","$state","FEEDTYPE","SETTINGS","KEYS","$location","$rootScope","$http","DataFactory","VersusFeedService","AuthService","UserService","NotificationService","$ionicLoading","$ionicModal","$ionicHistory","ENV","$timeout","$window","$ionicScrollDelegate","$ionicActionSheet","FacebookService","TwitterService","PushNotificationService","$ionicBackdrop","lubTmdbApi","FlurryService","ANALYTICS","$q",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){"use strict";console.log("-------------------------"),console.log("BUILD: "+s.name),console.log("-------------------------"),j.defaults.headers.common["X-Parse-Application-Id"]=s.PARSEAPPID,j.defaults.headers.common["X-Parse-REST-API-Key"]=s.PARSERESTID,i.NotificationService=o,i.VersusFeedService=l,i.UserService=n,i.authService=m,i.FEEDTYPE=e,i.SETTINGS=f,i.base64prefix="data:image/jpg;base64,",document.addEventListener("pause",function(){console.log("run() -> cordovaPauseEvent"),C.stop().then(function(){console.log("flurry stoped")},function(){console.log("flurry fail to stop")})}),document.addEventListener("resume",function(){console.log("run() -> cordovaResumeEvent"),C.start().then(function(){console.log("flurry started")},function(){console.log("flurry fail to start")})});var F=m.autoLogin();F&&F.then(function(){i.navigateAfterLogin()},function(){i.navigateAfterLogin()}),i.activeSettings=f.CATEGORY,document.addEventListener("menubutton",function(){-1===d.current.name.indexOf("create")&&("tab.main-filters"===d.current.name?i.goBack():d.go("tab.main-filters",{}))}),c.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()}),t(function(){i.windowHeight=u.innerHeight},1e3),i.displayVersusActionSheet=function(a){var b=w.show({buttons:[{text:'<i class="icon icon-social ion-social-facebook"></i> Share it on Facebook'},{text:'<i class="icon icon-social ion-social-twitter "></i> Share it on twitter'}],titleText:"Share this Versus",cancelText:'<i class="icon ion-close"></i> Cancel',cancel:function(){z.init()},buttonClicked:function(c){switch(c){case 0:x.share(a).then(function(){i.showToast("success","This versus has been shared!","ion-checkmark",1e3)},function(a){i.showToast("error",a,"ion-ios7-close",1e3)}),b();break;case 1:y.share(a).then(function(){i.showToast("success","This versus has been shared!","ion-checkmark",1e3)},function(a){i.showToast("error",a,"ion-ios7-close",1e3)}),b()}}})},i.goBack=function(){r.goBack()},i.goTo=function(a,b){d.go(a,b)},i.hideKeyboard=function(){"undefined"!=typeof cordova&&cordova.plugins.Keyboard.close()},i.goToUser=function(a){var b=k.get(a);b&&(n.currentPageUser=b),"user"===i.activeTab?d.go("tab.user",{userID:a}):(i.activeTab||(i.activeTab="main"),d.go("tab."+i.activeTab+"-user",{userID:a}))},i.goToVersusFull=function(a,b,c){d.go("tab."+i.activeTab+"-versus",{feedType:a,feedParam:b,slideIndex:c})},i.showToast=function(a,b,c,d){d="undefined"!=typeof d?d:!1,p.show({template:'<div class="is-'+a+' toast-content"><i class="'+c+'"></i> '+b+"</div>"}),d!==!1&&t(function(){i.hideToast()},d)},i.hideToast=function(){p.hide()},i.navigateAfterLogin=function(){i.authService.isLogged===!0?(i.hideToast(),n.currentAuthUser.firstLogin?d.go("start.username",{}):a.goToOpenedURL()===!1&&d.go("tab.main",{})):d.go("intro",{})},i.activeInbox=i.FEEDTYPE.INBOX_IN,i.setTime=function(){var a=v.$getByHandle("hours").getScrollPosition();i.create.hours=Math.ceil(a.top/100)+1;var b=v.$getByHandle("minutes").getScrollPosition();i.create.minutes=Math.ceil(b.top/100),A.release(),i.create.displayClock=!1},i.launchCreate=function(){i.progress||t(function(){d.go("create.categories")},600)},i.progress=null,i.createVersus=function(){i.progress=1,d.go("tab.main"),i.create.friends=i.create.selectedUsers,i.create.duration=1e3*i.create.hours*60*60+1e3*i.create.minutes*60,l.createVersus(i.create).then(function(a){C.logEvent(D.CREATE_VERSUS),G(a).then(function(){i.hideToast(),i.create.failed=!1,i.create.success=!0,t(function(){i.create.success=!1},1e3),i.$broadcast("upload-versus-done"),i.progress=null})},function(a){i.create.failed=!0,t(function(){i.create.failed=!1},1e3),i.progress=null,console.log("Error: "+a)},function(a){console.log("progress: "+a),i.progress=a})};var G=function(a){var b=E.defer();try{i.create.share.facebook?x.share(a).then(function(){i.create.share.twitter?y.share(a).then(function(){i.hideToast(),b.resolve()},function(){i.hideToast(),b.resolve()}):(i.hideToast(),b.resolve())},function(){i.hideToast(),b.resolve()}):i.create.share.twitter?y.share(a).then(function(){i.hideToast(),b.resolve()},function(){i.hideToast(),b.resolve()}):(i.hideToast(),b.resolve())}catch(c){console.log(c),i.hideToast(),b.resolve()}return b.promise};i.$on("$stateChangeStart",function(a,b){b.noAuth?n.currentAuthUser&&(a.preventDefault(),d.go("tab.main",{})):n.currentAuthUser?n.currentAuthUser.firstLogin&&"start"!==b.name.substr(0,b.name.indexOf("."))&&(a.preventDefault(),d.go("start.username",{})):i.authService.loginInProgress===!0?(a.preventDefault(),i.showToast("loading","Loading...","ion-loading-d")):(a.preventDefault(),d.go("intro",{}))}),i.$on("$stateChangeSuccess",function(a,b){i.hideLayout=b.hideLayout?!0:!1,i.noCta=b.noCta?!0:!1})}]).value("lubTmdbApiKey","7994ae0250a855dc6f0c77c5d4fbba3a"),angular.module("viceversa").config(["$provide","$stateProvider","$urlRouterProvider","$ionicConfigProvider","PusherServiceProvider","KEYS","$cordovaFacebookProvider",function(a,b,c,d,e,f){a.decorator("$exceptionHandler",["$delegate","ENV","$injector",function(a,b,c){return function(d,e){var f=c.get("$rootScope"),g=f.UserService.currentAuthUser?f.UserService.currentAuthUser.objectId:"notAuth";"production"===b.name&&Airbrake.push({error:d,context:{userId:g}}),a(d,e)}}]),e.setToken(f.PUSHERID).setOptions({}),e.setPusherUrl("local_lib/pusher.min.js"),b.state("splash",{url:"/splash",templateUrl:"templates/intro/splash.html",controller:"SplashCtrl",noAuth:!0}).state("intro",{url:"/intro",templateUrl:"templates/intro/intro.html",controller:"IntroCtrl",noAuth:!0}).state("start",{url:"/start","abstract":!0,templateUrl:"templates/start/layout.html",controller:"StartCtrl"}).state("start.username",{url:"/username",views:{start:{templateUrl:"templates/start/username.html",controller:"StartUsernameCtrl"}}}).state("start.profilpic",{url:"/profilpic",views:{start:{templateUrl:"templates/start/profilpic.html",controller:"StartProfilPicCtrl"}}}).state("start.filters",{url:"/filters",views:{start:{templateUrl:"templates/start/filters.html",controller:"StartFiltersCtrl"}},noCta:!0}).state("tab",{url:"/tab","abstract":!0,templateUrl:"templates/tabs/layout.html",controller:"TabsCtrl"}).state("tab.main",{url:"/main",views:{"tab-main":{templateUrl:"templates/tabs/tab-feed.html",controller:"FeedCtrl"}}}).state("tab.main-inbox",{url:"/main/inbox",views:{"tab-main":{templateUrl:"templates/versus/inbox.html",controller:"InboxCtrl"}}}).state("tab.main-invited",{url:"/main/inbox/invited/:versusId",views:{"tab-main":{templateUrl:"templates/versus/invited.html",controller:"InvitedCtrl"}}}).state("tab.main-filters",{url:"/main/filters",views:{"tab-main":{templateUrl:"templates/versus/filters.html",controller:"FiltersCtrl"}},noCta:!0}).state("tab.search",{url:"/search",views:{"tab-search":{templateUrl:"templates/tabs/tab-search.html",controller:"SearchCtrl"}}}).state("tab.notifications",{url:"/notifications",views:{"tab-notifications":{templateUrl:"templates/tabs/tab-notifications.html",controller:"NotificationsCtrl"}}}).state("create",{url:"/create","abstract":!0,templateUrl:"templates/versus/create/layout.html",controller:"CreateCtrl"}).state("create.categories",{url:"/categories",views:{create:{templateUrl:"templates/versus/create/categories.html",controller:"CreateCategoryCtrl"}}}).state("create.question",{url:"/question",views:{create:{templateUrl:"templates/versus/create/question.html",controller:"CreateQuestionCtrl"}}}).state("create.choices",{url:"/choices",views:{create:{templateUrl:"templates/versus/create/choices.html",controller:"CreateChoicesCtrl"}}}).state("create.final",{url:"/final",views:{create:{templateUrl:"templates/versus/create/final.html",controller:"CreateFinalCtrl"}}}).state("tab.main-user",{url:"/main/user/:userID",views:{"tab-main":{templateUrl:"templates/tabs/tab-user.html",controller:"UserCtrl"}}}).state("tab.user",{url:"/user/:userID",views:{"tab-user":{templateUrl:"templates/tabs/tab-user.html",controller:"UserCtrl"}}}).state("tab.search-user",{url:"/search/user/:userID",views:{"tab-search":{templateUrl:"templates/tabs/tab-user.html",controller:"UserCtrl"}}}).state("tab.notifications-user",{url:"/notifications/user/:userID",views:{"tab-notifications":{templateUrl:"templates/tabs/tab-user.html",controller:"UserCtrl"}}}).state("tab.main-versus",{url:"/main/versus/:feedType/:feedParam/:slideIndex",views:{"tab-main":{templateUrl:"templates/versus/full.html",controller:"VersusFullCtrl"}},hideLayout:!0}).state("tab.user-versus",{url:"/user/versus/:feedType/:feedParam/:slideIndex",views:{"tab-user":{templateUrl:"templates/versus/full.html",controller:"VersusFullCtrl"}},hideLayout:!0}).state("tab.notifications-versus",{url:"/notifications/versus/:feedType/:feedParam/:slideIndex",views:{"tab-notifications":{templateUrl:"templates/versus/full.html",controller:"VersusFullCtrl"}},hideLayout:!0}).state("tab.search-versus",{url:"/search/versus/:feedType/:feedParam/:slideIndex",views:{"tab-search":{templateUrl:"templates/versus/full.html",controller:"VersusFullCtrl"}},hideLayout:!0}).state("tab.main-comments",{url:"/main/comments/:versusId",views:{"tab-main":{templateUrl:"templates/versus/comments.html",controller:"CommentsCtrl"}},noCta:!0}).state("tab.user-comments",{url:"/user/comments/:versusId",views:{"tab-user":{templateUrl:"templates/versus/comments.html",controller:"CommentsCtrl"}},noCta:!0}).state("tab.notifications-comments",{url:"/notifications/comments/:versusId",views:{"tab-notifications":{templateUrl:"templates/versus/comments.html",controller:"CommentsCtrl"}},noCta:!0}).state("tab.search-comments",{url:"/search/comments/:versusId",views:{"tab-search":{templateUrl:"templates/versus/comments.html",controller:"CommentsCtrl"}},noCta:!0}).state("tab.main-votes",{url:"/main/votes/:versusId",views:{"tab-main":{templateUrl:"templates/versus/votes.html",controller:"VotesCtrl"}},noCta:!0}).state("tab.user-votes",{url:"/user/votes/:versusId",views:{"tab-user":{templateUrl:"templates/versus/votes.html",controller:"VotesCtrl"}},noCta:!0}).state("tab.notifications-votes",{url:"/notifications/votes/:versusId",views:{"tab-notifications":{templateUrl:"templates/versus/votes.html",controller:"VotesCtrl"}},noCta:!0}).state("tab.search-votes",{url:"/search/votes/:versusId",views:{"tab-search":{templateUrl:"templates/versus/votes.html",controller:"VotesCtrl"}},noCta:!0}).state("tab.main-follow",{url:"/main/user/:userId/follow/:followIndex",views:{"tab-main":{templateUrl:"templates/user/follow.html",controller:"FollowCtrl"}},noCta:!0}).state("tab.user-follow",{url:"/user/:userId/follow/:followIndex",views:{"tab-user":{templateUrl:"templates/user/follow.html",controller:"FollowCtrl"}},noCta:!0}).state("tab.notifications-follow",{url:"/notifications/user/:userId/follow/:followIndex",views:{"tab-notifications":{templateUrl:"templates/user/follow.html",controller:"FollowCtrl"}},noCta:!0}).state("tab.search-follow",{url:"/search/user/:userId/follow/:followIndex",views:{"tab-search":{templateUrl:"templates/user/follow.html",controller:"FollowCtrl"}},noCta:!0}),c.otherwise("/splash"),d.backButton.text(""),d.backButton.previousTitleText(!1),d.tabs.style("android"),d.tabs.position("top"),d.navBar.alignTitle("left"),d.navBar.positionPrimaryButtons("right"),d.views.transition("android")}]),angular.module("viceversa.services",[]),angular.module("viceversa.controllers",[]),angular.module("viceversa.directives",[]),angular.module("viceversa.constants",[]),angular.module("viceversa.env",[]),angular.module("viceversa.constants").constant("URL",{VERSUS:"https://api.parse.com/1/classes/Versus/",USER:"https://api.parse.com/1/classes/_User/",USERS:"https://api.parse.com/1/users/",USER_ME:"https://api.parse.com/1/users/me/",ACTIVITY:"https://api.parse.com/1/classes/Activity/",COMMENT:"https://api.parse.com/1/classes/Comment/",PRIVATE_VERSUS:"https://api.parse.com/1/classes/PrivateVersus/",FILE:"https://api.parse.com/1/files/",USERNAME_AVAILABLE_FUNCTION:"https://api.parse.com/1/functions/isUsernameAvailable",UNFOLLOW_FUNCTION:"https://api.parse.com/1/functions/Unfollow",LOGIN:"https://api.parse.com/1/login",UPLOAD_FILE_FROM_URL:"https://api.parse.com/1/functions/createFileFromUrl",SET_DEFAULT_PICTURE:"https://api.parse.com/1/functions/setDefaultPicture",REMOTE_FETCH_FUNCTION:"https://api.parse.com/1/functions/fetchVersusByFeedType"}).constant("LIMIT",{FETCH_USER_VERSUS:20,FETCH_FEED_VERSUS:20,FETCH_INBOX_VERSUS:20,FETCH_ACTIVITY:20,FETCH_FOLLOWER:20,FETCH_FOLLOWING:20,FETCH_COMMENT:20,FLICKR:8,MAX:1e3}).constant("COOKIE",{TOKEN:"vvauth",FOLLOWING_IDS:"followingIds",CATEGORY_FILTER_ARRAY:"filters",LANGUAGE_FILTER_ARRAY:"lang",USER_THUMBNAIL:"user-thumbnail-",USER_USERNAME:"user-username-"}).constant("ACL",{READONLY:{read:!0},WRITEONLY:{write:!0},READWRITE:{read:!0,write:!0},ACTIVITY:{"*":{read:!0}},COMMENT:{"*":{read:!0}},VERSUS:{"*":{read:!0}}}).constant("KEYS",{PARSEAPPID:"40mMMFv2yRywJKcTAslMhj7t7sLdLarf29nDj6oW",PARSERESTID:"ubhYbCfsM8WgXl5U7sPcIKMUUL5zAREv0mFgiEoc",PARSECLIENTID:"D9BLKfsDYUDxbQleZkrjiyFsxh3IuAjpqSw3qn11",PUSHERID:"eb4732f31ea88de4935e",FLICKR:"cdfbfa69405b9cf346fcb226f544a81e",FACEBOOK:"819407668087923",GOOGLE:"718727946874-9q1r7qa7mc1aql0i80j2epk6ma1vrv3u.apps.googleusercontent.com",TWITTER_CONSUMER:"LTK8UNgtf2vLSvZlccOyYcvfO",TWITTER_SECRET:"hgvj4LwJBqgltR3ekrJkIiaLuNSw4AYvzGt7Esv10oh13ZEcx3"}).constant("FEEDTYPE",{INBOX:"inbox",FEED:"feed",USER:"user",SINGLE:"single",ALL:0,TIMELINE:1,INBOX_IN:1,INBOX_OUT:0}).constant("SETTINGS",{CATEGORY:0,LANGUAGE:1}).constant("ANALYTICS",{FOLLOW:"follow",UNFOLLOW:"unfollow",LIKE:"like",VOTE:"vote",COMMENT:"comment",START_SIGNIN:"startSignin",SIGN_IN:"signin",START_CREATE_VERSUS:"startCreateVersus",CREATE_VERSUS:"createVersus",STOP_CREATE_VERSUS:"stopCreateVersus",SHARE:"share",SHARE_START:"shareStart",CHANGE_FILTER:"changeFilter",START_INVITE_FACEBOOK:"stateInviteFacebook",INVITE_FACEBOOK:"inviteFacebook",FAIL_INVITE_FACEBOOK:"failInviteFacebook"}),angular.module("viceversa.env",[]).constant("ENV",{name:"production",PARSEAPPID:"ESsMZDBvfN58FPvSo2RMivqCJxljWKR1cCfn7LPa",PARSERESTID:"XkQN7239KXukoczN2l1s1bwxhqz1XdXCuHrMWOqv",PARSECLIENTID:"EgVqBkuBVOI3j3eqUvZldh4oFJ6fdAB8kF3udwIX",FLURRY:"6ZF84TDQRRPVGW4D8592"}),angular.module("viceversa.services").factory("PrivateVersus",["DataStoreService","User","Versus",function(a,b,c){function d(a){this.className="PrivateVersus",a.hasOwnProperty("objectId")&&(this.objectId=a.objectId,this.rawData=a,this.init(a))
}return d.prototype.init=function(b){if(b)for(var d in b)if("Versus"===d){var e=a.get(b[d].objectId);this[d]=e?e:a.insertVersus(new c(b[d]))}else this[d]=b[d]},d.prototype.updateIfNeeded=function(a){if(console.log("-------------"),console.log("PrivateVersus::updateIfNeeded"),console.log(a),console.log("-------------"),a.hasOwnProperty("updatedAt")){var b=new Date(a.updatedAt),c=new Date(this.updatedAt);b>c?(this.updatedAt=a.updatedAt,console.log("PrivateVersus updated")):console.log("PrivateVersus already up to date")}},d}]),angular.module("viceversa.services").factory("Versus",["$http","Comment","DataStoreService","User","URL","LIMIT","ACL","$q","FlurryService","ANALYTICS",function(a,b,c,d,e,f,g,h,i,j){function k(a){this.Comments=[],this.className="Versus",a.hasOwnProperty("objectId")&&(this.status=l.FETCHED,this.commentStatus=m.NOTFETCHED,this.objectId=a.objectId,this.rawData=a,this.loadingVote=!1,this.loadingFetchVotedBy=!1,this.init(a),this.voteOnePercent=0,this.voteTwoPercent=0,this.VoteCount=0)}k.fetchVersus=function(b){var d=h.defer();return a({method:"GET",url:e.VERSUS+b}).success(function(a){var b=c.insertVersus(new k(a));d.resolve(b)}).error(function(a){d.reject(a)}),d.promise};var l={FETCHED:{value:0,name:"FETCHED"},NOTFETCHED:{value:1,name:"NOTFETCHED"},NOTSYNCHRONIZED:{value:2,name:"NOTSYNCHRONIZED"},SYNCHRONIZING:{value:3,name:"SYNCHRONIZING"},FAILED:{value:4,name:"FAILED"}},m={FETCHED:{value:0,name:"FETCHED"},FETCHING:{value:1,name:"FETCHING"},NOTFETCHED:{value:2,name:"NOTFETCHED"},FAILED:{value:3,name:"FAILED"}};return k.status=l,k.prototype.getHeight=function(){if(this.finalHeight)return this.finalHeight;var a=20,b=1,c=.1*(window.innerWidth-30),d=parseInt(window.innerWidth-55-c),e=78+window.innerWidth/2+c,f=document.createElement("canvas"),g=f.getContext("2d");g.font="15px Roboto";var h=parseInt(g.measureText(this.Title).width);if(0>d-h){console.log("result : "+d/h);var b=Math.ceil(h/d)}return this.finalHeight=e+20*(b-1)+a,this.finalHeight},k.prototype.updatePercent=function(){this.VoteCount=parseInt(this.Vote_1)+parseInt(this.Vote_2),(this.IsDone||0!==this.Voted||this.isYours)&&0!==this.VoteCount?(this.voteOnePercent=Math.round(this.Vote_1/this.VoteCount*100,0),this.voteTwoPercent=100-this.voteOnePercent):(this.voteOnePercent=0,this.voteTwoPercent=0)},k.prototype.init=function(a){if(this.votedBy=[],this.noMoreVotedBy=!1,this.noMoreComment=!1,a){for(var b in a)this[b]=a[b];var c=new Date;this.votedBy=[],this.background="img/categories/"+a.Category.toLowerCase()+"/background.png";var e=new Date(a.createdAt),f=c-e;this.ago=Math.round(f/3600/1e3);var g=new Date(a.FinishAt.iso);if(this.finish=g,c>=g&&(this.IsDone=!0),this.isYours=null,this.Voted=null,"undefined"==typeof d.currentAuthUser||""===d.currentAuthUser.objectId)return;a.CreatedBy.objectId===d.currentAuthUser.objectId&&(this.isYours=!0),""===d.currentAuthUser.objectId&&(this.Voted=-1),this.Voted=0,this.updatePercent()}},k.prototype.vote=function(a){return this.voteOn(this,a)},k.prototype.voteOn=function(b,c){var f=h.defer();if(b.loadingVote===!0)return f.promise;if(b.IsDone===!0)return f.promise;b.loadingVote=!0;var k=b.CreatedBy.objectId,l=b.objectId,m={ACL:g.ACTIVITY,From:{__type:"Pointer",className:"_User",objectId:d.currentAuthUser.objectId},To:{__type:"Pointer",className:"_User",objectId:k},Versus:{__type:"Pointer",className:"Versus",objectId:l},isSeen:!1,Type:"Vote",AnswerFirstChoice:c};return m.ACL[k]={read:!0,write:!0},a({method:"POST",url:e.ACTIVITY,headers:{"Content-Type":"application/json"},data:m}).success(function(){b.Voted=c?1:2,c?b.Vote_1++:b.Vote_2++,b.updatePercent(),i.logEvent(j.VOTE),b.loadingVote=!1,f.resolve()}).error(function(){b.loadingVote=!1,f.reject()}),f.promise},k.prototype.didIVote=function(){return 0!==this.Voted},k.prototype.didIVoteLeft=function(){return 1===this.Voted},k.prototype.didIVoteRight=function(){return 2===this.Voted},k.prototype.addComment=function(a){-1===this.Comments.indexOf(a)&&this.Comments.push(a)},k.prototype.fetchComment=function(){this.fetchCommentOn(this)},k.prototype.fetchCommentOn=function(d){d.commentStatus!==m.FETCHING&&(d.noMoreComment!==!0||d.comments.length!==d.CommentCount)&&(d.comments=[],d.commentStatus=m.FETCHING,a({method:"GET",url:e.COMMENT,params:{where:{Versus:{__type:"Pointer",className:"Versus",objectId:d.objectId}},order:"-Like,createdAt",limit:f.FETCH_COMMENT}}).success(function(a){var e=a.results;0===e.length&&(d.noMoreComment=!0);for(var f=0;f<e.length;f++){var g=c.insertComment(new b(d,e[f]));d.addComment(g)}d.commentStatus=m.FETCHED}).error(function(){d.commentStatus=m.FAILED}))},k.prototype.updateIfNeeded=function(a){if(console.log("Versus::updateIfNeeded"),a.hasOwnProperty("updatedAt")){var b=new Date(a.updatedAt),c=new Date(this.updatedAt);b>c||"undefined"==typeof this.updatedAt?(a.hasOwnProperty("CommentCount")&&(this.CommentCount=a.CommentCount),a.hasOwnProperty("Sponsored")&&(this.Sponsored=a.Sponsored),a.hasOwnProperty("IsDone")&&(this.IsDone=a.IsDone),a.hasOwnProperty("Vote_1")&&(this.Vote_1=a.Vote_1),a.hasOwnProperty("Vote_2")&&(this.Vote_2=a.Vote_2),this.updatePercent(),this.updatedAt=a.updatedAt,console.log("Versus updated")):console.log("Versus already up to date")}},k}]),angular.module("viceversa.services").factory("User",["$http","DataStoreService","CookieService","URL","LIMIT","ACL","UtilsService","$q","FlurryService","ANALYTICS",function(a,b,c,d,e,f,g,h,i,j){function k(a,b){this.className="_User",this.objectId=a.objectId,this.rawData=a,this.loadingFollow=!1,this.loadingFollower=!1,this.loadingFollowing=!1,this.init(a,b),b&&(this.fetchCurrentUserData(this),k.currentAuthUser=this,this.fetchFollower().then(function(){console.log("current user follower fetch succeeded")}),this.fetchFollowing().then(function(){console.log("current user follower fetch succeeded")})),this.firstLogin=this.hasOwnProperty("displayName")===!0&&this.hasOwnProperty("Thumbnail")===!0?!1:!0}var l={FOLLOWED:{value:0,name:"FOLLOWED"},NOTFOLLOWED:{value:1,name:"NOTFOLLOWED"},UNKNOWN:{value:2,name:"UNKNOWN"},CURRENT:{value:3,name:"CURRENT"}};k.followStatus=l;var m={FETCHED:{value:0,name:"FETCHED"},NOTFETCHED:{value:1,name:"NOTFETCHED"}};k.status=m;var n=c.readCookie("followingIds");return k.followingIds=null,n&&(k.followingIds=JSON.parse(n)),k.fetchUser=function(c){var e=h.defer();return a({method:"GET",url:d.USERS+c}).success(function(a){var c=b.insertUser(new k(a));e.resolve(c)}).error(function(a){e.reject(a)}),e.promise},k.prototype.init=function(a,c){this.Following=[],this.Follower=[];for(var d in a)if("Location"===d&&(this[d]="Somewhere on earth"),"username"===d)this.username=a.displayName;else if("Thumbnail"===d||"ProfilePicture"===d)this[d]=a[d].url,this[d+"File"]=a[d];else if("Follower"===d||"Following"===d){this[d]=[];for(var e=a[d].length-1;e>=0;e--){var f=b.get(a[d][e].objectId);f?f.updateIfNeeded(a[d][e]):f=b.insertUser(new k(a[d][e])),this[d].push(f)}}else this[d]=a[d];this.status=this.hasOwnProperty("displayName")===!0&&this.hasOwnProperty("Thumbnail")===!0?k.status.FETCHED:k.status.NOTFETCHED,this.isFollowed=c?k.followStatus.CURRENT:null===k.followingIds?k.followStatus.UNKNOWN:-1===k.followingIds.indexOf(this.objectId)?k.followStatus.NOTFOLLOWED:k.followStatus.FOLLOWED,this.isFacebookUser=!1,this.hasOwnProperty("facebookid")===!0&&(this.isFacebookUser=!0),this.isTwitterUser=!1,this.hasOwnProperty("TwitterId")===!0&&(this.isTwitterUser=!0)},k.prototype.IsFollowed=function(){return this.isFollowed===k.followStatus.FOLLOWED},k.prototype.fetchCurrentUserData=function(b){a({method:"GET",url:d.ACTIVITY,params:{where:{Type:"Follow",From:{__type:"Pointer",className:"_User",objectId:b.objectId}},limit:e.MAX,keys:"To"}}).success(function(a){k.followingIds=[];for(var b=a.results.length-1;b>=0;b--){var d=a.results[b].To.objectId,e=k.followingIds.indexOf(d);-1===e&&k.followingIds.push(d)}c.createCookie("followingIds",JSON.stringify(k.followingIds),1)}).error(function(){alert("error")})},k.prototype.follow=function(a){this.followUser(k.currentAuthUser,a)},k.prototype.followUser=function(b,e){if(e.loadingFollow!==!0){e.loadingFollow=!0,e.isFollowed=k.followStatus.FOLLOWED;var g={isSeen:!1,Type:"Follow",From:{__type:"Pointer",className:"_User",objectId:b.objectId},To:{__type:"Pointer",className:"_User",objectId:e.objectId}};g.ACL={},g.ACL["*"]=f.READONLY,g.ACL[e.objectId]={read:!0,write:!0},a({method:"POST",url:d.ACTIVITY,headers:{"Content-Type":"application/json"},data:g}).success(function(){b.Following.unshift(e),b.FollowingCount++,e.Follower.unshift(b),e.FollowerCount++,k.followingIds.unshift(e.objectId),c.createCookie("followingIds",JSON.stringify(k.followingIds),1),e.loadingFollow=!1,i.logEvent(j.FOLLOW)}).error(function(){e.loadingFollow=!1,e.isFollowed=k.followStatus.NOTFOLLOWED,console.log(e.isFollowed)})}},k.prototype.unFollow=function(a){this.unFollowUser(k.currentAuthUser,a)},k.prototype.unFollowUser=function(b,e){e.loadingFollow!==!0&&(e.loadingFollow=!0,e.isFollowed=k.followStatus.NOTFOLLOWED,a({method:"POST",url:d.UNFOLLOW_FUNCTION,headers:{"Content-Type":"application/json"},data:{userId:e.objectId}}).success(function(){g.remove(b.Following,e),b.FollowingCount--,g.remove(e.Follower,b),e.FollowerCount--,e.isFollowed=k.followStatus.NOTFOLLOWED,g.remove(k.followingIds,e.objectId),c.createCookie("followingIds",JSON.stringify(k.followingIds),1),e.loadingFollow=!1,i.logEvent(j.UNFOLLOW)}).error(function(){e.loadingFollow=!1,e.isFollowed=k.followStatus.FOLLOWED,console.log(e.isFollowed)}))},k.prototype.fetchFollower=function(){return this.fetchUserFollower(this)},k.prototype.fetchUserFollower=function(c){var f=h.defer();return c.loadingFollower===!0?(f.reject(),f.promise):(c.loadingFollower=!0,a({method:"GET",url:d.ACTIVITY,params:{where:{Type:"Follow",To:{__type:"Pointer",className:"_User",objectId:c.objectId}},skip:c.Follower.length,limit:k.currentAuthUser===c?1e3:e.FETCH_FOLLOWER,include:"From",select:"From"}}).success(function(a){for(var d=a.results.length-1;d>=0;d--){var e=b.get(a.results[d].From.objectId);e?(console.log("user already exist"),e.updateIfNeeded(a.results[d].From)):(console.log("create new user"),e=b.insertUser(new k(a.results[d].From))),g.pushUnique(c.Follower,e)}console.log("Follower fetched count = "+c.Follower.length),c.loadingFollower=!1,f.resolve(c.Follower)}).error(function(){c.loadingFollower=!1,f.reject()}),f.promise)},k.prototype.fetchFollowing=function(){return this.fetchUserFollowing(this)},k.prototype.fetchUserFollowing=function(c){var f=h.defer();return c.loadingFollowing===!0?(f.reject(),f.promise):(c.loadingFollowing=!0,a({method:"GET",url:d.ACTIVITY,params:{where:{Type:"Follow",From:{__type:"Pointer",className:"_User",objectId:c.objectId}},skip:c.Following.length,limit:e.FETCH_FOLLOWING,include:"To",select:"To"}}).success(function(a){for(var d=a.results.length-1;d>=0;d--){var e=new k(a.results[d].To);c.Following.push(b.insertUser(e))}console.log("Following fetched count = "+c.Follower.length),c.loadingFollowing=!1,f.resolve(c.Following)}).error(function(){c.loadingFollowing=!1,f.reject()}),f.promise)},k.prototype.fetchData=function(){this.fetchUserData(this)},k.prototype.fetchUserData=function(b){a({method:"GET",url:d.USER+b.objectId}).success(function(a){console.log("fetchUserData success"),b.init(a)}).error(function(a){console.log("fail to fetch this user data"),console.log(a)})},k.prototype.updateIfNeeded=function(a){if(a.hasOwnProperty("updatedAt")){var b=new Date(a.updatedAt),c=new Date(this.updatedAt);b>c?(console.log("-------------"),console.log("User::updateIfNeeded"),console.log(a),console.log("-------------"),this.updatedAt=a.updatedAt,a.hasOwnProperty("FollowerCount")&&(this.FollowerCount=a.FollowerCount),a.hasOwnProperty("FollowingCount")&&(this.FollowingCount=a.FollowingCount)):console.log("user already up to date")}},k}]),angular.module("viceversa.services").factory("Comment",["$http","User","URL","ACL","DataStoreService","FlurryService","ANALYTICS",function(a,b,c,d,e,f,g){function h(a,c){if(this.className="Comment","string"==typeof c){var e={Comment:c,ACL:d.COMMENT,Like:0,CreatedBy:{__type:"Pointer",className:"_User",objectId:b.currentAuthUser.objectId},Versus:{__type:"Pointer",className:"Versus",objectId:a.objectId},Username:b.currentAuthUser.displayName,UserThumbnail:b.currentAuthUser.ThumbnailFile};this.rawData=e,this.status=i.NOTSYNCHRONIZED,this.Versus=a,this.synchronize(a)}else this.objectId=c.objectId,this.rawData=c,this.loading=!1,this.init(c),this.status=i.FETCHED}var i={FETCHED:{value:0,name:"FETCHED"},NOTFETCHED:{value:1,name:"NOTFETCHED"},NOTSYNCHRONIZED:{value:2,name:"NOTSYNCHRONIZED"},SYNCHRONIZING:{value:3,name:"SYNCHRONIZING"},FAILED:{value:4,name:"FAILED"}};return h.status=i,h.prototype.synchronize=function(a){this.synchronizeComment(this,a)},h.prototype.synchronizeComment=function(b,d){b.status!==h.status.FETCH&&b.status!==h.status.SYNCHRONIZING&&b.status!==h.status.NOTFETCHED&&(b.status=h.status.SYNCHRONIZING,a({method:"POST",url:c.COMMENT,headers:{"Content-Type":"application/json"},data:b.rawData}).success(function(a){var b=e.insertComment(new h(d,a));d.addComment(b),f.logEvent(g.COMMENT),d.CommentCount++}).error(function(){console.log("sync comment: failed"),b.status=h.status.FAILED}))},h.prototype.init=function(a){for(var c in a)"UserThumbnail"===c?(this[c]=a[c].url,console.log(this[c])):this[c]=a[c];if(this.isYours=!1,b.currentAuthUser.objectId===this.CreatedBy.objectId&&(this.isYours=!0),this.Liked=!1,a.LikedBy&&null!==a.LikedBy)for(var d=a.LikedBy.length-1;d>=0;d--)a.LikedBy[d].objectId===b.currentAuthUser.objectId&&(this.Liked=!0)},h.prototype.like=function(){this.likeOn(this)},h.prototype.likeOn=function(e){if(e.loading!==!0){var h=e.CreatedBy.objectId;if(h===b.currentAuthUser.objectId)return void console.log("Cant like your own comment... loser");e.Liked===!1?(e.Like++,e.Liked=!0):(e.Like--,e.Liked=!1),e.loading=!0;var i=e.objectId,j={ACL:d.ACTIVITY,From:{__type:"Pointer",className:"_User",objectId:b.currentAuthUser.objectId},To:{__type:"Pointer",className:"_User",objectId:h},Versus:{__type:"Pointer",className:"Versus",objectId:e.Versus.objectId},Comment:{__type:"Pointer",className:"Comment",objectId:i},isSeen:!1,Type:"Like"};j.ACL[h]={read:!0,write:!0},a({method:"POST",url:c.ACTIVITY,headers:{"Content-Type":"application/json"},data:j}).success(function(){e.loading=!1}).error(function(a){e.loading=!1,e.Liked===!1&&"unlike done"!==a.error?(e.Like++,e.Liked=!0):e.Liked===!0&&(e.Like--,e.Liked=!1,console.log("Like operation failed")),f.logEvent(g.LIKE)})}},h.prototype.updateIfNeeded=function(a){if(a.hasOwnProperty("updatedAt")){var b=new Date(a.updatedAt),c=new Date(this.updatedAt);b>c?(console.log("-------------"),console.log("Comment::updateIfNeeded"),console.log(a),console.log("-------------"),a.hasOwnProperty("Like")&&(this.Like=a.Like),this.updatedAt=a.updatedAt,console.log("Comment updated")):console.log("Comment already up to date")}},h}]),angular.module("viceversa.services").factory("Activity",["$http","DataStoreService","User","Versus","Comment","URL","$q",function(a,b,c,d,e,f,g){function h(a){console.log("Activity Constructor"),this.objectId=a.objectId,this.rawData=a,this.init(a)}var i={Vote:" has voted on your versus ",Comment:" has commented on your versus ",Like:" has liked your comment ",Follow:" is now following you"},j={Vote:"ion-checkmark",Comment:"ion-chatbubble",Like:"icon-vote-comment",Follow:"ion-plus"};return h.prototype.init=function(a){for(var c in a){if("From"===c||"To"===c);else if("Versus"===c){var f=b.get(a[c].objectId);this[c]=f?f:b.insertVersus(new d(a[c]))}else if("Comment"===c){var g=b.get(a[c].objectId);this[c]=g?g:b.insertComment(new e(null,a[c]))}this[c]=a[c]}this.message=i[this.Type],this.icon=j[this.Type],"Vote"===this.Type?(this.data=this.Versus.Title,this.link={route:"tab.notifications-versus"},this.link.params={feedParam:this.Versus.objectId}):"Comment"===this.Type?(this.data=this.Versus.Title,this.link={route:"tab.notifications-versus"},this.link.params={feedParam:this.Versus.objectId}):"Like"===this.Type?(this.data=this.Comment.Comment,this.link={route:"tab.notifications-versus"},this.link.params={feedParam:this.Versus.objectId}):"Follow"===this.Type&&(this.link={route:"tab.notifications-user"},this.link.params={userId:this.From.objectId})},h.prototype.setAsSeen=function(){return this.setActivityAsSeen(this)},h.prototype.setActivityAsSeen=function(b){var c=g.defer();return a({method:"PUT",url:f.ACTIVITY+b.objectId,headers:{"Content-Type":"application/json"},data:{isSeen:!0}}).success(function(){b.isSeen=!0,c.resolve()}).error(function(){c.reject(),console.log("Error while trying to set notification "+b.objectId+" has SEEN")}),c.promise},h}]),angular.module("viceversa.services").factory("DataFactory",["$http","User","Versus","PrivateVersus","Comment","DataStoreService","Activity","$q",function(a,b,c,d,e,f,g,h){var i=function(a){if("object"!=typeof a||a.hasOwnProperty("objectId")===!1)return a;var b=f.get(a.objectId);return b?b:new g(a)},j=function(a,c){if("object"!=typeof a||a.hasOwnProperty("objectId")===!1)return a;var d=f.get(a.objectId);return d?d:new b(a,c)},k=function(a,b){if("object"!=typeof b||b.hasOwnProperty("objectId")===!1)return b;var c=f.get(b.objectId);return c?c:new e(a,b)},l=function(a){if("object"!=typeof a||a.hasOwnProperty("objectId")===!1)return a;var b=f.get(a.objectId);return b?b:new c(a)},m=function(a){if("object"!=typeof a||a.hasOwnProperty("objectId")===!1)return a;var b=f.get(a.objectId);return b?b:new d(a)},n=function(a){var b=i(a);return f.insertUser(b)},o=function(a,b){var c=j(a,b);return f.insertUser(c)},p=function(a,b){var c=k(a,b);return f.insertComment(c)},q=function(a){var b=l(a);return f.insertVersus(b)},r=function(a){var b=m(a);return f.insertPrivateVersus(b)},s=function(a){return f.get(a)},t=function(a){var c=h.defer(),d=f.get(a);return d?c.resolve(d):b.fetchUser(a).then(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},u=function(a){var b=h.defer(),d=f.get(a);return d?b.resolve(d):c.fetchVersus(a).then(function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise};return{createUser:j,createComment:k,createVersus:l,createActivity:i,createPrivateVersus:m,insertUser:o,insertComment:p,insertVersus:q,insertPrivateVersus:r,insertActivity:n,get:s,getUser:t,getVersus:u}}]),angular.module("viceversa.services").factory("TwitterUser",[function(){function a(a){this.Thumbnail=a.profile_image_url,this.displayName=a.name,this.id=a.id_str,this.isOnViceversa=0}return a}]),angular.module("viceversa.services").factory("TwitterService",["$q","KEYS","$http","$cordovaOauth","$cordovaSocialSharing","$ionicPlatform","$cordovaOauthUtility","FlurryService","ANALYTICS","TwitterUser","TwitterPluginService",function(a,b,c,d,e,f,g,h,i,j,k){var l=function(){var c=a.defer();return k.login().then(function(a){console.log(a),r.username=a.screen_name;var d={twitter:{id:""+a.id,screen_name:a.screen_name,consumer_key:b.TWITTER_CONSUMER,consumer_secret:b.TWITTER_SECRET,auth_token:a.oauth_token,auth_token_secret:a.oauth_token_secret}};r.oauthData=d.twitter,c.resolve(d)},function(a){console.log(a),c.reject(a)}),c.promise},m=function(a,c,d){var e=g.createNonce(32),f={oauth_consumer_key:b.TWITTER_CONSUMER,oauth_nonce:e,oauth_signature_method:"HMAC-SHA1",oauth_timestamp:Math.round((new Date).getTime()/1e3),oauth_token:r.oauthData.auth_token,oauth_version:"1.0"},h=g.createSignature(a,c,f,d,b.TWITTER_SECRET,r.oauthData.auth_token_secret),i=h.authorization_header;return{method:a,url:c,headers:{Authorization:i},params:d}},n=function(){var b=a.defer(),d=m("GET","https://api.twitter.com/1.1/users/show.json",{id:r.oauthData.id});return c(d).success(function(a){r.profilePicture=a.profile_image_url.replace("_normal","");var c={username:r.username,picture:r.profilePicture};b.resolve(c)}).error(function(){b.reject()}),b.promise},o=function(b,d){var e=a.defer();r.oauthData=b.AuthData.twitter;var f=m("POST","https://api.twitter.com/1.1/direct_messages/new.json",{user_id:d,text:"Join me on Viceversa app.viceversa.io?v="+b.objectId});return c(f).success(function(a){console.log(a),e.resolve()}).error(function(){console.log("failed"),e.reject()}),e.promise},p=function(b){var d=a.defer();r.oauthData=b.twitter;var e=m("GET","https://api.twitter.com/1.1/followers/list.json",{user_id:b.twitter.id});return c(e).success(function(a){console.log("ok");for(var b=[],c=a.users.length-1;c>=0;c--)b.push(new j(a.users[c]));d.resolve(b)}).error(function(){console.log("fail"),d.reject()}),d.promise},q=function(b){h.logEvent(i.SHARE_START);var c=a.defer();return f.ready(function(){var a=window.plugin.imageCombine;a.combine(b.Image_1.url,b.Image_2.url,function(a){var d="data:image/jpeg;base64,"+a;e.shareViaTwitter(b.Title,d,"app.viceversa.io?v="+b.objectId).then(function(){h.logEvent(i.SHARE),c.resolve()},function(a){c.reject(a)})},function(a){c.reject(a)})}),c.promise},r={profile:null,profilePicture:null,username:null,oauthData:null,login:l,fetchProfile:n,share:q,invite:o,fetchFriends:p};return r}]),angular.module("viceversa.services").factory("GooglePlusService",["$q","KEYS","$cordovaSocialSharing","$ionicPlatform",function(a){var b=function(){var b=a.defer();return window.plugins.googleplus.login({},function(a){console.log(a),b.resolve(result)},function(a){console.log(a),b.reject(a)}),b.promise},c={profile:null,profilePicture:null,login:b};return c}]),angular.module("viceversa.services").factory("FacebookService",["$q","KEYS","$cordovaOauth","$cordovaFacebook","$cordovaSocialSharing","$ionicPlatform","FlurryService","ANALYTICS","$http","ImageCombine","UtilsService",function(a,b,c,d,e,f,g,h,i,j,k){var l=function(){var b=a.defer();return d.login(["email","public_profile","user_friends"]).then(function(a){a=a.authResponse;var c=new Date((new Date).getTime()+parseInt(a.expiresIn)),d={facebook:{id:a.userID,access_token:a.accessToken,expiration_date:c}};b.resolve(d)},function(a){console.log(a),b.reject(a)}),b.promise},m=function(){var b=a.defer();return d.api("me?fields=name,id,picture.type(large)",["public_profile"]).then(function(a){q.profile=a,q.username=a.name,q.profilePicture=a.picture.data.url;var c={username:q.username,picture:q.profilePicture};b.resolve(c)},function(a){console.log(a),b.reject(a)}),b.promise},n=function(b){var c=a.defer(),d="https://graph.facebook.com/v2.2/"+b.facebook.id+"/friends";return q.friendsIds?c.resolve(q.friendsIds):i({method:"GET",url:d,params:{access_token:b.facebook.access_token}}).success(function(a){q.friendsIds=[];for(var b=a.data.length-1;b>=0;b--)q.friendsIds.push(a.data[b].id);console.log(a),c.resolve(q.friendsIds)}).error(function(a){console.log(a),c.reject(a)}),c.promise},o=function(b){var c=a.defer();return b.hasOwnProperty("SharingImage")?d.showDialog({method:"share",href:"app.viceversa.io?v="+b.objectId,caption:"Viceversa, help people make choices",name:b.Title,description:b.ImageName_1+" vs "+b.ImageName_2,picture:b.SharingImage.url}).then(function(a){c.resolve(a)},function(a){c.reject(a)}):j.combine(b.Image_1.url,b.Image_2.url).then(function(a){k.uploadImage(a).then(function(a){d.showDialog({method:"share",href:"app.viceversa.io?v="+b.objectId,caption:"Viceversa, help people make choices",name:b.Title,description:b.ImageName_1+" vs "+b.ImageName_2,picture:a.url}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})},function(a){c.reject(a)}),c.promise},p=function(b){g.logEvent(h.START_INVITE_FACEBOOK);var c=a.defer();return f.ready(function(){d.showDialog({method:"send",link:"app.viceversa.io?u="+b.objectId,caption:"join me on viceversa",name:"ViceVersa",description:"Help people make choices",picture:b.profilePicture}).then(function(a){console.log(a),g.logEvent(h.INVITE_FACEBOOK)},function(){console.log("error"),g.logEvent(h.FAIL_INVITE_FACEBOOK)})},function(a){c.reject(a)}),c.promise},q={profile:null,profilePicture:null,username:null,friendsIds:null,login:l,fetchProfile:m,share:o,invite:p,fetchFriendsId:n};return q}]),angular.module("viceversa.services").factory("PushNotificationService",["$http","KEYS","UtilsService","$ionicPlatform","NotificationService","VersusFeedService","FEEDTYPE","User","DataFactory","$rootScope",function(a,b,c,d,e,f,g,h,i,j){var k=function(a){"a"===a.p?e.fetch(!0).then(function(){if(a.t&&"Follow"===a.t&&a.id){i.getUser(a.id).then(function(a){c.pushUnique(h.currentUser.Follower,a,!0)},function(){console.log("Fail to fetch newFollower from push notification")})}},function(){}):"v"===a.p?f.fetchVersusByType(g.INBOX,g.INBOX_IN,!0):a.alert?(console.log("Campaign push received.."),j.showToast("Info",a.alert,"ion-ios7-locked",5e3)):console.log("what did we received??")},l=function(a){"a"===a.p?e.fetch(!0).then(function(b){for(var c=null,d=b.pool.length-1;d>=0;d--)if(b.pool[d].objectId===a.id){c=b.pool[d];break}null!==c&&(a.t&&"Follow"===a.t&&a.id?j.goToUser(c.From.objectId):a.t&&"Vote"===a.t&&a.id?j.goTo("tab.main-versus",{feedType:0,feedParam:c.Versus.objectId,slideIndex:0}):a.t&&"Comment"===a.t&&a.id?j.goTo("tab.main-comments",{feedType:0,feedParam:c.Versus.objectId,slideIndex:0}):a.t&&"Like"===a.t&&a.id&&j.goTo("tab.main-comments",{feedType:0,versusId:c.Versus.objectId,slideIndex:0}))},function(){console.log("fetch notification after background push..")}):"v"===a.p&&a.t&&"PrivateVersus"===a.t&&a.id&&f.fetchVersusByType(g.INBOX,g.INBOX_IN,!0).then(function(){j.goTo("tab.main-inbox",{})})},m=function(e){d.ready(function(){if(!window.plugin)return void console.log("push notification plugin has not been load...");if(window.plugin&&window.plugin.parse_push){window.plugin.parse_push.ontrigger=function(a,b){console.log("Push notification received:"+a+" data: "+b),"foreground"===a?k(b):l(b)};var d=window.plugin.parse_push;d.register([b.PARSEAPPID,b.PARSECLIENTID],function(){d.getInstallationId(function(b){a({method:"POST",url:"https://api.parse.com/1/installations",data:{deviceType:"android",installationId:b,user:c.createParseUserObject(e.objectId)}}).success(function(){console.log("SUCCESS !! ")}).error(function(){console.log("error..")})},function(a){console.log(a)})},function(a){console.log(a)})}else console.log("ParsePushNotificationPlugin is not installed")})},n={init:m};return n}]),angular.module("viceversa.services").factory("LanguageService",["$ionicPlatform","$q",function(){var a={allLanguage:["en","fr","ja","de","nl","pt","ru","es","he"],getCurrentLanguage:getCurrentLanguage,getAllAvailableLanguage:getAllLanguage};return a}]),angular.module("viceversa.services").factory("CameraService",["$q",function(a){return{getPicture:function(b){var c=a.defer();return navigator.camera.getPicture(function(a){c.resolve(a)},function(a){c.reject(a)},b),c.promise}}}]),angular.module("viceversa.services").factory("ParseSaveEventuallyService",["$q","$ionicPlatform",function(a,b){var c=function(c){var d=a.defer();return b.ready(function(){if(window.plugin)if(window.plugin.ParseSaveEventually){var a=window.plugin.ParseSaveEventually;a.saveEventually(c.objectId,function(){d.resolve()},function(a){console.log(a),console.log("fail to saveEventually.."),d.reject()})}else console.log("ParseSaveEventually has not been installed"),d.reject();else console.log("plugins have not been load..."),d.reject()}),d.promise},d={saveEventually:c};return d}]),angular.module("viceversa.services").factory("FlurryService",["$q","$window","$ionicPlatform","ENV",function(a,b,c,d){var e=function(){var d=a.defer();return c.ready(function(){b.plugins?b.plugins.flurry?d.resolve(b.plugins.flurry):d.reject("flurry has not been installed"):d.reject("plugins have not been load...")}),d.promise},f=function(){var b=a.defer();return j.started===!0?b.promise:(e().then(function(a){j.started=!0,a.startSession(d.FLURRY,function(){console.log("start success")},function(a){console.log(a)}),b.resolve()},function(){b.reject()}),b.promise)},g=function(){var b=a.defer();return j.started===!1?b.promise:(e().then(function(a){j.started=!1,a.endSession(function(){console.log("stop success")},function(a){console.log(a)}),b.resolve()},function(){b.reject()}),b.promise)},h=function(b){var c=a.defer();return e().then(function(a){a.logEvent(b,function(){console.log("logEvent success")},function(a){console.log(a)}),c.resolve()},function(a){console.log(a),c.reject(a)}),c.promise},i=function(b,c){var d=a.defer();return e().then(function(a){a.logEventWithParameters(b,c,function(){console.log("logEvent success")},function(a){console.log(a)}),d.resolve()},function(a){console.log(a),d.reject(a)}),d.promise},j={started:!1,logEvent:h,logEventWithParams:i,start:f,stop:g};return j}]),angular.module("viceversa.services").factory("TwitterPluginService",["$q","$window","$ionicPlatform","ENV",function(a,b,c){var d=function(){var b=a.defer();return c.ready(function(){window.plugin?window.plugin.TwitterPlugin?b.resolve(window.plugin.TwitterPlugin):b.reject("TwitterPlugin has not been installed"):b.reject("plugins have not been load...")}),b.promise},e=function(){var b=a.defer();return d().then(function(a){a.login(function(a){console.log("done"),b.resolve(a)},function(a){console.log("error"),b.reject(a)})},function(a){b.reject(a)}),b.promise},f={login:e};return f}]),angular.module("viceversa.services").factory("ImageCombine",["$q","$window","$ionicPlatform","ENV","$rootScope",function(a,b,c,d,e){var f=function(){var b=a.defer();return c.ready(function(){window.plugin?window.plugin.imageCombine?b.resolve(window.plugin.imageCombine):b.reject("imageCombine has not been installed"):b.reject("plugins have not been load...")}),b.promise},g=function(b,c){var d=a.defer();return f().then(function(a){a.combine(b,c,function(a){d.resolve(e.base64prefix+a)},function(a){d.reject(a)})},function(){d.reject()}),d.promise},h={combine:g};return h}]),angular.module("viceversa.services").factory("CookieService",["$localStorage",function(a){var b=function(b,c){console.log("createCookie["+b+"] = "+c),a[b]=c},c=function(b){return console.log("readCookie["+b+"] = "+a[b]),a[b]},d=function(b){delete a[b]};return{createCookie:b,readCookie:c,deleteCookie:d}}]),angular.module("viceversa.services").factory("UtilsService",["$http","URL","$q",function(a,b,c){var d=function(a,b,c){var d=a.indexOf(b);-1===d&&(c?a.unshift(b):a.push(b))},e=/[öäüÖÄÜáàâéèêúùûóòôÁÀÂÉÈÊÚÙÛÓÒÔßñ]/g,f={"ä":"a","ö":"o","ü":"u","Ä":"A","Ö":"O","Ü":"U","á":"a","à":"a","â":"a","é":"e","è":"e","ê":"e","ú":"u","ù":"u","û":"u","ó":"o","ò":"o","ô":"o","Á":"A","À":"A","Â":"A","É":"E","È":"E","Ê":"E","Ú":"U","Ù":"U","Û":"U","Ó":"O","Ò":"O","Ô":"O","ß":"s","ñ":"n"},g=function(a){return f[a]||a},h=function(a){return a.replace(e,g).replace(/[^a-zA-Z0-9]/gim,"").replace(/\s+/g,"")},i=function(a,b){var c=a.indexOf(b);-1===c&&a.unshift(b)},j=function(a,b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},k=function(a){if(a){for(var b=[],c=a.length-1;c>=0;c--)a[c].hasOwnProperty("objectId")===!0?b.push(m(a[c].objectId)):"string"==typeof a[c]&&b.push(m(a[c]));return b}},l=function(a,b){return{__type:"Pointer",className:a,objectId:b}},m=function(a){return l("_User",a)},n=function(a,b){var c=[];if(!b)return c;for(var d=b.length-1;d>=0;d--)c.push(l(a,b[d]));return c},o=function(a){return n("_User",a)},p=function(a){return!!a.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i)},q=function(d){var e=c.defer();if("string"==typeof d&&p(d)===!1)a({method:"POST",url:b.UPLOAD_FILE_FROM_URL,data:{url:d}}).success(function(a){e.resolve(a.result)}).error(function(){e.reject()});else{var f=d.substr(d.indexOf(",")+1),g={base64:f,_ContentType:"image/jpeg"};a({method:"POST",url:b.FILE+"image.jpg",headers:{"Content-Type":"text/plain"},data:JSON.stringify(g)}).success(function(a){e.resolve(a)}).error(function(){e.reject()})}return e.promise},r=function(a,b,c){var d=[],e=0===b.length?0:b.length;return d=a.slice(e,e+c)},s=function(a,b,c){for(var d=[],e=a.indexOf(b[0])-1;e>-1;--e)if(d.unshift(a[e]),d.length>=c)return d;return d};return{createObjectIdArray:k,createParsePointerObject:l,createParsePointerArray:n,createParseUserObject:m,createParseUserArray:o,pushUnique:d,insert:i,remove:j,uploadImage:q,addNextItem:r,addPrevItem:s,sanitize:h}
}]),angular.module("viceversa.services").service("VersusFeedService",["$http","UserService","DataFactory","$timeout","User","URL","LIMIT","ACL","UtilsService","FEEDTYPE","$q","CategoryFilterService","LanguageFilterService","ImageCombine",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.pool=[],this.pool[j.FEED+j.ALL]=[],this.pool[j.FEED+j.TIMELINE]=[],this.pool[j.INBOX+j.INBOX_IN]=[],this.pool[j.INBOX+j.INBOX_OUT]=[],this.pool[j.USER]=[],this.pool[j.SINGLE]=[],this.unVotedInbox=[],this.unVotedInboxCount=0,this.loading=[],this.noMore=[],this.noMore[j.FEED+j.ALL]=!1,this.noMoreDone=!1;var o=this;this.resetByType=function(a,b){var c=a+b;return this.pool[c]=[],this.noMore[c]=!1,this.noMoreDone=!1,this.fetchVersusByType(a,b)};var p=function(a,b,c){var d=o.pool[a].length,e={method:"POST",url:f.REMOTE_FETCH_FUNCTION,data:{feedType:"ALL",versusDone:o.noMore[a],arrayFilter:l.getFilters(),arrayLang:m.getFilters(),version:2}};return o.noMore[a]||(o.noMore[a]=!1),0!==d&&(c?e.data.newestThan=o.pool[a][0].createdAt:e.data.oldestThan=o.pool[a][d-1].createdAt),e},q=function(a,b,d,e){var f=d.result.voted;o.noMore[a]=0===d.result.versusArray.length?!0:!1;for(var g=0;g<d.result.versusArray.length;g++){var h=c.insertVersus(d.result.versusArray[g]);f.hasOwnProperty(h.objectId)&&(h.Voted=f[h.objectId]?1:2),h.updatePercent(),i.pushUnique(o.pool[a],h,e||o.noMoreDone)}},r=function(a,b,c){var d=o.pool[a].length,g=(o.pool[a].length,{method:"POST",url:f.REMOTE_FETCH_FUNCTION,data:{feedType:"TIMELINE",arrayFilter:l.getFilters(),followingIds:e.followingIds,arrayLang:m.getFilters(),version:2}});return 0!==d&&(c?g.data.newestThan=o.pool[a][0].createdAt:g.data.oldestThan=o.pool[a][d-1].createdAt),g},s=function(a,b,d,e){var f=d.result.voted;o.noMore[a]=0===d.result.versusArray.length?!0:!1;for(var g=0;g<d.result.versusArray.length;g++){var h=c.insertVersus(d.result.versusArray[g]);f.hasOwnProperty(h.objectId)&&(h.Voted=f[h.objectId]?1:2),h.updatePercent(),i.pushUnique(o.pool[a],h,e)}},t=function(a,b,c){var d=o.pool[a].length,e={method:"POST",url:f.REMOTE_FETCH_FUNCTION,data:{feedType:"RECEIVED"}};return 0!==d&&(c?e.data.newestThan=o.pool[a][0].createdAt:e.data.oldestThan=o.pool[a][d-1].createdAt),e},u=function(a,b,d,e){var f=d.result.voted;o.noMore[a]=0===d.result.versusArray.length?!0:!1;for(var g=0;g<d.result.versusArray.length;g++){var h=c.insertPrivateVersus(d.result.versusArray[g]);f.hasOwnProperty(h.Versus.objectId)&&(h.Versus.Voted=f[h.Versus.objectId]?1:2,h.Voted=f[h.Versus.objectId]?1:2),h.Versus.updatePercent(),h.Versus.IsDone===!1&&h.Versus.didIVote()===!1&&i.pushUnique(o.unVotedInbox,h.Versus),i.pushUnique(o.pool[a],h,e)}o.unVotedInboxCount=o.unVotedInbox.length},v=function(a,b,c){var d=o.pool[a].length,e={method:"POST",url:f.REMOTE_FETCH_FUNCTION,data:{feedType:"SENT"}};return 0!==d&&(c?e.data.newestThan=o.pool[a][0].createdAt:e.data.oldestThan=o.pool[a][d-1].createdAt),e},w=function(a,b,d,e){var f=d.result.voted;o.noMore[a]=0===d.result.versusArray.length?!0:!1;for(var g=0;g<d.result.versusArray.length;g++){var h=c.insertPrivateVersus(d.result.versusArray[g]);f.hasOwnProperty(h.Versus.objectId)&&(h.Versus.Voted=f[h.Versus.objectId]?1:2,h.Voted=f[h.Versus.objectId]?1:2),h.Versus.updatePercent(),i.pushUnique(o.pool[a],h,e)}},x=function(a,b,c){var d=o.pool[a]?o.pool[a].length:0,e={method:"POST",url:f.REMOTE_FETCH_FUNCTION,data:{feedType:"USER",user:b,version:2}};return 0!==d&&(c?e.data.newestThan=o.pool[a][0].createdAt:e.data.oldestThan=o.pool[a][d-1].createdAt),e},y=function(a,b,d,e){var f=d.result.voted;o.pool[a]||(o.pool[a]=[]),o.noMore[a]=0===d.result.versusArray.length?!0:!1;for(var g=0;g<d.result.versusArray.length;g++){var h=c.insertVersus(d.result.versusArray[g]);f.hasOwnProperty(h.objectId)&&(h.Voted=f[h.objectId]?1:2),h.updatePercent(),i.pushUnique(o.pool[a],h,e)}},z=function(a,b){return{method:"GET",url:f.VERSUS+b}},A=function(a,b,d){var e=c.insertVersus(d);o.pool[a]=[],o.pool[a].push(e)},B={};B[j.FEED+j.ALL]=p,B[j.FEED+j.TIMELINE]=r,B[j.INBOX+j.INBOX_OUT]=v,B[j.INBOX+j.INBOX_IN]=t,B[j.SINGLE]=z,B[j.USER]=x;var C={};C[j.FEED+j.ALL]=q,C[j.FEED+j.TIMELINE]=s,C[j.INBOX+j.INBOX_OUT]=w,C[j.INBOX+j.INBOX_IN]=u,C[j.SINGLE]=A,C[j.USER]=y,this.fetchVersusByType=function(b,c,d){var e=k.defer(),f=b+c,g=b;return c&&10===c.length||(g+=c),o.loading[f]===!0?e.promise:(o.loading[f]=!0,a(B[g](f,c,d)).success(function(a){o.loading[f]=!1,C[g](f,c,a,d),e.resolve(o.pool[f])}).error(function(){o.loading[f]=!1,e.reject()}),e.promise)},this.getPool=function(a,b){return o.pool[a+b]};var D=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d],f=c.get(e),g=f.ThumbnailFile;if(g&&b.push(g),3===b.length){console.log("enough Thumbnail");break}}return b};this.vote=function(a,b){a.voteOn(a,b).then(function(){console.log("vote succeeded");var b=o.unVotedInbox.indexOf(a);b>-1&&(o.unVotedInbox.splice(b,1),o.unVotedInboxCount=o.unVotedInbox.length)},function(){console.log("fail to vote")})};var E=function(c,d,e,g){var j=k.defer();return a({method:"POST",url:f.VERSUS,data:{Title:c.title,Category:c.category,Duration:c.duration,ImageName_1:c.choiceTitle[0],lang:c.lang,SharingImage:{name:g.name,url:g.url,__type:"File"},Image_1:{name:d.name,url:d.url,__type:"File"},ImageName_2:c.choiceTitle[1],Image_2:{name:e.name,url:e.url,__type:"File"},CreatedBy:i.createParseUserObject(b.currentAuthUser.objectId),IsPublic:c.isPublic,ACL:h.VERSUS,Username:b.currentAuthUser.displayName,UserThumbnail:b.currentAuthUser.ThumbnailFile}}).success(function(a){j.resolve(a)}).error(function(a){j.reject(a)}),j.promise},F=function(d,e,g){var h=k.defer(),j=D(e);return a({method:"POST",url:f.PRIVATE_VERSUS,data:{Invited:g,PreviewInvited:j,From:i.createParseUserObject(b.currentAuthUser.objectId),Versus:i.createParsePointerObject("Versus",d.objectId)}}).success(function(a){a.Versus=d,h.resolve(c.insertPrivateVersus(a))}).error(function(a){h.reject(a)}),h.promise};this.createVersus=function(a){var d=k.defer();if(o.loading.createVersus===!0)return d.promise;o.loading.createVersus=!0;var e=i.createObjectIdArray(a.friends);return a.isPublic=!0,e&&e.length>0&&(a.isPublic=!1),i.uploadImage(a.choiceImg[0]).then(function(f){d.notify(33),i.uploadImage(a.choiceImg[1]).then(function(g){d.notify(66),n.combine(f.url,g.url).then(function(h){d.notify(75),i.uploadImage(h).then(function(h){d.notify(80),E(a,f,g,h).then(function(f){if(a.isPublic===!1)d.notify(85),F(f,a.friends,e).then(function(a){i.insert(o.pool[j.INBOX+j.INBOX_OUT],a),o.loading.createVersus=!1,d.resolve(a.Versus)},function(a){o.loading.createVersus=!1,d.reject(a)});else{d.notify(100);var g=c.insertVersus(f);i.insert(o.pool[j.FEED+j.TIMELINE],g),o.pool[j.USER+b.currentAuthUser.objectId]?i.insert(o.pool[j.USER+b.currentAuthUser.objectId],g):o.pool[j.USER+b.currentAuthUser.objectId]=[g],o.loading.createVersus=!1,d.resolve(g)}},function(a){o.loading.createVersus=!1,d.reject(a)})},function(a){o.loading.createVersus=!1,d.reject(a)})},function(a){o.loading.createVersus=!1,d.reject(a)})},function(){o.loading.createVersus=!1,d.reject("Upload file failed")})},function(){o.loading.createVersus=!1,d.reject("Upload file failed")}),d.promise}}]),angular.module("viceversa.services").factory("UserService",["$http","$rootScope","DataFactory","UtilsService","URL","$q",function(a,b,c,d,e,f){var g="",h=[],i=[],j=[],k=function(){A.currentAuthUser=null},l={REFRESH:{value:0,name:"refresh"},RESEARCH:{value:1,name:"research"},SUGGESTED:{value:2,name:"suggested"},UPDATE:{value:3,name:"update"},INVITED:{value:4,name:"invited"},VOTEDBY:{value:5,name:"votedby"}},m=function(a,b){h[a.value]||(h[a.value]=[]),h[a.value].push(b)},n=function(a,b){h[a.value].remove(b)},o=function(a){angular.forEach(h[a.value],function(a){a()})},p=function(b){var c=f.defer(),d={};return b&&(d={username:b}),a({method:"POST",url:e.SET_DEFAULT_PICTURE,headers:{"Content-Type":"application/json"},data:d}).success(function(a){a=a.result.user,A.currentAuthUser.ThumbnailFile=a.Thumbnail,A.currentAuthUser.Thumbnail=a.Thumbnail.url,A.currentAuthUser.ProfilePictureFile=a.ProfilePicture,A.currentAuthUser.ProfilePicture=a.ProfilePicture.url,A.currentAuthUser.displayName=b,A.currentAuthUser.firstLogin=A.currentAuthUser.hasOwnProperty("displayName")===!0&&A.currentAuthUser.hasOwnProperty("Thumbnail")===!0?!1:!0,o(l.UPDATE),console.log("available"),c.resolve()}).error(function(){o(l.UPDATE),console.log("not available"),c.reject()}),c.promise},q=function(b,c){var g=f.defer();return A.loading.ProfilePicture===!0?g.promise:(A.loading.ProfilePicture=!0,d.uploadImage(b).then(function(b){a({method:"PUT",url:e.USER+A.currentAuthUser.objectId,headers:{"Content-Type":"application/json"},data:{ProfilePicture:{__type:"File",name:b.name,url:b.url},displayName:c}}).success(function(a){A.currentAuthUser.ThumbnailFile=a.Thumbnail,A.currentAuthUser.Thumbnail=a.Thumbnail.url,A.currentAuthUser.ProfilePictureFile=a.ProfilePicture,A.currentAuthUser.ProfilePicture=a.ProfilePicture.url,A.currentAuthUser.displayName=c,A.currentAuthUser.firstLogin=A.currentAuthUser.hasOwnProperty("displayName")===!0&&A.currentAuthUser.hasOwnProperty("Thumbnail")===!0?!1:!0,A.loading.ProfilePicture=!1,o(l.UPDATE),g.resolve()}).error(function(){A.loading.ProfilePicture=!1,o(l.UPDATE),g.reject()})},function(){g.reject()}),g.promise)},r=function(){k()},s=function(b){var c=f.defer();if(null!==A.currentAuthUser)return a({method:"PUT",url:e.USERS+A.currentAuthUser.objectId,headers:{"Content-Type":"application/json"},data:{displayName:b}}).success(function(){A.currentAuthUser.displayName=b,A.currentAuthUser.firstLogin=A.currentAuthUser.hasOwnProperty("displayName")===!0&&A.currentAuthUser.hasOwnProperty("Thumbnail")===!0?!1:!0,o(l.UPDATE),c.resolve()}).error(function(){o(l.UPDATE),console.log("username update failed"),c.reject()}),c.promise},t=function(b){var c=f.defer();return a({method:"POST",url:e.USERNAME_AVAILABLE_FUNCTION,data:{username:b}}).success(function(){c.resolve(b)}).error(function(){c.reject(b)}),c.promise},u=function(b){var d=f.defer(),g="^\\Q"+b+"\\E",h=JSON.stringify({displayName:{$regex:g,$options:"i"}});return a({method:"GET",url:e.USER,params:{where:h}}).success(function(a){A.lastResearchResult=[];for(var e=a.results.length-1;e>=0;e--){var f=c.insertUser(a.results[e]);A.lastResearchResult.push(f)}o(l.RESEARCH),d.resolve({search:b,data:A.lastResearchResult})}).error(function(a){o(l.RESEARCH),d.reject(a)}),d.promise},v=function(){var b=f.defer();return A.loading.suggested===!0?(b.reject("loading"),b.promise):(A.loading.suggested=!0,a({method:"GET",url:e.USER,params:{where:JSON.stringify({displayName:{$exists:!0}}),order:"-GlobalActivity",limit:25}}).success(function(a){A.suggestedList=[];for(var d=0;d<a.results.length;++d){var e=c.insertUser(a.results[d],!1);A.suggestedList.push(e)}o(l.SUGGESTED),A.loading.suggested=!1,b.resolve(A.suggestedList)}).error(function(a){A.loading.suggested=!1,b.reject(a)}),b.promise)},w=function(b){return A.loading.invited!==!0?(A.loading.invited=!0,A.privateVersusInvited[b.objectId]?void console.log("invited have already been fetched"):void a({method:"GET",url:e.PRIVATE_VERSUS+b.objectId,params:{include:"Invited"}}).success(function(a){A.privateVersusInvited[b.objectId]=[];for(var d=a.Invited,e=d.length-1;e>=0;e--){var f=c.insertUser(d[e],!1);A.privateVersusInvited[b.objectId].push(f)}o(l.INVITED),A.loading.invited=!1}).error(function(){o(l.INVITED),A.loading.invited=!1})):void 0},x=function(b){b.loadingFetchVotedBy!==!0&&(b.loadingFetchVotedBy=!0,(b.noMoreVotedBy!==!0||A.votedBy[b.objectId].length!==b.VoteCount)&&(A.votedBy[b.objectId]=[],a({method:"GET",url:e.ACTIVITY,params:{where:{Versus:{__type:"Pointer",className:"Versus",objectId:b.objectId},Type:"Vote"},include:"From",keys:"From",skip:b.votedBy.length}}).success(function(a){var d=a.results;0===d.length&&(b.noMoreVotedBy=!0);for(var e=d.length-1;e>=0;e--){var f=c.insertUser(d[e].From);-1===A.votedBy[b.objectId].indexOf(f)&&A.votedBy[b.objectId].push(f)}b.loadingFetchVotedBy=!1,o(l.VOTEDBY)}).error(function(){b.loadingFetchVotedBy=!1,o(l.VOTEDBY)})))},y=function(b){var d=f.defer();if(A.loading.twitter===!0)return d.promise;A.loading.twitter=!0;for(var g=[],h=b.length-1;h>=0;h--)g.push(b[h].id);return a({method:"GET",url:e.USER,params:{where:JSON.stringify({TwitterId:{$in:g}})}}).success(function(a){for(var e=a.results.length-1;e>=0;e--){var f=c.insertUser(a.results[e],!1);A.twitterFriends.push(f);for(var g=b.length-1;g>=0;g--)if(b[g].id===f.AuthData.twitter.id){b.splice(g,1);break}}A.twitterFriends=A.twitterFriends.concat(b),A.loading.twitter=!1,d.resolve(A.twitterFriends)}).error(function(a){A.loading.twitter=!1,d.reject(a)}),d.promise},z=function(b){var d=f.defer();return A.loading.facebook===!0?d.promise:(A.loading.facebook=!0,a({method:"GET",url:e.USER,params:{where:JSON.stringify({facebookid:{$in:b},displayName:{$exists:!0}}),order:"-GlobalActivity"}}).success(function(a){A.facebookFriends=[];for(var b=0;b<a.results.length;++b){var e=c.insertUser(a.results[b],!1);A.facebookFriends.push(e)}A.loading.facebook=!1,d.resolve(A.facebookFriends)}).error(function(a){A.loading.facebook=!1,d.reject(a)}),d.promise)},A={suggestedList:[],facebookFriends:[],twitterFriends:[],privateVersusInvited:[],votedBy:[],loading:i,currentPageUser:null,currentAuthUser:null,eventType:l,lastResearchResult:j,sessionToken:g,setDefaultPicture:p,logout:r,updateProfilePicture:q,isUsernameAvailable:t,setUserName:s,register:m,research:u,unRegister:n,fetchSuggestedList:v,fetchFacebookFriends:z,fetchTwitterFriends:y,fetchPrivateVersusInvited:w,fetchVotedBy:x};return A}]),angular.module("viceversa.services").factory("AuthService",["$rootScope","$http","UserService","DataFactory","VersusFeedService","NotificationService","CookieService","URL","COOKIE","FEEDTYPE","FacebookService","GooglePlusService","TwitterService","PushNotificationService","$q","CategoryFilterService","$timeout","LanguageFilterService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=function(a){var c=o.defer();return b({method:"POST",url:h.USERS,headers:{"Content-Type":"application/json"},data:{authData:a}}).success(function(a){console.log(a),g.createCookie("vvauth",a.sessionToken,1),F(a.sessionToken).then(function(){c.resolve()},function(a){c.reject(a)})}).error(function(a){c.reject(),console.log(a)}),c.promise},t=function(){var a=o.defer();return I.loginInProgress===!0?promise:(I.loginInProgress=!0,k.login().then(function(b){var c=[],d=s(b).then(function(){console.log("user login on Parse")}),e=k.fetchProfile().then(function(a){I.socialProfile=a,console.log("facebook profile available")},function(a){console.log("facebook profile error:"+a)});c.push(d),c.push(e),o.all(c).then(function(){I.loginInProgress=!1,a.resolve()},function(b){console.log(b),I.loginInProgress=!1,a.resolve()})},function(b){I.loginInProgress=!1,console.log(b),a.reject(b)}),a.promise)},u=function(){return k.invite(c.currentAuthUser)},v=function(){var a=o.defer();return I.loginInProgress===!0?promise:(I.loginInProgress=!0,m.login().then(function(b){var c=[],d=s(b).then(function(){}),e=m.fetchProfile().then(function(a){I.socialProfile=a,console.log("twitter profile available")});c.push(d),c.push(e),o.all(c).then(function(){I.loginInProgress=!1,a.resolve()},function(b){console.log(b),I.loginInProgress=!1,a.resolve()})},function(b){I.loginInProgress=!1,console.log(b),a.reject(b)}),a.promise)},w=function(){var a=o.defer();return I.loginInProgress===!0?a.promise:(I.loginInProgress=!0,m.login().then(function(b){console.log(b),I.linkUserWithSocialAuth(b).then(function(){I.loginInProgress=!1,c.currentAuthUser.isTwitterUser=!0,a.resolve()},function(b){I.loginInProgress=!1,a.reject(b)})},function(b){I.loginInProgress=!1,a.reject(b)}),a.promise)},x=function(){return m.fetchFriends(c.currentAuthUser.TwitterId)},y=function(a){var d=o.defer();return b({method:"PUT",url:h.USER+c.currentAuthUser.objectId,data:{authData:a}}).success(function(a){console.log(a),c.currentAuthUser.AuthData=a.AuthData,d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},z=function(){var a=o.defer();return I.loginInProgress===!0?a.promise:(I.loginInProgress=!0,k.login().then(function(b){console.log(b),I.linkUserWithSocialAuth(b).then(function(){I.loginInProgress=!1,c.currentAuthUser.isFacebookUser=!0,a.resolve()},function(b){I.loginInProgress=!1,a.reject(b)})},function(b){I.loginInProgress=!1,a.reject(b)}),a.promise)},A=function(){return k.fetchFriendsId(c.currentAuthUser.AuthData)},x=function(){return m.fetchFriends(c.currentAuthUser.AuthData)},B=function(a){return m.invite(c.currentAuthUser,a)},C=function(a,e){var f=o.defer();return I.loginInProgress===!0?f.promise:(I.loginInProgress=!0,b({method:"GET",url:h.LOGIN,params:{username:a,password:e}}).success(function(a){c.currentAuthUser;b.defaults.headers.common["X-Parse-Session-Token"]=a.sessionToken,c.currentAuthUser=d.insertUser(a,!0),g.createCookie("vvauth",a.sessionToken,1),E(),I.isLogged=!0,I.loginInProgress=!1,f.resolve()}).error(function(a){I.loginInProgress=!1,f.reject(a)}),f.promise)},D=function(a,e){var f=o.defer();return I.signUpInProgress===!0?f.promise:(I.signUpInProgress=!0,b({method:"POST",url:h.USER,headers:{"Content-Type":"application/json"},data:{username:a,password:e,email:a}}).success(function(a){c.currentAuthUser;b.defaults.headers.common["X-Parse-Session-Token"]=a.sessionToken,c.currentAuthUser=d.insertUser(a,!0),g.createCookie("vvauth",a.sessionToken,1),E(),I.isLogged=!0,I.signUpInProgress=!1,f.resolve()}).error(function(a){I.signUpInProgress=!1,f.reject(a)}),f.promise)},E=function(){n.init(c.currentAuthUser),f.fetch(!0),p.loadFilters(),r.loadFilters(),e.fetchVersusByType(j.FEED,j.TIMELINE),e.fetchVersusByType(j.INBOX,j.INBOX_IN),c.currentAuthUser.Thumbnail?g.createCookie(i.USER_THUMBNAIL+c.currentAuthUser.objectId,c.currentAuthUser.Thumbnail):I.socialProfile&&I.socialProfile.picture&&g.createCookie(i.USER_THUMBNAIL+c.currentAuthUser.objectId,I.socialProfile.picture),c.currentAuthUser.Username?g.createCookie(i.USER_USERNAME+c.currentAuthUser.objectId,c.currentAuthUser.Username):I.socialProfile&&I.socialProfile.username&&g.createCookie(i.USER_USERNAME+c.currentAuthUser.objectId,I.socialProfile.username)},F=function(a){var e=o.defer();return b({method:"GET",url:h.USER_ME,headers:{"X-Parse-Session-Token":a}}).success(function(f){I.loginInProgress=!1,c.sessionToken=a,I.sessionToken=a,b.defaults.headers.common["X-Parse-Session-Token"]=a,c.currentAuthUser=d.insertUser(f,!0),I.isLogged=!0,E(),e.resolve()}).error(function(){I.isLogged=!1,e.reject()}),e.promise},G=function(){if(I.sessionToken=g.readCookie(i.TOKEN),I.sessionToken){I.loginInProgress=!0;var a=o.defer();return F(I.sessionToken).then(function(){console.log("session validated after autologin"),I.loginInProgress=!1,a.resolve()},function(){console.log("session fail to validate token"),I.loginInProgress=!1,a.reject()}),a.promise}return null},H=function(){a.autologin=!1,g.deleteCookie(i.TOKEN),gapi.auth.signOut(),c.logout(),I.isLogged=!1,versusService.updateVersusAfterLogin()},I={isLogged:!1,self:this,sessionToken:"",loginInProgress:!1,signUpInProgress:!1,socialProfile:null,login:C,loginTwitter:v,linkTwitter:w,fetchTwitterFriends:x,inviteTwitter:B,loginFacebook:t,linkFacebook:z,inviteFacebook:u,fetchFacookFriendsId:A,linkUserWithSocialAuth:y,logOut:H,signUp:D,validateSession:F,autoLogin:G};return I}]),angular.module("viceversa.services").factory("DataStoreService",["Pusher","$http","$timeout",function(a,b,c){var d=[],e=function(){var a=Object.keys(d);return a?a.length:0},f=function(a){return d.hasOwnProperty(a.objectId)?d[a.objectId]:j(a)},g=function(a){return d.hasOwnProperty(a.objectId)?d[a.objectId]:j(a)},h=function(a){return d.hasOwnProperty(a.objectId)?d[a.objectId]:j(a)},i=function(a){return d.hasOwnProperty(a.objectId)?d[a.objectId]:j(a)},j=function(b){if(b.hasOwnProperty("objectId")===!1||b.hasOwnProperty("className")===!1)return b;if(d.hasOwnProperty(b.objectId)===!0){var e=d[b.objectId];return e.hasOwnProperty("updateIfNeeded")&&"function"==typeof e.updateIfNeeded&&e.updateIfNeeded(b),e}return a.subscribe(b.objectId,b.className,function(a){console.log("pusher update: "+a),c(function(){b.updateIfNeeded(a)},1e3)}),d[b.objectId]=b,b},k=function(a){return d[a]},l={_dataStore:d,count:e,insertData:j,insertComment:h,insertVersus:f,insertPrivateVersus:g,insertUser:i,get:k};return l}]),angular.module("viceversa.services").factory("NotificationService",["$rootScope","$http","UserService","DataFactory","URL","LIMIT","UtilsService","$q","ParseSaveEventuallyService",function(a,b,c,d,e,f,g,h,i){var j=function(){n.pool=[],n.unseen=[]},k=function(){for(var a=(n.unseen.length,n.unseen.length-1);a>=0&&n.unseen.length>0;a--)n.unseen[a].isSeen===!0&&n.unseen.splice(a,1)},l=function(a){a.isSeen!==!0&&(a.isSeen=!0,k(),a.setAsSeen().then(function(){console.log("activity has been set as seen.")},function(){console.log("failed to set this activity as seen.. try saveEventually"),i.saveEventually(a)}))},m=function(a){var i=h.defer();if(n.loading===!0)return i.reject("loading"),i.promise;n.loading=!0;var j,k=n.pool.length,l={};return l=JSON.stringify(0===k?{To:g.createParseUserObject(c.currentAuthUser.objectId),GroupId:{$exists:!0}}:a===!0?{createdAt:{$gt:n.pool[0].createdAt},To:g.createParseUserObject(c.currentAuthUser.objectId),GroupId:{$exists:!0}}:{createdAt:{$lt:n.pool[k-1].createdAt},To:g.createParseUserObject(c.currentAuthUser.objectId),GroupId:{$exists:!0}}),j={where:l,order:"-createdAt",limit:f.FETCH_ACTIVITY,include:"From,To,Versus,Comment"},b({method:"GET",url:e.ACTIVITY,params:j}).success(function(b){var c=[];0===b.results.length&&a===!1&&(n.noMore[a]=!0);for(var e=b.results.length-1;e>=0;e--){var f=d.insertActivity(b.results[e]);-1===n.pool.indexOf(f)&&(f.isSeen===!1&&n.unseen.push(f),c.unshift(f))}n.pool=a?c.concat(n.pool):n.pool.concat(c),n.loading=!1,i.resolve({pool:n.pool,unseenCount:n.unseen.length})}).error(function(a){n.loading=!1,i.reject(a)}),i.promise},n={noMore:{"true":!1,"false":!1},pool:[],unseen:[],loading:!1,reset:j,fetch:m,setAsSeen:l};return n}]),angular.module("viceversa.services").factory("URLSchemeService",["$q","$window","$rootScope",function(a,b,c){var d=function(a){var b="viceversa://?",c=b.length,d=a.substring(c,a.length);if(c=d.indexOf("="),-1!==c){var e=d.substring(0,c),f=d.substring(c+1,d.length);return{type:e,id:f}}return null};window.handleOpenURL=function(a){console.log("url:"+a),f.lastOpenURL=a,c.UserService.currentAuthUser&&f.goToOpenedURL()};var e=function(){if(null===f.lastOpenURL)return!1;var a=d(f.lastOpenURL);return console.log(a),"u"===a.type?(c.goToUser(a.id),!0):"v"===a.type?(c.goTo("tab.main-versus",{feedType:0,feedParam:a.id,slideIndex:0}),!0):(f.lastOpenURL=null,!1)},f={lastOpenURL:null,goToOpenedURL:e};return f}]),angular.module("viceversa.services").factory("FlickrService",["$resource","$q","KEYS","LIMIT",function(a,b,c,d){return FlickrService=function(){this.photosPublic=a("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+c.FLICKR+"&extras=url_m,url_s&sort=relevance&accuracy=safe&media=photos&per_page="+d.FLICKR,{format:"json",jsoncallback:"JSON_CALLBACK"},{load:{method:"JSONP"}}),this.lastResearchQuery="",this.lastResearchResult=[],this.noMore=!1,this.emptyResult=!1},FlickrService.prototype.reset=function(a){a!==this.lastResearchQuery&&(this.lastResearchQuery=a,this.lastResearchResult=[],this.noMore=!1,this.emptyResult=!1)},FlickrService.prototype.search=function(a){var c=b.defer(),e=0,f=this;return e=this.lastResearchResult.length/d.FLICKR+1,this.photosPublic.load({text:a,page:e},function(b){a!==f.lastResearchQuery?c.reject("new query is pending"):(b.photos.pages<=b.photos.page&&(f.noMore=!0),1===b.photos.page&&0===b.photos.photo.length&&(f.emptyResult=!0),f.lastResearchResult=f.lastResearchResult.concat(b.photos.photo),c.resolve(f.lastResearchResult))},function(a){c.reject(a)}),c.promise},FlickrService}]),angular.module("viceversa.services").factory("ImageGamingSearchService",["$resource","$q","KEYS","LIMIT",function(a,b,c,d){ImageGamingSearchService=function(){this.platform=a("http://www.giantbomb.com/:action",{action:"api/platform",field_list:"image",api_key:"3a26803613f60c046100bb84617900f22883ac49",format:"jsonp",json_callback:"JSON_CALLBACK"},{get:{method:"JSONP"}}),this.photosPublic=a("http://www.giantbomb.com/:action",{action:"api/search",field_list:"image",api_key:"3a26803613f60c046100bb84617900f22883ac49",limit:d.FLICKR,format:"jsonp",resources:"game,franchise,character,concept,object,location,person,video",json_callback:"JSON_CALLBACK"},{get:{method:"JSONP"}}),this.lastResearchQuery="",this.lastResearchResult=[],this.page=1},ImageGamingSearchService.prototype.reset=function(a){a!==this.lastResearchQuery&&(this.lastResearchQuery=a,this.lastResearchResult=[],this.page=1)};var e=function(a,c){var d=b.defer();return a.get(c,function(a){self.emptyResult=0===a.number_of_total_results;for(var b=[],c=0;c<a.results.length;c++)a.results[c].image&&b.push({url_s:a.results[c].image.medium_url,url_m:a.results[c].image.medium_url});d.resolve(b)},function(a){d.reject(a)}),d.promise};return ImageGamingSearchService.prototype.search=function(a){var c=b.defer(),f=this;return e(this.photosPublic,{query:a,page:this.page,limit:d.FLICKR}).then(function(a){f.page++,f.lastResearchResult=f.lastResearchResult.concat(a),c.resolve(f.lastResearchResult)},function(){c.reject()}),c.promise},ImageGamingSearchService}]),angular.module("viceversa.services").factory("ImageMovieSearchService",["$resource","$q","KEYS","LIMIT","lubTmdbApi",function(a,b,c,d,e){ImageMovieSearchService=function(){this.lastResearchQuery="",this.lastResearchResult=[],this.page=1,this.noMore=!1,this.emptyResult=!1,e.configuration.get().then(function(a){this.tmdbBaseUrl=a.data.images.secure_base_url},function(){console.log("error TMDB")})};var f="w185",g="w500",h="w185",i="h632";ImageMovieSearchService.prototype.reset=function(a){a!==this.lastResearchQuery&&(this.lastResearchQuery=a,this.lastResearchResult=[],this.page=1,this.noMore=!1,this.emptyResult=!1)};var j=function(a){for(var b=[],c=0;c<a.length;c++)"person"===a[c].media_type?null!==a[c].profile_path&&b.push({url_s:tmdbBaseUrl+h+a[c].profile_path,url_m:tmdbBaseUrl+i+a[c].profile_path}):null!==a[c].poster_path&&b.push({url_s:tmdbBaseUrl+f+a[c].poster_path,url_m:tmdbBaseUrl+g+a[c].poster_path});return b};return ImageMovieSearchService.prototype.search=function(a){var c=b.defer(),d=this;return e.search.multi({query:a,params:{page:this.page}}).then(function(b){if(a!==d.lastResearchQuery)c.reject("new query is pending");else{d.page++,b.data.total_pages<=b.data.page&&(d.noMore=!0),1===d.page&&0===b.data.results.length&&(d.emptyResult=!0);var e=j(b.data.results);d.lastResearchResult=d.lastResearchResult.concat(e),c.resolve(d.lastResearchResult)}},function(){c.reject()}),c.promise},ImageMovieSearchService}]),angular.module("viceversa.services").factory("ImageSearchService",["$rootScope","$q","ImageGamingSearchService","ImageMovieSearchService","FlickrService",function(a,b,c,d,e){return ImageSearchService=function(){this.imageSearchServices={GAMING:new c,MOVIE:new d,DEFAULT:new e}},ImageSearchService.prototype.get=function(){return this.imageSearchServices[a.create.category]?this.imageSearchServices[a.create.category]:this.imageSearchServices.DEFAULT},ImageSearchService.prototype.status=function(){var a=this.get();return{loading:a.loading,emptyResult:a.emptyResult,noMore:a.noMore}},ImageSearchService.prototype.isLoading=function(){var a=this.get();return a.loading},ImageSearchService.prototype.noMore=function(){var a=this.get();return a.noMore},ImageSearchService.prototype.emptyResult=function(){var a=this.get();return a.emptyResult},ImageSearchService.prototype.search=function(a){var c=b.defer(),d=this.get();return d.loading===!0?c.promise:(d.loading=!0,d.search(a).then(function(a){d.loading=!1,console.log("result.len = "+a.length),c.resolve(a)},function(){d.loading=!1,c.reject()}),c.promise)},ImageSearchService.prototype.reset=function(a){var b=this.get();console.log("reset"),b.reset(a)},ImageSearchService}]),angular.module("viceversa.services").factory("CategoryFilterService",["CookieService","COOKIE","$rootScope","FEEDTYPE",function(a,b){var c=function(){a.createCookie(b.CATEGORY_FILTER_ARRAY,g.currentNameFilters)},d=function(){g.currentNameFilters=a.readCookie(b.CATEGORY_FILTER_ARRAY),g.currentNameFilters||(g.currentNameFilters=g.allFiltersName);for(var c=g.currentNameFilters.length-1;c>=0;c--){var d=_.find(g.currentFilters,function(a){return a.name===g.currentNameFilters[c]});d&&(d.value=!0)}},e=function(){for(var a=[],b=g.currentFilters.length-1;b>=0;b--)g.currentFilters[b].value===!0&&a.unshift(g.currentFilters[b].name);var d=a.length!==g.currentNameFilters.length;if(d===!1)for(var b=a.length-1;b>=0;b--)if(a[b]!==g.currentNameFilters[b]){d=!0;break}return d===!1?!1:(g.currentNameFilters=a,c(),!0)},f=function(){return g.currentNameFilters},g={allFiltersName:["FOOD","FUN","GAMING","LIFESTYLE","MOVIE","MUSIC","NEWS","RELATIONSHIP","SPORT","STYLE","TECHNOLOGY","WORK"],currentNameFilters:[],currentFilters:[{name:"FOOD",value:!1},{name:"FUN",value:!1},{name:"GAMING",value:!1},{name:"LIFESTYLE",value:!1},{name:"MOVIE",value:!1},{name:"MUSIC",value:!1},{name:"NEWS",value:!1},{name:"RELATIONSHIP",value:!1},{name:"SPORT",value:!1},{name:"STYLE",value:!1},{name:"TECHNOLOGY",value:!1},{name:"WORK",value:!1}],loadFilters:d,updateFilters:e,getFilters:f};return g}]),angular.module("viceversa.services").factory("LanguageFilterService",["CookieService","COOKIE","$rootScope","FEEDTYPE","$ionicPlatform","$q",function(a,b,c,d,e,f){var g=function(){var a=f.defer();return e.ready(function(){if(!window.plugin)return void console.log("language plugin has not been load...");var b=window.plugin.languagePlugin;b.getCurrentLanguage(function(b){var c=b.substring(0,2);"iw"===c&&(c="he"),-1===l.allCodeLanguage.indexOf(c)&&(c="ot"),a.resolve(c)},function(b){a.reject(b)})}),a.promise},h=function(){a.createCookie(b.LANGUAGE_FILTER_ARRAY,l.currentCodeFilter)},i=function(){l.currentCodeFilter=a.readCookie(b.LANGUAGE_FILTER_ARRAY),l.currentCodeFilter||(l.currentCodeFilter=l.allCodeLanguage);for(var c=l.currentCodeFilter.length-1;c>=0;c--){var d=_.find(l.currentFilters,function(a){return a.code===l.currentCodeFilter[c]});d&&(d.value=!0)}},j=function(){for(var a=[],b=l.currentFilters.length-1;b>=0;b--)l.currentFilters[b].value===!0&&a.unshift(l.currentFilters[b].code);var c=a.length!==l.currentCodeFilter.length;if(c===!1)for(var b=a.length-1;b>=0;b--)if(a[b]!==l.currentCodeFilter[b]){c=!0;break}return c===!1?!1:(l.currentCodeFilter=a,h(),!0)},k=function(){return l.currentCodeFilter},l={currentCodeFilter:[],allCodeLanguage:["en","fr","ja","de","nl","pt","ru","es","ar","he","ot"],currentFilters:[{name:"english",code:"en",value:!1},{name:"french",code:"fr",value:!1},{name:"japanese",code:"ja",value:!1},{name:"german",code:"de",value:!1},{name:"dutch",code:"nl",value:!1},{name:"portuguese",code:"pt",value:!1},{name:"russian",code:"ru",value:!1},{name:"spanish",code:"es",value:!1},{name:"arabic",code:"ar",value:!1},{name:"hebrew",code:"he",value:!1},{name:"other",code:"ot",value:!1}],getCurrentLanguage:g,loadFilters:i,updateFilters:j,getFilters:k};return l}]),angular.module("viceversa.controllers").controller("SplashCtrl",["$scope","AuthService","$rootScope","CookieService","$timeout","COOKIE",function(a,b,c,d,e,f){a.AuthService=b,a.splashImage="img/logo-splash.png";var g=b.autoLogin();if(g){var h=d.readCookie(f.USER_THUMBNAIL);h&&(a.splashImage=h),g.then(function(){c.navigateAfterLogin()},function(){c.navigateAfterLogin()})}else c.navigateAfterLogin()}]),angular.module("viceversa.controllers").controller("IntroCtrl",["$rootScope","$scope","$state","$ionicHistory","$ionicSwipeCardDelegate","$timeout","AuthService","$ionicModal",function(a,b,c,d,e,f,g,h){b.computeLast=function(){var a=document.querySelectorAll(".versus");document.getElementById("last-card").style.height=a[0].clientHeight+"px"},b.hideTryBtn=!1;
var i="img/examples/versus/",j="img/examples/profilpic/";b.cards=[{title:"Movie to watch tonight?",username:"Nathaniel",pic:j+"1.jpg",category:"movies",timeleft:"2 hours",votes:130,comments:42,img1:i+"1.jpg",title1:"Gravity",img2:i+"2.jpg",title2:"Interstellar",vote1:74,vote2:26,voted:null},{title:"Movie to watch tonight?",username:"Nathaniel",pic:j+"1.jpg",category:"movies",timeleft:"2 hours",votes:130,comments:42,img1:i+"1.jpg",title1:"Gravity",img2:i+"2.jpg",title2:"Interstellar",vote1:74,vote2:26,voted:null}],b.loginFacebook=function(){a.showToast("loading","Logging in...","ion-loading-d"),g.loginFacebook().then(function(){a.hideToast(),a.navigateAfterLogin()},function(b){a.hideToast(),a.showToast("error",b.errorMessage,"ion-ios7-locked",1e3)})},b.loginTwitter=function(){a.showToast("loading","Logging in...","ion-loading-d"),g.loginTwitter().then(function(){a.hideToast(),a.navigateAfterLogin()},function(b){a.hideToast(),a.showToast("error",b,"ion-ios7-locked",1e3)})},b.login=function(){a.showToast("loading","Logging in...","ion-loading-d"),g.login(b.loginModal.email,b.loginModal.password).then(function(){d.nextViewOptions({disableAnimate:!0,disableBack:!0,historyRoot:!0}),a.hideToast(),b.closeLogin(),a.navigateAfterLogin()},function(){a.showToast("error","Wrong combination email/password","ion-ios7-locked",1e3)})},b.signup=function(){a.showToast("loading","Signin up...","ion-loading-d"),b.signupModal.password!==b.signupModal.c_password?(a.showToast("error","Wrong password & confirmation","ion-ios7-locked",1e3),b.signupModal.password="",b.signupModal.c_password=""):b.signupModal.password?b.signupModal.password.length<=5?a.showToast("error","password must be at least 6 characters long","ion-ios7-locked",1e3):g.signUp(b.signupModal.email,b.signupModal.password).then(function(){d.nextViewOptions({disableAnimate:!0,disableBack:!0,historyRoot:!0}),a.hideToast(),b.closeSignup(),a.navigateAfterLogin()},function(){a.showToast("error","There's been an error while signin up","ion-ios7-locked",1e3)}):a.showToast("error","A password is required","ion-ios7-locked",1e3)},b.hideTry=function(){b.hideTryBtn=!0},b.cardSwiped=function(){b.hideTry()},b.cardDestroyed=function(a){b.cards.splice(a,1),b.hideTry()},h.fromTemplateUrl("templates/auth/login.html",{scope:b,animation:"slide-in-up"}).then(function(a){b.loginModal=a}),b.openLogin=function(){b.loginModal.show()},b.closeLogin=function(){b.loginModal.hide()},h.fromTemplateUrl("templates/auth/signup.html",{scope:b,animation:"slide-in-up"}).then(function(a){b.signupModal=a}),b.openSignup=function(){b.signupModal.show()},b.closeSignup=function(){b.signupModal.hide()}}]).controller("CardCtrl",["$scope","$ionicSwipeCardDelegate","$timeout",function(a,b,c){a.goAway=function(){var c=b.getSwipeableCard(a);c.swipe()},a.vote=function(d,e){c(function(){a.cards[d].voted=e},800),c(function(){var c=b.getSwipeableCard(a);c.swipe()},2e3),a.vote=function(d,e){c(function(){a.cards[d].voted=e},800),c(function(){var c=b.getSwipeableCard(a);c.swipe()},2e3)}}}]),angular.module("viceversa.controllers").controller("NotificationsCtrl",["$scope","NotificationService","$rootScope","$location",function(a,b,c){a.NotificationService=b,a.notifications=b.pool,a.moreDataCanBeLoaded=function(b){return a.NotificationService.noMore[b]===!1},a.loadMore=function(){a.moreDataCanBeLoaded(!1)===!0?a.NotificationService.fetch(!1).then(function(b){a.notifications=b.pool,a.$broadcast("scroll.infiniteScrollComplete")},function(){console.log("on fait quoi chef ?")}):a.$broadcast("scroll.infiniteScrollComplete")},a.goToActivity=function(a){b.setAsSeen(a),"tab.notifications-user"===a.link.route?c.goToUser(a.link.params.userId):c.goTo(a.link.route,a.link.params)}}]),angular.module("viceversa.controllers").controller("SearchCtrl",["$scope","$ionicSlideBoxDelegate","UserService","User","$rootScope","AuthService","TwitterService","$timeout",function(a,b,c,d,e,f){a.UserService=c,a.User=d,a.slideIndex=0;var g=ionic.debounce(function(c){a.UserService.research(c).then(function(c){c.search===a.search.text&&(a.slideIndex=0,a.suggestedList=c.data,b.select(0,0))},function(){console.log("On fait quoi chef ?")})},500);a.fetchSuggestedList=function(){c.fetchSuggestedList().then(function(b){a.UserService.suggestedList=b,a.suggestedList=b},function(){console.log("On fait quoi chef ?")})},a.fetchFacebookList=function(){a.User.currentAuthUser.isFacebookUser===!0&&f.fetchFacookFriendsId().then(function(b){c.fetchFacebookFriends(b).then(function(b){a.facebbokList=b},function(a){console.log("On fait quoi chef ? "+a)})},function(a){console.log("error:"+a)})},a.fetchTwitterList=function(){a.User.currentAuthUser.isTwitterUser===!0&&f.fetchTwitterFriends().then(function(b){c.fetchTwitterFriends(b).then(function(b){a.twitterList=b},function(a){console.log("On fait quoi chef ? "+a)})},function(a){console.log("error: "+a)})},a.setSearchFeed=function(){switch(a.slideIndex){case 0:!a.search.text||a.search.text.length<2?a.fetchSuggestedList():console.log("search");break;case 1:a.fetchFacebookList();break;case 2:a.fetchTwitterList()}},a.$on("$ionicView.beforeEnter",function(){a.setSearchFeed()}),a.$on("$ionicView.afterEnter",function(){b.$getByHandle("slideboxSearch").update()}),a.search=function(){!a.search.text||a.search.text.length<2?a.suggestedList=a.UserService.suggestedList:g(a.search.text)},a.linkFacebook=function(){f.linkFacebook().then(function(){e.showToast("success","Done","ion-checkmark",1e3)},function(a){console.log(a),e.showToast("error",a,"ion-ios7-locked",1e3)})},a.linkTwitter=function(){f.linkTwitter().then(function(){e.showToast("success","Done","ion-checkmark",1e3)},function(a){console.log(a),e.showToast("error",a,"ion-ios7-locked",1e3)})},a.slideChanged=function(){a.slideIndex=b.selected(),a.setSearchFeed()},a.slideTo=function(c){b.select(c,0),a.slideIndex=c},a.follow=function(b){a.UserService.currentAuthUser.follow(b)},a.unFollow=function(b){a.UserService.currentAuthUser.follow(b)},a.inviteFacebook=function(){f.inviteFacebook()},a.inviteTwitter=function(a){console.log("invite: "+a),f.inviteTwitter(a.id)},a.title='<ul class="clearfix list-three"><li><a ng-click="slideTo(0)" ng-class="{active: slideIndex == 0 || !slideIndex}">All Users</a></li><li><a ng-click="slideTo(1)" ng-class="{active: slideIndex == 1}">Facebook</a></li><li><a ng-click="slideTo(2)" ng-class="{active: slideIndex == 2}">Google</a></li></ul>',a.refresh=function(){}}]),angular.module("viceversa.controllers").controller("TabsCtrl",["$scope","$timeout","$rootScope","$ionicTabsDelegate","$state","$ionicScrollDelegate",function(a,b,c,d){var e=["main","search","notifications","user"];b(function(){var a=d.selectedIndex();a>=e.length&&(a=0),c.activeTab=e[a]}),a.navigateToTab=function(a,b){b>=e.length&&(b=0),c.activeTab=e[b],d.select(b)}}]),angular.module("viceversa.controllers").controller("UserCtrl",["$scope","$state","$stateParams","$rootScope","UserService","User","VersusFeedService","$timeout","FEEDTYPE","DataFactory","$sce",function(a,b,c,d,e,f,g,h,i,j){a.feedHtml="",a.showFeed=!1,a.displayUser=!1,a.$on("$ionicView.afterEnter",function(){a.UserService=e,a.User=f,a.user=f.currentAuthUser,a.VersusFeedService=g;var b=c.userID?c.userID:e.currentAuthUser.objectId;j.getUser(b).then(function(b){e.currentPageUser=b,a.displayUser=!0},function(){d.showToast("error","Oups, something went wrong","ion-ios7-close",1e3),d.goBack()});var k=function(){a.duels=a.VersusFeedService.getPool(i.USER,b),a.showFeed===!1&&a.duels&&h(function(){a.showFeed=!0},300),a.$broadcast("scroll.infiniteScrollComplete")};a.moreDataCanBeLoaded=function(){return a.VersusFeedService.noMore[i.USER+b]===!1||void 0===a.VersusFeedService.noMore[i.USER+b]},a.loadMore=function(){a.moreDataCanBeLoaded()===!0?a.VersusFeedService.fetchVersusByType(i.USER,b).then(function(){k()},function(a){console.log("Euhh, on fait quoi la chef ?"+a)}):a.$broadcast("scroll.infiniteScrollComplete")},k(),a.duels||a.loadMore()}),a.$on("$ionicView.beforeLeave",function(){e.currentPageUser=null,a.duels=[]})}]),angular.module("viceversa.controllers").controller("FollowCtrl",["$scope","UserService","$stateParams","User","DataFactory","$ionicPopover",function(a,b,c,d,e,f){var g=c.userId;a.UserService=b,a.User=d;var h=function(){0===a.activeFollow?(a.followList=b.currentPageUser.Follower,0===a.followList.length&&b.currentPageUser.fetchFollower().then(function(){a.followList=a.UserService.currentPageUser.Follower},function(){console.log("fail to fetch following")})):(a.followList=b.currentPageUser.Following,0===a.followList.length&&b.currentPageUser.fetchFollowing().then(function(){a.followList=a.UserService.currentPageUser.Following},function(){console.log("fail to fetch following")}))};a.$on("$ionicView.afterEnter",function(){a.activeFollow=parseInt(c.followIndex),a.user=d.currentAuthUser,e.getUser(g).then(function(b){a.UserService.currentPageUser=b,h()},function(a){console.log("Euhh, on fait quoi la chef ?"+a)})}),f.fromTemplateUrl("templates/user/follow-popover.html",{scope:a}).then(function(b){a.popover?a.popover.hide():a.popover=b}),a.setFollow=function(b){a.activeFollow=b,h(),a.popover&&a.popover.hide()},a.refreshFollowers=function(){console.log("refreshFollower")},a.loadMoreFollowers=function(){a.UserService.currentPageUser&&a.UserService.currentPageUser.fetchFollower().then(function(){console.log("loadMoreFollowers"),a.$broadcast("scroll.infiniteScrollComplete")})},a.refreshFollowing=function(){console.log("refreshFollowing")},a.loadMoreFollowings=function(){a.UserService.currentPageUser&&a.UserService.currentPageUser.fetchFollowing().then(function(){console.log("loadMoreFollowings"),a.$broadcast("scroll.infiniteScrollComplete")})}}]),angular.module("viceversa.controllers").controller("InboxCtrl",["$scope","VersusFeedService","FEEDTYPE","$rootScope","$ionicPopover",function(a,b,c,d,e){a.VersusFeedService=b;var f=function(){a.duels=a.VersusFeedService.getPool(c.INBOX,d.activeInbox),a.$broadcast("scroll.infiniteScrollComplete")};a.$on("$ionicView.afterEnter",function(){a.duels=a.VersusFeedService.getPool(c.INBOX,d.activeInbox),a.refresh=function(){return!0},a.moreDataCanBeLoaded=function(){return a.VersusFeedService.noMore[c.INBOX+d.activeInbox]===!1||void 0===a.VersusFeedService.noMore[c.INBOX+d.activeInbox]},a.loadMore=function(){a.moreDataCanBeLoaded()===!0?a.VersusFeedService.fetchVersusByType(c.INBOX,d.activeInbox).then(function(){f()},function(){console.log("Chef, on fait quoi la ?")}):a.$broadcast("scroll.infiniteScrollComplete")},a.setInbox=function(b){d.activeInbox=b,a.popover&&a.popover.hide(),f(),0===a.duels.length&&a.loadMore()},e.fromTemplateUrl("templates/versus/modals/inbox-popover.html",{scope:a}).then(function(b){a.popover?a.popover.hide():a.popover=b})})}]),angular.module("viceversa.controllers").controller("FiltersCtrl",["$scope","CategoryFilterService","LanguageFilterService","SETTINGS","$rootScope","FlurryService","ANALYTICS",function(a,b,c,d,e,f,g){a.CategoryFilterService=b,a.LanguageFilterService=c,a.listCategories=a.CategoryFilterService.currentFilters,a.listLanguages=a.LanguageFilterService.currentFilters,a.$on("$ionicView.beforeLeave",function(){var b=a.CategoryFilterService.updateFilters(),c=a.LanguageFilterService.updateFilters();(c||b)&&(e.$broadcast("filters-updated"),f.logEvent(g.CHANGE_FILTER))})}]),angular.module("viceversa.controllers").controller("FeedCtrl",["$scope","VersusFeedService","UtilsService","FEEDTYPE","$rootScope","$timeout","$ionicPopover",function(a,b,c,d,e,f,g){a.VersusFeedService=b,e.activeFeed=d.ALL,a.currentPool=[],a.pool=[],a.loading=[],a.pull2refresh=!1;var h=function(b){a.currentPool[d.FEED+b]=[],a.pool[d.FEED+b]=[],a.loading[d.FEED+b]=!1};h(d.ALL),h(d.TIMELINE),a.feedKey=d.FEED+e.activeFeed,a.setFeed=function(b){a.popover&&a.popover.hide(),e.activeFeed=b,a.feedKey=d.FEED+e.activeFeed,a.pool[a.feedKey]=a.VersusFeedService.getPool(d.FEED,e.activeFeed),0===a.currentPool[a.feedKey].length&&a.loadMore(!1)},a.moreDataCanBeLoaded=function(){return a.VersusFeedService.noMore[d.FEED+e.activeFeed]===!1&&a.loading[a.feedKey]===!1},a.addMoreData=function(b){var d=[];return d=b?c.addPrevItem(a.pool[a.feedKey],a.currentPool[a.feedKey],5):c.addNextItem(a.pool[a.feedKey],a.currentPool[a.feedKey],5),0!==d.length?(f(function(){a.currentPool[a.feedKey]=b?d.concat(a.currentPool[a.feedKey]):a.currentPool[a.feedKey].concat(d),console.log("after add: "+a.currentPool[a.feedKey].length),a.$broadcast(b?"scroll.refreshComplete":"scroll.infiniteScrollComplete"),a.loading[a.feedKey]=!1},10),!0):!1};var i=function(b){a.$broadcast(b?"scroll.refreshComplete":"scroll.infiniteScrollComplete"),a.loading[a.feedKey]=!1},j=function(b){a.moreDataCanBeLoaded()===!0||b?(a.loading[a.feedKey]=!0,a.VersusFeedService.fetchVersusByType(d.FEED,e.activeFeed,b).then(function(){a.pool[a.feedKey]=a.VersusFeedService.getPool(d.FEED,e.activeFeed),i(b)},function(){i(b)})):i(b)};a.loadMore=function(b){return a.loading[a.feedKey]===!0?void console.log("hey coco, trankil"):(console.log("loadMore"),void(a.addMoreData(b)===!1&&j(b)))},a.hardReset=function(){h(d.ALL),a.VersusFeedService.resetByType(d.FEED,d.ALL).then(function(){a.pool[a.feedKey]=a.VersusFeedService.getPool(d.FEED,e.activeFeed),e.activeFeed===d.ALL&&a.addMoreData(!1)},function(){console.log("Chef on fait quoi la ?")})},g.fromTemplateUrl("templates/versus/modals/feed-popover.html",{scope:a}).then(function(b){a.popover?a.popover.hide():a.popover=b}),e.$on("filters-updated",a.hardReset),e.$on("upload-versus-done",function(){a.VersusFeedService.fetchVersusByType(d.FEED,e.activeFeed,!0).then(function(){a.pool[a.feedKey]=a.VersusFeedService.getPool(d.FEED,e.activeFeed),a.addMoreData(!0),i(!0)},function(){i(!0)})}),a.setFeed(e.activeFeed)}]),angular.module("viceversa.controllers").controller("CommentsCtrl",["$scope","$rootScope","Comment","$timeout","$stateParams","DataFactory",function(a,b,c,d,e,f){var g,h,i;a.versus=f.get(e.versusId),f.getVersus(e.versusId).then(function(b){a.versus=b,a.versus.fetchComment(),a.comments=a.versus.Comments},function(){b.showToast("error","Oups, something went wrong..","ion-ios7-locked",1e3)}),d(function(){g=document.body.querySelector("#comments-container .bar-footer"),i=document.body.querySelector("#comments-container .scroll-content"),h=angular.element(g.querySelector("textarea"))},0),a.refresh=function(){return!0},a.loadMore=function(){return!0},a.sendComment=function(){new c(a.versus,a.comment);a.comment=""},a.$on("taResize",function(a,b){if(b){var c=b[0].offsetHeight;if(g){var d=c+10;d=d>44?d:44,g.style.height=d+"px",i.style.bottom=d+"px"}}})}]),angular.module("viceversa.controllers").controller("VotesCtrl",["$scope","$rootScope","UserService","User","$stateParams","DataFactory",function(a,b,c,d,e,f){a.UserService=c,a.User=d,a.versus=f.get(e.versusId),a.UserService.fetchVotedBy(a.versus),a.data=a.UserService.votedBy[e.versusId];var g=function(){a.data=a.UserService.votedBy[e.versusId],a.$broadcast("scroll.infiniteScrollComplete")};a.UserService.register(a.UserService.eventType.VOTEDBY,g),a.refresh=function(){return!0},a.loadMore=function(){return a.UserService.fetchVotedBy(a.versus),!0}}]),angular.module("viceversa.controllers").controller("InvitedCtrl",["$scope","$rootScope","UserService","User","$stateParams","DataFactory",function(a,b,c,d,e,f){a.UserService=c,a.User=d,a.versus=f.get(e.versusId),a.UserService.fetchPrivateVersusInvited(a.versus),a.data=a.UserService.privateVersusInvited[a.versus.objectId],a.$broadcast("scroll.infiniteScrollComplete");var g=function(){a.data=a.UserService.privateVersusInvited[a.versus.objectId],a.$broadcast("scroll.infiniteScrollComplete")};a.UserService.register(a.UserService.eventType.INVITED,g),a.refresh=function(){return!0},a.loadMore=function(){return a.UserService.fetchPrivateVersusInvited(a.versus),!0}}]),angular.module("viceversa.controllers").controller("VersusFullCtrl",["$scope","$ionicActionSheet","$stateParams","$ionicModal","VersusFeedService","DataFactory","$rootScope",function(a,b,c,d,e,f,g){a.slideIndex=parseInt(c.slideIndex),a.$on("$ionicView.enter",function(){a.VersusFeedService=e;var b=c.feedParam;f.getVersus(b).then(function(b){a.duels=[b]},function(){g.showToast("error","Oups, something went wrong","ion-ios7-close",1e3),g.goBack()})}),a.displayActionSheet=function(){b.show({buttons:[{text:"<b>Share</b> This"},{text:"Move"}],destructiveText:"Delete",titleText:"What should we do?",cancelText:"Cancel",cancel:function(){},buttonClicked:function(){return!0}})},a.refresh=function(){return!0},a.followVersus=function(){}}]),angular.module("viceversa.controllers").controller("FlickrCtrl",["$scope","$rootScope","FlickrService","$window",function(a,b,c,d){a.FlickrService=c,a.modalOn=!1,a.refresh=function(){return!0},a.loadMore=function(){return!0},a.loading=!1,a.$watch(function(){return a.FlickrService.loading},function(){console.log("loading="+a.FlickrService.loading),a.loading=a.FlickrService.loading},!0),a.$on("modal.shown",function(){a.modalOn=!0,a.query=b.create.choiceTitle[a.selectedChoiceIndex],c.reset(a.query),e(a.query)}),a.$on("modal.close",function(){a.modalOn=!1});var e=ionic.debounce(function(b){b&&0!==b.length&&c.search(b).then(function(b){a.photos=b,a.$broadcast("scroll.infiniteScrollComplete"),console.log("new result")})},500);a.computePhotosHeight=function(){return d.innerWidth/2-2+"px"},a.search=function(){a.modalOn!==!1&&(console.log("search"),c.reset(a.query),e(a.query))},a.setImage=function(c){console.log(a.selectedChoiceIndex),b.create.choiceImg[a.selectedChoiceIndex]=c,a.FlickrModal.hide()}}]),angular.module("viceversa.controllers").controller("CreateCtrl",["$scope","$rootScope","$timeout","UserService","VersusFeedService","FlurryService","ANALYTICS","ImageSearchService",function(a,b,c,d,e,f,g,h){(!b.create||b.create&&b.create.failed===!1)&&(b.create={},b.create.category="movie",b.create.choiceTitle=[],b.create.choiceImg=[],b.create.selectedUsers=[],b.create.hours=4,b.create.minutes=0,b.create.displayClock=!1,b.create.share={facebook:!1,twitter:!1}),a.ImageSearchService=h,a.suggestedWidth=[],a.searchText=[],a.displaySearchText=[],a.photos=[],a.currentIndex=[],a.currentIndex[0]=0,a.currentIndex[1]=0,a.searchService=[new h,new h],a.choiceSearch=[],a.status=[a.searchService[0].status(),a.searchService[1].status()],f.logEvent(g.START_CREATE_VERSUS),b.quiteCreation=function(){f.logEvent(g.STOP_CREATE_VERSUS),b.goBack()},b.base64prefix="data:image/jpg;base64,",b.getTimes=function(a){return new Array(a)}}]),angular.module("viceversa.controllers").controller("CreateCategoryCtrl",["$scope","$rootScope","$state","$timeout","CategoryFilterService","LanguageFilterService",function(a,b,c,d,e,f){a.categories=e.allFiltersName,d(function(){b.create.lang="",f.getCurrentLanguage().then(function(a){console.log(a),b.create.lang=a},function(a){console.log(a)})}),a.setCategory=function(a){b.create.category=a,d(function(){c.go("create.question")},100)}}]),angular.module("viceversa.controllers").controller("CreateChoicesCtrl",["$scope","$rootScope","$ionicActionSheet","$ionicModal","$timeout","CameraService","$cordovaCamera","$window","$ionicSlideBoxDelegate","ImageSearchService","$q",function(a,b,c,d,e,f,g,h,i){"undefined"!=typeof cordova&&cordova.plugins.Keyboard.disableScroll(!0),a.takePicture=function(a){var c={quality:75,correctOrientation:!0,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,encodingType:Camera.EncodingType.JPEG};g.getPicture(c).then(function(c){b.create.choiceImg[a]=b.base64prefix+c,i.$getByHandle("slidebox"+a).update()},function(a){b.showToast("error",a,"ion-close",1e3),console.log(a)})},a.browseGallery=function(a){var c={quality:75,correctOrientation:!0,destinationType:Camera.DestinationType.DATA_URL,targetWidth:400,targetHeight:400,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,encodingType:Camera.EncodingType.JPEG};g.getPicture(c).then(function(c){b.create.choiceImg[a]=b.base64prefix+c,i.$getByHandle("slidebox"+a).update()},function(a){b.showToast("error",a,"ion-close",1e3),console.log(a)})};var j=ionic.debounce(function(b,c,d){b&&0!==b.length&&(a.status[c].loading=!0,a.searchService[c].search(b).then(function(b){a.photos[c]=b,a.suggestedWidth[c]=a.photos[c].length*h.innerWidth+"px",i.$getByHandle("slidebox"+c).update(),d&&i.$getByHandle("slidebox"+c).slide(0),a.status[c]=a.searchService[c].status()},function(){a.status[c]=a.searchService[c].status()}))},500);a.search=function(c,d){b.create.choiceTitle[c]=b.create.choiceTitle[c].substring(0,35),d===!0?(a.searchService[c].reset(b.create.choiceTitle[c]),a.status[c]=a.searchService[c].status(),j(b.create.choiceTitle[c],c,!0),a.searchText[c]=b.create.choiceTitle[c]):(a.searchService[c].reset(a.searchText[c]),a.status[c]=a.searchService[c].status(),j(a.searchText[c],c,!0))},a.closeKeyboard=function(a){"undefined"!=typeof cordova&&cordova.plugins.Keyboard.close(),i.$getByHandle("slidebox"+a).update()},a.removePicture=function(a){var d=c.show({buttons:[{text:'<span class="color-red"><i class="icon ion-trash-a"></i> Remove this picture</span>'}],cancelText:'<i class="icon ion-close"></i> Cancel',cancel:function(){d()},buttonClicked:function(c){switch(d(),c){case 0:b.create.choiceImg[a]=null}}})},a.previousSlide=function(a){i.$getByHandle("slidebox"+a).previous()},a.nextSlide=function(a){i.$getByHandle("slidebox"+a).next()},a.slideChanged=function(c,d){e(function(){if(a.currentIndex[d]=i.$getByHandle("slidebox"+d).currentIndex(),a.photos[d].length-a.currentIndex[d]<3){var c=a.choiceSearch?b.create.choiceTitle[d]:a.searchText[d];j(c,d,!1)}})},a.cancel=function(b){i.$getByHandle("slidebox"+b).slide(0),a.displaySearchText[b]=!1},a.nextStep=function(){if(!b.create.choiceImg[0]){if(!(a.photos[0].length>=a.currentIndex[0]))return void console.log("first image missing");if(a.photos[0][a.currentIndex[0]].hasOwnProperty("url_m"))b.create.choiceImg[0]=a.photos[0][a.currentIndex[0]].url_m;else{if(!a.photos[0][a.currentIndex[0]].hasOwnProperty("url_s"))return void console.log("first image missing");b.create.choiceImg[0]=a.photos[0][a.currentIndex[0]].url_s}}if(!b.create.choiceImg[1]){if(!(a.photos[1].length>=a.currentIndex[1]))return void console.log("second image missing");if(a.photos[1][a.currentIndex[1]].hasOwnProperty("url_m"))b.create.choiceImg[1]=a.photos[1][a.currentIndex[1]].url_m;else{if(!a.photos[1][a.currentIndex[1]].hasOwnProperty("url_s"))return void console.log("second image missing");b.create.choiceImg[1]=a.photos[1][a.currentIndex[1]].url_s}}!b.create.choiceTitle[0]&&b.create.choiceTitle[0].length<2?console.log("invalid first choice"):!b.create.choiceTitle[1]&&b.create.choiceTitle[1].length<2?console.log("invalid second choice"):b.goTo("create.final",{})}}]),angular.module("viceversa.controllers").controller("CreateFinalCtrl",["$rootScope","$scope","VersusFeedService","$state","UserService","$timeout","$ionicBackdrop","$q","FacebookService","TwitterService","FEEDTYPE","FlurryService","ANALYTICS",function(a,b,c,d,e,f,g){b.users=e.currentAuthUser.Follower,b.searchText="42",b.displayUserScreen=0,b.displayUsers=function(){b.displayUserScreen=1},b.hideUsers=function(){b.displayUserScreen=0},b.showClock=function(){g.retain(),a.create.displayClock=!0},b.VersusFeedService=c,b.UserService=e;var h=function(b){var c=b.displayName.toLowerCase(),d=a.create.searchText.toLowerCase();return-1!==c.indexOf(d)};b.searchFollower=function(){b.users=0===a.create.searchText.length?b.UserService.currentAuthUser.Follower:b.UserService.currentAuthUser.Follower.filter(h)},b.selectUser=function(b){var c=a.create.selectedUsers.indexOf(b);-1!==c?a.create.selectedUsers.splice(c,1):a.create.selectedUsers.push(b)}}]),angular.module("viceversa.controllers").controller("CreateQuestionCtrl",["$scope","$rootScope",function(a,b){a.checkMax=function(){b.create.title=b.create.title.substring(0,70)},a.navigateChoices=function(){b.create.title&&b.create.title.length>=2?b.goTo("create.choices",null):b.showToast("error","The title should be at least 2 characters long!","ion-close",1e3)}}]),angular.module("viceversa.controllers").controller("StartCtrl",["$scope","$rootScope","UserService","AuthService","CookieService","COOKIE","$timeout",function(a,b,c,d,e,f,g){b.infos={},d.socialProfile&&d.socialProfile.picture?b.infos.profilpic=d.socialProfile.picture:(b.infos.profilpic=e.readCookie(f.USER_THUMBNAIL+c.currentAuthUser.objectId),b.infos.profilpic||(b.infos.profilpic="img/default-pic.png")),d.socialProfile&&d.socialProfile.username?b.infos.username=d.socialProfile.username:(b.infos.username=e.readCookie(f.USER_USERNAME+c.currentAuthUser.objectId),b.infos.username||(b.infos.username="")),a.UserService=c,b.updateUser=function(){b.showToast("loading","Creating your account","ion-loading-d");var c;c="img/default-pic.png"===b.infos.profilpic?a.UserService.setDefaultPicture(b.infos.username):a.UserService.updateProfilePicture(b.infos.profilpic,b.infos.username),c.then(function(){b.hideToast(),b.$broadcast("update.user"),b.navigateAfterLogin(),b.showToast("success","Welcome to Viceversa!","ion-checkmark",1e3),b.displayTips=!0,g(function(){b.displayTips=!1},5e3)},function(){b.showToast("error","Upload failed, retry..","ion-ios7-locked",1e3)})}}]),angular.module("viceversa.controllers").controller("StartFiltersCtrl",["$scope","$rootScope","LanguageFilterService",function(a,b,c){a.computeFilterList=function(){var a=document.getElementById("almost"),b=document.getElementById("filter-list");b.style.height=window.innerHeight-a.offsetHeight-64+"px"},a.computeFilterList(),a.LanguageFilterService=c,a.listLanguages=a.LanguageFilterService.currentFilters,a.$on("$ionicView.enter",function(){});var d=function(){a.LanguageFilterService.updateFilters()};b.$on("update.user",function(){console.log("$on update.user => save filters"),d()}),a.$on("$ionicView.leave",function(){console.log("$on $ionicView.leave => save filters"),d()})}]),angular.module("viceversa.controllers").controller("StartProfilPicCtrl",["$scope","$rootScope","$ionicActionSheet","$cordovaCamera",function(a,b,c,d){a.imageSourceChoice=function(){var a=c.show({buttons:[{text:'<i class="icon ion-camera"></i> Take photo'},{text:'<i class="icon ion-images"></i> Choose from library'}],cancelText:'<i class="icon ion-close"></i> Cancel',cancel:function(){},buttonClicked:function(c){switch(c){case 0:var e={quality:75,correctOrientation:!0,targetWidth:200,targetHeight:200,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,encodingType:Camera.EncodingType.JPEG};d.getPicture(e).then(function(a){b.infos.profilpic="data:image/jpeg;base64,"+a}),a();break;case 1:var e={quality:75,correctOrientation:!0,targetWidth:200,targetHeight:200,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,encodingType:Camera.EncodingType.JPEG};d.getPicture(e).then(function(a){b.infos.profilpic="data:image/jpeg;base64,"+a}),a()}}})}}]),angular.module("viceversa.controllers").controller("StartUsernameCtrl",["$scope","$rootScope","UserService","$q","$http","URL","UtilsService",function(a,b,c,d,e,f,g){a.validUsername=[],a.UserService=c;var h=function(a){var b=d.defer();return e({method:"POST",url:f.USERNAME_AVAILABLE_FUNCTION,data:{username:a}}).success(function(){b.resolve(a)}).error(function(){b.reject(a)}),b.promise};a.validateUsername=function(){if(b.infos.username.length>2){var a=h(b.infos.username);a.then(function(){b.goTo("start.profilpic",null)},function(){b.showToast("error","This username is not available","ion-ios7-close",1e3)})}else b.showToast("error","Username must be at least 3 characters long","ion-ios7-close",1e3)};var i=ionic.debounce(function(){console.log("check:"+b.infos.username),c.isUsernameAvailable(b.infos.username).then(function(b){a.validUsername[b]=!0},function(b){a.validUsername[b]=!1})},500);a.checkIfAvailable=function(){if(!b.infos.username)return void(b.infos.username="");if(b.infos.username.match("^[a-zA-Z0-9]*$")||(b.showToast("error","Only alphanumeric caracters are allowed","ion-ios7-close",1e3),b.infos.username=g.sanitize(b.infos.username)),b.infos.username.length>15&&(b.infos.username=b.infos.username.substring(0,15)),b.infos.username&&b.infos.username.length>=2){if(-1!==a.validUsername.indexOf(b.infos.username))return;i(a.validUsername)}},b.infos.username||(b.infos.username=""),""!==b.infos.username&&(b.infos.username=g.sanitize(b.infos.username).substring(0,15),a.checkIfAvailable())}]),angular.module("viceversa.directives").directive("notifications",["$compile","NotificationService",function(a,b){return{restrict:"EA",templateUrl:"templates/notifications/notifications.html",terminal:!0,scope:{notifications:"=data",itemClick:"&"},link:function(c,d){a(d.contents())(c.$new()),c.NotificationService=b,c.$watch("notifications",function(a){if(c.notifications=a,null!==c.notifications)for(var b=0;b<c.notifications.length;++b){var d=c.notifications[b].Type;if("Vote"===d){c.notifications[b].message=" has voted on your versus ",c.notifications[b].data=c.notifications[b].Versus.Title;var e="#/tab/notifications/versus/single/"+c.notifications[b].Versus.objectId+"/0";c.notifications[b].link=e,c.notifications[b].icon="ion-checkmark"}else if("Comment"===d){c.notifications[b].message=" has commented on your versus ",c.notifications[b].data=c.notifications[b].Versus.Title;var e="#/tab/notifications/versus/single/"+c.notifications[b].Versus.objectId+"/0";c.notifications[b].link=e,c.notifications[b].icon="ion-chatbubble"}else if("Like"===d){c.notifications[b].message=" has liked your comment ",c.notifications[b].data=c.notifications[b].Comment.Comment;var e="#/tab/notifications/versus/single/"+c.notifications[b].Versus.objectId+"/0";c.notifications[b].link=e,c.notifications[b].icon="icon-vote-comment"}else if("Versus"===d){c.notifications[b].message=" has invited you to vote ";var e="#/tab/notifications/versus/single/"+c.notifications[b].Versus.objectId+"/0";c.notifications[b].link=e,c.notifications[b].data=c.notifications[b].Versus.Title,c.notifications[b].icon="icon-new-friend-versus"}else"Follow"===d?(c.notifications[b].message=" is now following you",c.notifications[b].data="",c.notifications[b].link="#/tab/notifications/user/"+c.notifications[b].From.objectId,c.notifications[b].icon="ion-plus"):console.log("What da fuck is that: "+d)}},!0)}}}]),angular.module("viceversa.directives").directive("focusMe",["$timeout",function(a){return{link:function(b,c){a(function(){c[0].focus()})}}}]).directive("stopEvent",function(){return{restrict:"A",link:function(a,b){b.bind("tap",function(a){a.stopPropagation()})}}}).directive("onDoubleTap",["$ionicGesture","$timeout",function(a){return{restrict:"A",link:function(b,c,d){var e=function(){b.$apply(d.onDoubleTap),c[0].classList.add("selected")};a.on("doubletap",e,c)}}}]).directive("empty",[function(){return{restrict:"EA",templateUrl:"templates/utils/empty.html",scope:{icon:"@",message:"@"},link:function(){}}}]).filter("numberFixedLen",function(){return function(a,b){var c=parseInt(a,10);if(b=parseInt(b,10),isNaN(c)||isNaN(b))return a;for(c=""+c;c.length<b;)c="0"+c;return c}}).filter("nl2br",["$filter",function(){return function(a){return a?a.replace(/\n\r?/g,"<br />"):a}}]).directive("autolinker",["$timeout",function(a){return{restrict:"A",link:function(b,c){a(function(){var a=c.html();if(""===a)return!1;var b=Autolinker.link(a,{className:"autolinker",newWindow:!1});c.html(b);for(var d=c[0].getElementsByClassName("autolinker"),e=0;e<d.length;e++)angular.element(d[e]).bind("click",function(a){var b=a.target.href;return console.log("autolinkClick, href: "+b),b&&window.open(b,"_blank"),a.preventDefault(),!1})},0)}}}]).directive("noScroll",["$document",function(a){return{restrict:"A",link:function(){a.on("touchmove",function(a){a.preventDefault()})}}}]).directive("halfHeight",["$window","$timeout","$rootScope",function(a,b,c){return function(a,d){b(function(){d.css("height",c.windowHeight/2+"px")})}}]).directive("fullWidth",["$window","$timeout","$rootScope",function(a,b){return function(c,d){b(function(){d.css("width",a.innerWidth+"px")
})}}]).directive("clockWatch",["$ionicScrollDelegate",function(a){return{restrict:"A",link:function(b,c,d){var e=d.clockWatch,f=_.debounce(function(b){var d=b.detail.scrollTop,f=100*Math.ceil(d/100);if(d!==f){for(var g=c[0].getElementsByClassName(e),h=0;h<g.length;h++)g[h].classList.remove("active");a.$getByHandle(e).scrollTo(0,f,!0);var i=f/100+1,j=document.getElementById(e+"-"+i);j.classList.add("active")}},100);c.bind("scroll",f)}}}]).directive("fatBtn",[function(){return{scope:{route:"@",message:"@"},restrict:"EA",templateUrl:"templates/utils/friends-btn.html",link:function(){}}}]).directive("hideOnHold",["$ionicGesture","$timeout",function(a){return{restrict:"A",link:function(b,c,d){var e=[];switch(d.hideOnHold){case"feed":e.hide="Down",e.show="Up";break;case"full":e.hide="",e.show=""}var f=function(){for(var a=c[0].querySelectorAll(".bottomed, .score-bg, .centered"),b=0;b<a.length;b++)a[b].classList.remove("fadeIn"+e.show),a[b].classList.add("fadeOut"+e.hide)},g=function(){for(var a=c[0].querySelectorAll(".fadeOut"+e.hide),b=0;b<a.length;b++)a[b].classList.remove("fadeOut"+e.hide),a[b].classList.add("fadeIn"+e.show)};a.on("hold",f,c),a.on("release",g,c)}}}]).directive("btnEffect",["$ionicGesture","$timeout",function(a,b){return{restrict:"A",link:function(c,d,e){var f=function(){d[0].classList.add("click-"+e.btnEffect),b(function(){d[0].classList.remove("click-"+e.btnEffect)},500)};a.on("tap",f,d)}}}]),angular.module("viceversa.directives").directive("versus",["AuthService","$rootScope","$state","UserService","VersusFeedService","$timeout",function(a,b,c,d,e,f){return{restrict:"EA",templateUrl:"templates/versus/directives/single.html",scope:{duel:"=data",feedType:"=feedType",feedParam:"=feedParam",slideIndex:"=slideIndex"},link:function(c){c.VersusFeedService=e,c.isLogged=a.isLogged,c.$watch(function(){return a.isLogged},function(){c.isLogged=a.isLogged}),console.log("plop");var g=!1;c.profilpic=d.currentAuthUser.Thumbnail,c.$watch("duel",function(){g===!1?g=!0:console.log("already set"),c.$broadcast("timer-stop"),f(function(){c.$broadcast("timer-start")},10),null!==c.duel&&c.duel.updatePercent()},!0),c.fullVersusState="tab."+b.activeTab+"-versus",c.$watch("feedParam",function(){c.fullVersusParams={feedType:c.feedType,feedParam:c.feedParam,slideIndex:c.slideIndex}}),c.userState="user"===b.activeTab?"tab."+b.activeTab:"tab."+b.activeTab+"-user"}}}]).directive("versusFull",["AuthService","VersusFeedService",function(a,b){return{restrict:"EA",templateUrl:"templates/versus/directives/single-full.html",scope:{duel:"=data"},link:function(c){c.VersusFeedService=b;for(var d=document.getElementsByClassName("compute-choice"),e=0;e<d.length;e++)d[e].style.height=window.innerHeight/2+"px";c.isLogged=a.isLogged,c.$watch(function(){return a.isLogged},function(){c.isLogged=a.isLogged}),c.$watch("duel",function(){null!==c.duel&&c.duel.updatePercent()},!0)}}}]).directive("inbox",["AuthService","UserService","User",function(a,b){return{restrict:"EA",templateUrl:"templates/versus/directives/inbox.html",scope:{duel:"=data",feedType:"=feedType",feedParam:"=feedParam",slideIndex:"=slideIndex"},link:function(c){c.isLogged=a.isLogged,c.UserService=b,c.moreInvitedCount=0,c.duel.InvitedCount>3&&(c.moreInvitedCount=c.duel.InvitedCount-3),c.versusParams={feedType:c.feedType,feedParam:c.duel.Versus.objectId,slideIndex:c.slideIndex},c.$watch(function(){return a.isLogged},function(){c.isLogged=a.isLogged}),c.$watch("duel",function(){null!==c.duel&&c.duel.Versus.updatePercent()},!0)}}}]),angular.module("viceversa.directives").directive("photo",["$window",function(a){return{restrict:"C",link:function(b,c){var d=a.outerWidth/2-2;c.css("width",d+"px").css("height",d+"px")}}}]),angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(a,b,c){"use strict";return{require:"ngModel",restrict:"A, C",link:function(d,e,f,g){function h(){var a=r;n=k,u=getComputedStyle(k),angular.forEach(C,function(b){a+=b+":"+u.getPropertyValue(b)+";"}),t.setAttribute("style",a)}function i(){var b,c,e,f,g;n!==k&&h(),o||(o=!0,t.value=k.value+p,t.style.overflowY=k.style.overflowY,b=""===k.style.height?"auto":parseInt(k.style.height,10),c=getComputedStyle(k).getPropertyValue("width"),"px"===c.substr(c.length-2,2)&&(f=parseInt(c,10)-x.width,t.style.width=f+"px"),e=t.scrollHeight,e>B?(e=B,g="scroll"):A>e&&(e=A),e+=x.height,k.style.overflowY=g||"hidden",b!==e&&(k.style.height=e+"px",d.$emit("elastic:resize",l)),d.$emit("taResize",l),a(function(){o=!1},1))}function j(){o=!1,i()}var k=e[0],l=e;if("TEXTAREA"===k.nodeName&&b.getComputedStyle){l.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var m=k.value;k.value="",k.value=m;var n,o,p=f.msdElastic?f.msdElastic.replace(/\\n/g,"\n"):c.append,q=angular.element(b),r="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",s=angular.element('<textarea tabindex="-1" style="'+r+'"/>').data("elastic",!0),t=s[0],u=getComputedStyle(k),v=u.getPropertyValue("resize"),w="border-box"===u.getPropertyValue("box-sizing")||"border-box"===u.getPropertyValue("-moz-box-sizing")||"border-box"===u.getPropertyValue("-webkit-box-sizing"),x=w?{width:parseInt(u.getPropertyValue("border-right-width"),10)+parseInt(u.getPropertyValue("padding-right"),10)+parseInt(u.getPropertyValue("padding-left"),10)+parseInt(u.getPropertyValue("border-left-width"),10),height:parseInt(u.getPropertyValue("border-top-width"),10)+parseInt(u.getPropertyValue("padding-top"),10)+parseInt(u.getPropertyValue("padding-bottom"),10)+parseInt(u.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},y=parseInt(u.getPropertyValue("min-height"),10),z=parseInt(u.getPropertyValue("height"),10),A=Math.max(y,z)-x.height,B=parseInt(u.getPropertyValue("max-height"),10),C=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];l.data("elastic")||(B=B&&B>0?B:9e4,t.parentNode!==document.body&&angular.element(document.body).append(t),l.css({resize:"none"===v||"vertical"===v?"none":"horizontal"}).data("elastic",!0),k.oninput="onpropertychange"in k&&"oninput"in k?k.onkeyup=i:i,q.bind("resize",j),d.$watch(function(){return g.$modelValue},function(){j()}),d.$on("elastic:adjust",function(){h(),j()}),a(i),d.$on("$destroy",function(){s.remove(),q.unbind("resize",j)}))}}}}]),angular.module("viceversa.directives").directive("createShrink",["$document","$timeout",function(a,b){return{restrict:"A",link:function(c,d){var e,f,g,h,i=a[0].body.querySelector("#summup");b(function(){h=a[0].body.querySelector(".bar-no-opacity")}),angular.element(d.children()[1]).bind("scroll",function(a){a.detail.scrollTop>=0?(f=Math.min(44,a.detail.scrollTop/6),g=f/44,e=a.detail.scrollTop/2,i.style[ionic.CSS.TRANSFORM]="translate3d(0, +"+e+"px, 0)",h.style.backgroundColor="rgba(69,168,219,"+2*g+")"):h.style.backgroundColor="rgba(69,168,219,0)"})}}}]).directive("headerShrink",["$document","$rootScope","$timeout","$state","$ionicScrollDelegate",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){var h=g.headerShrink,i=function(a){var b=a.indexOf(".")+1,c=a.substring(b,a.length);return b=c.indexOf("-"),-1!==b&&(c=c.substring(b+1,c.length)),c},j=function(b){var c=a[0].body.querySelector("ion-header-bar, .bar-header"),d=a[0].body.querySelector(".tabs"),e=a[0].body.querySelector(".float-button");if(h)var f=a[0].body.querySelector("#"+h);var g=c.offsetHeight;ionic.requestAnimationFrame(function(){k=1-b/g,f&&"subheader-search"===h&&(f.style[ionic.CSS.TRANSFORM]="translate3d(0, "+-Math.min(150,b)+"px, 0)"),c.style[ionic.CSS.TRANSFORM]="translate3d(0, "+-b+"px, 0)",d.style[ionic.CSS.TRANSFORM]="translate3d(0, "+-Math.min(64,b)+"px, 0)",e.style[ionic.CSS.TRANSFORM]="translate3d(0, "+b+"px, 0)";for(var a=0,i=c.children.length;i>a;a++)c.children[a].style.opacity=k})};b.$on("$ionicView.afterEnter",function(){j(0)});var k,l=(e.$eval(g.headerShrink)||0,0),m=0,n=.4;c(function(){function b(a){if(a.currentTarget.id===i(d.current.name)){var b=a.detail.scrollTop;l=b>=0?Math.min(g/n,Math.max(0,l+b-m)):0,j(l),m=b}}{var c=a[0].body.querySelector("ion-header-bar, .bar-header"),e=a[0].body.querySelector(".tabs"),g=c.offsetHeight;e.offsetHeight}f.bind("scroll",b)})}}}]);